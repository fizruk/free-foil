<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# language CPP                   #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# language ExplicitNamespaces    #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# language MultiWayIf            #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# language TemplateHaskellQuotes #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-comment">-- | Main module of @kind-generics-th@.</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Please refer to the @README@ file for documentation on how to use this package.</span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Generics.Kind.TH</span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Generics.Kind.TH.html#deriveGenericK"><span class="hs-identifier">deriveGenericK</span></a></span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Generics.Kind.TH.html#deriveGenericKQuiet"><span class="hs-identifier">deriveGenericKQuiet</span></a></span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Generics.Kind.TH.html#preDeriveGenericK"><span class="hs-identifier">preDeriveGenericK</span></a></span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Generics.Kind.TH.html#postDeriveGenericK"><span class="hs-identifier">postDeriveGenericK</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span>                    </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Kind</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Type.Equality</span></span><span>           </span><span class="hs-special">(</span><span class="hs-keyword">type</span><span> </span><span class="annot"><span class="hs-operator">(~~)</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Fcf.Family.TH</span></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fcfify</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isTypeFamilyOrSynonym</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">promoteNDFamily</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>                 </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Generics</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">conIsRecord</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">conName</span></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>                                                           </span><span class="annot"><span class="hs-identifier">datatypeName</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Generics.Kind</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH</span></span><span>          </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TH</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Syntax</span></span><span>   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TH</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Datatype</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">THAbs</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Datatype.TyVarBndr</span></span><span class="hs-cpp">

#if MIN_VERSION_template_haskell(2,15,0)
</span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Classes</span></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IP</span></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- | Given the 'Name' of a data type (or, the 'Name' of a constructor belonging</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- to a data type), generate 'GenericK' instances for that data type. You will</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- likely need to enable most of these language extensions in order for GHC to</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- accept the generated code:</span><span>
</span><span id="line-38"></span><span class="hs-comment">--</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- * @DataKinds@</span><span>
</span><span id="line-40"></span><span class="hs-comment">--</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- * @EmptyCase@ (if using an empty data type)</span><span>
</span><span id="line-42"></span><span class="hs-comment">--</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- * @FlexibleInstances@</span><span>
</span><span id="line-44"></span><span class="hs-comment">--</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- * @MultiParamTypeClasses@</span><span>
</span><span id="line-46"></span><span class="hs-comment">--</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- * @PolyKinds@ (if using a poly-kinded data type)</span><span>
</span><span id="line-48"></span><span class="hs-comment">--</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- * @TemplateHaskell@</span><span>
</span><span id="line-50"></span><span class="hs-comment">--</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- * @TypeFamilies@</span><span>
</span><span id="line-52"></span><span class="hs-comment">--</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- If the data type uses type families, 'deriveGenericK' warns that it</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- skips the 'GenericK' instances that require special support for it</span><span>
</span><span id="line-55"></span><span class="hs-comment">--</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- - Use 'preDeriveGenericK' and 'postDeriveGenericK' to support type families.</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- - Use 'deriveGenericKQuiet' to silence the warnings.</span><span>
</span><span id="line-58"></span><span class="annot"><a href="Generics.Kind.TH.html#deriveGenericK"><span class="hs-identifier hs-type">deriveGenericK</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-59"></span><span id="deriveGenericK"><span class="annot"><span class="annottext">deriveGenericK :: Name -&gt; Q [Dec]
</span><a href="Generics.Kind.TH.html#deriveGenericK"><span class="hs-identifier hs-var hs-var">deriveGenericK</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Name -&gt; Q [Dec]
</span><a href="Generics.Kind.TH.html#deriveGenericKWarnIf"><span class="hs-identifier hs-var">deriveGenericKWarnIf</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="annot"><span class="hs-comment">-- | Variant of 'deriveGenericK' that doesn't emit warnings.</span></span><span>
</span><span id="line-62"></span><span class="annot"><a href="Generics.Kind.TH.html#deriveGenericKQuiet"><span class="hs-identifier hs-type">deriveGenericKQuiet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-63"></span><span id="deriveGenericKQuiet"><span class="annot"><span class="annottext">deriveGenericKQuiet :: Name -&gt; Q [Dec]
</span><a href="Generics.Kind.TH.html#deriveGenericKQuiet"><span class="hs-identifier hs-var hs-var">deriveGenericKQuiet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Name -&gt; Q [Dec]
</span><a href="Generics.Kind.TH.html#deriveGenericKWarnIf"><span class="hs-identifier hs-var">deriveGenericKWarnIf</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="annot"><a href="Generics.Kind.TH.html#deriveGenericKWarnIf"><span class="hs-identifier hs-type">deriveGenericKWarnIf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-66"></span><span id="deriveGenericKWarnIf"><span class="annot"><span class="annottext">deriveGenericKWarnIf :: Bool -&gt; Name -&gt; Q [Dec]
</span><a href="Generics.Kind.TH.html#deriveGenericKWarnIf"><span class="hs-identifier hs-var hs-var">deriveGenericKWarnIf</span></a></span></span><span> </span><span id="local-6989586621679054434"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679054434"><span class="hs-identifier hs-var">warn</span></a></span></span><span> </span><span id="local-6989586621679054435"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054435"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Dec] -&gt; [Dec] -&gt; [Dec]) -&gt; ([Dec], [Dec]) -&gt; [Dec]
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; [Dec] -&gt; [Dec]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span> </span><span class="annot"><span class="annottext">(([Dec], [Dec]) -&gt; [Dec]) -&gt; Q ([Dec], [Dec]) -&gt; Q [Dec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FamilyFriendliness -&gt; Name -&gt; Q ([Dec], [Dec])
</span><a href="Generics.Kind.TH.html#deriveGenericK%27"><span class="hs-identifier hs-var">deriveGenericK'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; FamilyFriendliness
</span><a href="Generics.Kind.TH.html#NoFamilies"><span class="hs-identifier hs-var">NoFamilies</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679054434"><span class="hs-identifier hs-var">warn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054435"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | Generate 'GenericK' instances for data types that may mention</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- type families.</span><span>
</span><span id="line-70"></span><span class="hs-comment">--</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- This 'preDeriveGenericK' is to be used in combination with</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- 'postDeriveGenericK'. These two functions let us stage the compilation of</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- the generated type instances, because GHC cannot compile them in a single</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- group.</span><span>
</span><span id="line-75"></span><span class="hs-comment">--</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- - 'preDeriveGenericK' generates type instances to promote type families</span><span>
</span><span id="line-77"></span><span class="hs-comment">--   that occur in the given data types (using 'fcfify'; see</span><span>
</span><span id="line-78"></span><span class="hs-comment">--   &lt;https://hackage.haskell.org/package/fcf-family fcf-family&gt;).</span><span>
</span><span id="line-79"></span><span class="hs-comment">--   The 'GenericK' instances are not produced at this stage,</span><span>
</span><span id="line-80"></span><span class="hs-comment">--   they are accumulated in some internal global queue.</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- - 'postDeriveGenericK' produces all of the accumulated 'GenericK' instances.</span><span>
</span><span id="line-82"></span><span class="hs-comment">--   It should be called in a slice separated from 'preDeriveGenericK'.</span><span>
</span><span id="line-83"></span><span class="hs-comment">--   Multiple calls to `preDeriveGenericK` may precede 'postDeriveGenericK'.</span><span>
</span><span id="line-84"></span><span class="hs-comment">--</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- 'preDeriveGenericK' ''MyT1</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- 'preDeriveGenericK' ''MyT2</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- 'preDeriveGenericK' ''MyT3</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- 'postDeriveGenericK'</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-91"></span><span class="hs-comment">--</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- You will need to enable the extensions @UndecidableInstances@ and @PolyKinds@</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- (even if your data types are not poly-kinded)</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- in addition to those mentioned in the documentation of 'deriveGenericK'.</span><span>
</span><span id="line-95"></span><span class="annot"><a href="Generics.Kind.TH.html#preDeriveGenericK"><span class="hs-identifier hs-type">preDeriveGenericK</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-96"></span><span id="preDeriveGenericK"><span class="annot"><span class="annottext">preDeriveGenericK :: Name -&gt; Q [Dec]
</span><a href="Generics.Kind.TH.html#preDeriveGenericK"><span class="hs-identifier hs-var hs-var">preDeriveGenericK</span></a></span></span><span> </span><span id="local-6989586621679054440"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054440"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679054441"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679054441"><span class="hs-identifier hs-var">pre</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679054442"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679054442"><span class="hs-identifier hs-var">post</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FamilyFriendliness -&gt; Name -&gt; Q ([Dec], [Dec])
</span><a href="Generics.Kind.TH.html#deriveGenericK%27"><span class="hs-identifier hs-var">deriveGenericK'</span></a></span><span> </span><span class="annot"><span class="annottext">FamilyFriendliness
</span><a href="Generics.Kind.TH.html#YesFamilies"><span class="hs-identifier hs-var">YesFamilies</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054440"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-98"></span><span>  </span><span class="annot"><span class="annottext">[Dec] -&gt; Q ()
</span><a href="Generics.Kind.TH.html#pushGenericKQueue"><span class="hs-identifier hs-var">pushGenericKQueue</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679054442"><span class="hs-identifier hs-var">post</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><span class="annottext">[Dec] -&gt; Q [Dec]
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679054441"><span class="hs-identifier hs-var">pre</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="annot"><span class="hs-comment">-- | See 'preDeriveGenericK'.</span></span><span>
</span><span id="line-102"></span><span class="annot"><a href="Generics.Kind.TH.html#postDeriveGenericK"><span class="hs-identifier hs-type">postDeriveGenericK</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-103"></span><span id="postDeriveGenericK"><span class="annot"><span class="annottext">postDeriveGenericK :: Q [Dec]
</span><a href="Generics.Kind.TH.html#postDeriveGenericK"><span class="hs-identifier hs-var hs-var">postDeriveGenericK</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q [Dec]
</span><a href="Generics.Kind.TH.html#takeGenericKQueue"><span class="hs-identifier hs-var">takeGenericKQueue</span></a></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">-- | Flag to control support for type families, because that requires a</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- different API (preDeriveGenericK, postDeriveGenericK instead of</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- deriveGenericK).</span><span>
</span><span id="line-108"></span><span class="hs-keyword">data</span><span> </span><span id="FamilyFriendliness"><span class="annot"><a href="Generics.Kind.TH.html#FamilyFriendliness"><span class="hs-identifier hs-var">FamilyFriendliness</span></a></span></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="NoFamilies"><span class="annot"><a href="Generics.Kind.TH.html#NoFamilies"><span class="hs-identifier hs-var">NoFamilies</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Whether to warn when a type family is detected.</span></span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="YesFamilies"><span class="annot"><a href="Generics.Kind.TH.html#YesFamilies"><span class="hs-identifier hs-var">YesFamilies</span></a></span></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-comment">-- | Return a pair of:</span><span>
</span><span id="line-113"></span><span class="hs-comment">--</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- - 'fcfify'-generated instances</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- - 'GenericK' instances</span><span>
</span><span id="line-116"></span><span class="annot"><a href="Generics.Kind.TH.html#deriveGenericK%27"><span class="hs-identifier hs-type">deriveGenericK'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Generics.Kind.TH.html#FamilyFriendliness"><span class="hs-identifier hs-type">FamilyFriendliness</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span id="deriveGenericK%27"><span class="annot"><span class="annottext">deriveGenericK' :: FamilyFriendliness -&gt; Name -&gt; Q ([Dec], [Dec])
</span><a href="Generics.Kind.TH.html#deriveGenericK%27"><span class="hs-identifier hs-var hs-var">deriveGenericK'</span></a></span></span><span> </span><span id="local-6989586621679054446"><span class="annot"><span class="annottext">FamilyFriendliness
</span><a href="#local-6989586621679054446"><span class="hs-identifier hs-var">familyFriendliness</span></a></span></span><span> </span><span id="local-6989586621679054447"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054447"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-118"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">DatatypeInfo</span></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">datatypeName :: DatatypeInfo -&gt; Name
</span><span class="hs-identifier hs-var">datatypeName</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054450"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054450"><span class="hs-identifier hs-var">dataName</span></a></span></span><span>
</span><span id="line-119"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">datatypeInstTypes :: DatatypeInfo -&gt; [Type]
</span><span class="hs-identifier hs-var">datatypeInstTypes</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054452"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054452"><span class="hs-identifier hs-var">univVars</span></a></span></span><span>
</span><span id="line-120"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">datatypeVariant :: DatatypeInfo -&gt; DatatypeVariant
</span><span class="hs-identifier hs-var">datatypeVariant</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054454"><span class="annot"><span class="annottext">DatatypeVariant
</span><a href="#local-6989586621679054454"><span class="hs-identifier hs-var">variant</span></a></span></span><span>
</span><span id="line-121"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">datatypeCons :: DatatypeInfo -&gt; [ConstructorInfo]
</span><span class="hs-identifier hs-var">datatypeCons</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054456"><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679054456"><span class="hs-identifier hs-var">cons</span></a></span></span><span>
</span><span id="line-122"></span><span>              </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q DatatypeInfo
</span><span class="hs-identifier hs-var">reifyDatatype</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054447"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-123"></span><span>  </span><span id="local-6989586621679054458"><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679054458"><span class="hs-identifier hs-var">cons'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ConstructorInfo -&gt; Q ConstructorInfo)
-&gt; [ConstructorInfo] -&gt; Q [ConstructorInfo]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">ConstructorInfo -&gt; Q ConstructorInfo
</span><a href="Generics.Kind.TH.html#resolveConSynonyms"><span class="hs-identifier hs-var">resolveConSynonyms</span></a></span><span> </span><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679054456"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679054461"><span class="hs-identifier hs-type">deriveInsts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-125"></span><span>      </span><span id="local-6989586621679054461"><span class="annot"><span class="annottext">deriveInsts :: [Type] -&gt; [Type] -&gt; Q [Dec]
</span><a href="#local-6989586621679054461"><span class="hs-identifier hs-var hs-var">deriveInsts</span></a></span></span><span> </span><span id="local-6989586621679054462"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054462"><span class="hs-identifier hs-var">argsToKeep</span></a></span></span><span> </span><span id="local-6989586621679054463"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054463"><span class="hs-identifier hs-var">argsToDrop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-126"></span><span>        </span><span id="local-6989586621679054464"><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679054464"><span class="hs-identifier hs-var">inst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; Q Dec
</span><a href="#local-6989586621679054465"><span class="hs-identifier hs-var">deriveGenericKFor</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054462"><span class="hs-identifier hs-var">argsToKeep</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054463"><span class="hs-identifier hs-var">argsToDrop</span></a></span><span>
</span><span id="line-127"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054462"><span class="hs-identifier hs-var">argsToKeep</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-128"></span><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; Q [Dec]
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679054464"><span class="hs-identifier hs-var">inst</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-129"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679054466"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054466"><span class="hs-identifier hs-var">argToDrop</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679054467"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054467"><span class="hs-identifier hs-var">argsToKeep'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-130"></span><span>            </span><span id="local-6989586621679054468"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054468"><span class="hs-identifier hs-var">argToDrop'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Q Type
</span><span class="hs-identifier hs-var">resolveTypeSynonyms</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054466"><span class="hs-identifier hs-var">argToDrop</span></a></span><span>
</span><span id="line-131"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span>  </span><span class="hs-comment">-- Can the argument to drop be eta-reduced?</span><span>
</span><span id="line-132"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679054470"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054470"><span class="hs-identifier hs-var">argNameToDrop</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Type -&gt; Maybe Name
</span><a href="Generics.Kind.TH.html#distinctTyVarType"><span class="hs-identifier hs-var">distinctTyVarType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; [Name]
forall a. TypeSubstitution a =&gt; a -&gt; [Name]
</span><span class="hs-identifier hs-var">freeVariables</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054467"><span class="hs-identifier hs-var">argsToKeep'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>                                                          </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054468"><span class="hs-identifier hs-var">argToDrop'</span></a></span><span>
</span><span id="line-134"></span><span>                  </span><span class="hs-comment">-- Check for dependent quantification, which we currently can't handle.</span><span>
</span><span id="line-135"></span><span>               </span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054470"><span class="hs-identifier hs-var">argNameToDrop</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span>
</span><span id="line-136"></span><span>                    </span><span class="annot"><span class="annottext">[Type] -&gt; [Name]
forall a. TypeSubstitution a =&gt; a -&gt; [Name]
</span><span class="hs-identifier hs-var">freeVariables</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; [Type] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="Generics.Kind.TH.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054463"><span class="hs-identifier hs-var">argsToDrop</span></a></span><span>
</span><span id="line-137"></span><span>                                </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; [Type]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(TyVarBndr_ () -&gt; Type) -&gt; [TyVarBndr_ ()] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr_ () -&gt; Type
forall flag. TyVarBndr_ flag -&gt; Type
</span><span class="hs-identifier hs-var">tvKind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ConstructorInfo] -&gt; [TyVarBndr_ ()]
</span><a href="Generics.Kind.TH.html#gatherExistentials"><span class="hs-identifier hs-var">gatherExistentials</span></a></span><span> </span><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679054458"><span class="hs-identifier hs-var">cons'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679054477"><span class="annot"><span class="annottext">allInnerTypes :: [Type]
</span><a href="#local-6989586621679054477"><span class="hs-identifier hs-var hs-var">allInnerTypes</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ConstructorInfo] -&gt; [Type]
</span><a href="Generics.Kind.TH.html#gatherConstraints"><span class="hs-identifier hs-var">gatherConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679054458"><span class="hs-identifier hs-var">cons'</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; [Type]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[ConstructorInfo] -&gt; [Type]
</span><a href="Generics.Kind.TH.html#gatherFields"><span class="hs-identifier hs-var">gatherFields</span></a></span><span> </span><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679054458"><span class="hs-identifier hs-var">cons'</span></a></span><span>
</span><span id="line-139"></span><span>                     </span><span class="hs-comment">-- Check if the argument appears in a type family application.</span><span>
</span><span id="line-140"></span><span>                     </span><span id="local-6989586621679054480"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679054480"><span class="hs-identifier hs-var">inTyFamApp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">or</span></span><span> </span><span class="annot"><span class="annottext">([Bool] -&gt; Bool) -&gt; Q [Bool] -&gt; Q Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Q Bool) -&gt; [Type] -&gt; Q [Bool]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; Q Bool
</span><a href="Generics.Kind.TH.html#isInTypeFamilyApp"><span class="hs-identifier hs-var">isInTypeFamilyApp</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054470"><span class="hs-identifier hs-var">argNameToDrop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>                                                   </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054477"><span class="hs-identifier hs-var">allInnerTypes</span></a></span><span>
</span><span id="line-142"></span><span>                     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FamilyFriendliness
</span><a href="#local-6989586621679054446"><span class="hs-identifier hs-var">familyFriendliness</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-143"></span><span>                       </span><span class="annot"><a href="Generics.Kind.TH.html#NoFamilies"><span class="hs-identifier hs-type">NoFamilies</span></a></span><span> </span><span id="local-6989586621679054483"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679054483"><span class="hs-identifier hs-var">warn</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679054480"><span class="hs-identifier hs-var">inTyFamApp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-144"></span><span>                         </span><span class="hs-comment">-- Found type family application when family suppport is disabled.</span><span>
</span><span id="line-145"></span><span>                         </span><span class="hs-comment">-- Emit a warning and don't generate GenericK instances for fewer argsToKeep.</span><span>
</span><span id="line-146"></span><span>                         </span><span class="annot"><span class="annottext">Bool -&gt; Q () -&gt; Q ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679054483"><span class="hs-identifier hs-var">warn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Q ()
</span><span class="hs-identifier hs-var">reportWarning</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Q ()) -&gt; String -&gt; Q ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; [Type] -&gt; [Type] -&gt; String
</span><a href="Generics.Kind.TH.html#tyFamWarning"><span class="hs-identifier hs-var">tyFamWarning</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054447"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054450"><span class="hs-identifier hs-var">dataName</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054462"><span class="hs-identifier hs-var">argsToKeep</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054463"><span class="hs-identifier hs-var">argsToDrop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>                         </span><span class="annot"><span class="annottext">[Dec] -&gt; Q [Dec]
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679054464"><span class="hs-identifier hs-var">inst</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-148"></span><span>                       </span><span class="annot"><span class="annottext">FamilyFriendliness
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679054464"><span class="hs-identifier hs-var">inst</span></a></span><span class="annot"><span class="annottext">Dec -&gt; [Dec] -&gt; [Dec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Dec] -&gt; [Dec]) -&gt; Q [Dec] -&gt; Q [Dec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; Q [Dec]
</span><a href="#local-6989586621679054461"><span class="hs-identifier hs-var">deriveInsts</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054467"><span class="hs-identifier hs-var">argsToKeep'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054468"><span class="hs-identifier hs-var">argToDrop'</span></a></span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; [Type]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054463"><span class="hs-identifier hs-var">argsToDrop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>               </span><span class="hs-glyph">|</span><span>  </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-150"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; Q [Dec]
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679054464"><span class="hs-identifier hs-var">inst</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span>      </span><span class="hs-comment">-- Generate a single GenericK instance for a given set of data type</span><span>
</span><span id="line-153"></span><span>      </span><span class="hs-comment">-- arguments and indexed arguments.</span><span>
</span><span id="line-154"></span><span>      </span><span class="annot"><a href="#local-6989586621679054465"><span class="hs-identifier hs-type">deriveGenericKFor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span>
</span><span id="line-155"></span><span>      </span><span id="local-6989586621679054465"><span class="annot"><span class="annottext">deriveGenericKFor :: [Type] -&gt; [Type] -&gt; Q Dec
</span><a href="#local-6989586621679054465"><span class="hs-identifier hs-var hs-var">deriveGenericKFor</span></a></span></span><span> </span><span id="local-6989586621679054487"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054487"><span class="hs-identifier hs-var">argsToKeep</span></a></span></span><span> </span><span id="local-6989586621679054488"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054488"><span class="hs-identifier hs-var">argsToDrop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-156"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679054489"><span class="annot"><span class="annottext">argNamesToDrop :: [Name]
</span><a href="#local-6989586621679054489"><span class="hs-identifier hs-var hs-var">argNamesToDrop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Name) -&gt; [Type] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Name
</span><a href="Generics.Kind.TH.html#varTToName"><span class="hs-identifier hs-var">varTToName</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054488"><span class="hs-identifier hs-var">argsToDrop</span></a></span><span>
</span><span id="line-157"></span><span>            </span><span id="local-6989586621679054492"><span class="annot"><span class="annottext">kind :: Type
</span><a href="#local-6989586621679054492"><span class="hs-identifier hs-var hs-var">kind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; Type -&gt; [Type] -&gt; Type
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679054494"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054494"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679054495"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054495"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ArrowT</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054494"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054495"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; (Type -&gt; Type) -&gt; Type -&gt; Type -&gt; Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="Generics.Kind.TH.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Kind.Type</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054488"><span class="hs-identifier hs-var">argsToDrop</span></a></span><span>
</span><span id="line-159"></span><span>            </span><span id="local-6989586621679054503"><span class="annot"><span class="annottext">dataApp :: Q Type
</span><a href="#local-6989586621679054503"><span class="hs-identifier hs-var hs-var">dataApp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Q Type
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Q Type) -&gt; Type -&gt; Q Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">SigT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; Type -&gt; [Type] -&gt; Type
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; Type -&gt; Type -&gt; Type
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">AppT</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054450"><span class="hs-identifier hs-var">dataName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054487"><span class="hs-identifier hs-var">argsToKeep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054492"><span class="hs-identifier hs-var">kind</span></a></span><span>
</span><span id="line-160"></span><span>        </span><span class="annot"><span class="annottext">Q [Type] -&gt; Q Type -&gt; [Q Dec] -&gt; Q Dec
forall (m :: * -&gt; *).
Quote m =&gt;
m [Type] -&gt; m Type -&gt; [m Dec] -&gt; m Dec
</span><span class="hs-identifier hs-var">instanceD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Q [Type]
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">conT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">GenericK</span><span> </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span> </span><span class="annot"><span class="annottext">Q Type
</span><a href="#local-6989586621679054503"><span class="hs-identifier hs-var">dataApp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe [Q (TyVarBndr_ ())] -&gt; [Q Type] -&gt; Q Type -&gt; Q Dec
</span><span class="hs-identifier hs-var">tySynInstDCompat</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">RepK</span><span> </span><span class="annot"><span class="annottext">Maybe [Q (TyVarBndr_ ())]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Q Type
</span><a href="#local-6989586621679054503"><span class="hs-identifier hs-var">dataApp</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Q Type -&gt; Q Dec) -&gt; Q Type -&gt; Q Dec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-163"></span><span>                      </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; DatatypeVariant -&gt; [ConstructorInfo] -&gt; Q Type
</span><a href="Generics.Kind.TH.html#deriveRepK"><span class="hs-identifier hs-var">deriveRepK</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054450"><span class="hs-identifier hs-var">dataName</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054489"><span class="hs-identifier hs-var">argNamesToDrop</span></a></span><span> </span><span class="annot"><span class="annottext">DatatypeVariant
</span><a href="#local-6989586621679054454"><span class="hs-identifier hs-var">variant</span></a></span><span> </span><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679054458"><span class="hs-identifier hs-var">cons'</span></a></span><span>
</span><span id="line-164"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[ConstructorInfo] -&gt; Q Dec
</span><a href="Generics.Kind.TH.html#deriveFromK"><span class="hs-identifier hs-var">deriveFromK</span></a></span><span> </span><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679054458"><span class="hs-identifier hs-var">cons'</span></a></span><span>
</span><span id="line-165"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[ConstructorInfo] -&gt; Q Dec
</span><a href="Generics.Kind.TH.html#deriveToK"><span class="hs-identifier hs-var">deriveToK</span></a></span><span> </span><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679054458"><span class="hs-identifier hs-var">cons'</span></a></span><span>
</span><span id="line-166"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span>  </span><span id="local-6989586621679054511"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679054511"><span class="hs-identifier hs-var">insts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; Q [Dec]
</span><a href="#local-6989586621679054461"><span class="hs-identifier hs-var">deriveInsts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; [Type]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054452"><span class="hs-identifier hs-var">univVars</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-169"></span><span>  </span><span id="local-6989586621679054513"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679054513"><span class="hs-identifier hs-var">fcfInsts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Q [Dec]
</span><a href="Generics.Kind.TH.html#takeFcfifyQueue"><span class="hs-identifier hs-var">takeFcfifyQueue</span></a></span><span>
</span><span id="line-170"></span><span>  </span><span class="annot"><span class="annottext">([Dec], [Dec]) -&gt; Q ([Dec], [Dec])
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679054513"><span class="hs-identifier hs-var">fcfInsts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679054511"><span class="hs-identifier hs-var">insts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="annot"><span class="hs-comment">-- | Warning to show when a type family is found by 'deriveGenericK'.</span></span><span>
</span><span id="line-173"></span><span class="annot"><a href="Generics.Kind.TH.html#tyFamWarning"><span class="hs-identifier hs-type">tyFamWarning</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-174"></span><span id="tyFamWarning"><span class="annot"><span class="annottext">tyFamWarning :: Name -&gt; Name -&gt; [Type] -&gt; [Type] -&gt; String
</span><a href="Generics.Kind.TH.html#tyFamWarning"><span class="hs-identifier hs-var hs-var">tyFamWarning</span></a></span></span><span> </span><span id="local-6989586621679054515"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054515"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679054516"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054516"><span class="hs-identifier hs-var">dataName</span></a></span></span><span> </span><span id="local-6989586621679054517"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054517"><span class="hs-identifier hs-var">argsToKeep'</span></a></span></span><span> </span><span id="local-6989586621679054518"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054518"><span class="hs-identifier hs-var">argsToDrop'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679054520"><span class="annot"><span class="annottext">argsToKeep :: [String]
</span><a href="#local-6989586621679054520"><span class="hs-identifier hs-var hs-var">argsToKeep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
</span><a href="Generics.Kind.TH.html#getVarTName"><span class="hs-identifier hs-var">getVarTName</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; String) -&gt; [Type] -&gt; [String]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054517"><span class="hs-identifier hs-var">argsToKeep'</span></a></span><span>
</span><span id="line-176"></span><span>      </span><span id="local-6989586621679054523"><span class="annot"><span class="annottext">argsToDrop :: [String]
</span><a href="#local-6989586621679054523"><span class="hs-identifier hs-var hs-var">argsToDrop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
</span><a href="Generics.Kind.TH.html#getVarTName"><span class="hs-identifier hs-var">getVarTName</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; String) -&gt; [Type] -&gt; [String]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054518"><span class="hs-identifier hs-var">argsToDrop'</span></a></span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; [String] -&gt; [String] -&gt; String
</span><a href="Generics.Kind.TH.html#tyFamWarning%27"><span class="hs-identifier hs-var">tyFamWarning'</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054515"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054516"><span class="hs-identifier hs-var">dataName</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679054520"><span class="hs-identifier hs-var">argsToKeep</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679054523"><span class="hs-identifier hs-var">argsToDrop</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="annot"><span class="hs-comment">-- | 'tyFamWarning' with variable names instead of Type, all in left-to-right order.</span></span><span>
</span><span id="line-180"></span><span class="annot"><a href="Generics.Kind.TH.html#tyFamWarning%27"><span class="hs-identifier hs-type">tyFamWarning'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-181"></span><span id="tyFamWarning%27"><span class="annot"><span class="annottext">tyFamWarning' :: Name -&gt; Name -&gt; [String] -&gt; [String] -&gt; String
</span><a href="Generics.Kind.TH.html#tyFamWarning%27"><span class="hs-identifier hs-var hs-var">tyFamWarning'</span></a></span></span><span> </span><span id="local-6989586621679054525"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054525"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679054526"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054526"><span class="hs-identifier hs-var">dataName</span></a></span></span><span> </span><span id="local-6989586621679054527"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679054527"><span class="hs-identifier hs-var">argsToKeep</span></a></span></span><span> </span><span id="local-6989586621679054528"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679054528"><span class="hs-identifier hs-var">argsToDrop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unlines</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Found type family in definition of &quot;</span></span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><a href="Generics.Kind.TH.html#quoteName"><span class="hs-identifier hs-var">quoteName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054525"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;. Some instances have been skipped.&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-184"></span><span>  </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; [String] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;    &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-185"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Declared instances:&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><span class="annottext">Name -&gt; [String] -&gt; [String] -&gt; [String]
</span><a href="Generics.Kind.TH.html#showDeclaredInstances"><span class="hs-identifier hs-var">showDeclaredInstances</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054526"><span class="hs-identifier hs-var">dataName</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679054527"><span class="hs-identifier hs-var">argsToKeep</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679054528"><span class="hs-identifier hs-var">argsToDrop</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Skipped instances:&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-188"></span><span>    </span><span class="annot"><span class="annottext">Name -&gt; [String] -&gt; [String]
</span><a href="Generics.Kind.TH.html#showSkippedInstances"><span class="hs-identifier hs-var">showSkippedInstances</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054526"><span class="hs-identifier hs-var">dataName</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679054527"><span class="hs-identifier hs-var">argsToKeep</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;To enable type family support and obtain those skipped instances:&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\t$(preDeriveGenericK &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><a href="Generics.Kind.TH.html#quoteName"><span class="hs-identifier hs-var">quoteName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054525"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\t$(postDeriveGenericK &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><a href="Generics.Kind.TH.html#quoteName"><span class="hs-identifier hs-var">quoteName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054525"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;To silence this warning:&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\t$(deriveGenericKQuiet &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><a href="Generics.Kind.TH.html#quoteName"><span class="hs-identifier hs-var">quoteName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054525"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="annot"><span class="hs-comment">-- | This assumes most uses are going to be unqualified names.</span></span><span>
</span><span id="line-197"></span><span class="annot"><a href="Generics.Kind.TH.html#quoteName"><span class="hs-identifier hs-type">quoteName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-198"></span><span id="quoteName"><span class="annot"><span class="annottext">quoteName :: Name -&gt; String
</span><a href="Generics.Kind.TH.html#quoteName"><span class="hs-identifier hs-var hs-var">quoteName</span></a></span></span><span> </span><span id="local-6989586621679054533"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679054533"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><span class="annottext">OccName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NameG</span></span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><span class="hs-identifier hs-var">DataName</span></span><span> </span><span class="annot"><span class="annottext">PkgName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ModName
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;'&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054533"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-199"></span><span class="annot"><a href="Generics.Kind.TH.html#quoteName"><span class="hs-identifier hs-var">quoteName</span></a></span><span> </span><span id="local-6989586621679054537"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054537"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;''&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054537"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="annot"><a href="Generics.Kind.TH.html#showDeclaredInstances"><span class="hs-identifier hs-type">showDeclaredInstances</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-202"></span><span id="showDeclaredInstances"><span class="annot"><span class="annottext">showDeclaredInstances :: Name -&gt; [String] -&gt; [String] -&gt; [String]
</span><a href="Generics.Kind.TH.html#showDeclaredInstances"><span class="hs-identifier hs-var hs-var">showDeclaredInstances</span></a></span></span><span> </span><span id="local-6989586621679054538"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054538"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679054539"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679054539"><span class="hs-identifier hs-var">argsToKeep</span></a></span></span><span> </span><span id="local-6989586621679054540"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679054540"><span class="hs-identifier hs-var">argsToDrop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679054541"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679054541"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\tinstance GenericK &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [String] -&gt; String
</span><a href="Generics.Kind.TH.html#showConArgs"><span class="hs-identifier hs-var">showConArgs</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054538"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679054539"><span class="hs-identifier hs-var">argsToKeep</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679054541"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [[String]] -&gt; [String]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [[String]]
forall a. [a] -&gt; [[a]]
</span><span class="hs-identifier hs-var">inits</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679054540"><span class="hs-identifier hs-var">argsToDrop</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="annot"><a href="Generics.Kind.TH.html#showSkippedInstances"><span class="hs-identifier hs-type">showSkippedInstances</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-206"></span><span id="showSkippedInstances"><span class="annot"><span class="annottext">showSkippedInstances :: Name -&gt; [String] -&gt; [String]
</span><a href="Generics.Kind.TH.html#showSkippedInstances"><span class="hs-identifier hs-var hs-var">showSkippedInstances</span></a></span></span><span> </span><span id="local-6989586621679054544"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054544"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679054545"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679054545"><span class="hs-identifier hs-var">argsToKeep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679054546"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679054546"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\tinstance GenericK &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [String] -&gt; String
</span><a href="Generics.Kind.TH.html#showConArgs"><span class="hs-identifier hs-var">showConArgs</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054544"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679054546"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [[String]] -&gt; [String]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[[String]] -&gt; [[String]]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">init</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; [[String]]
forall a. [a] -&gt; [[a]]
</span><span class="hs-identifier hs-var">inits</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679054545"><span class="hs-identifier hs-var">argsToKeep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-- We manually pretty-print the types to drop module qualifiers.</span><span>
</span><span id="line-210"></span><span class="annot"><a href="Generics.Kind.TH.html#showConArgs"><span class="hs-identifier hs-type">showConArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-211"></span><span id="showConArgs"><span class="annot"><span class="annottext">showConArgs :: Name -&gt; [String] -&gt; String
</span><a href="Generics.Kind.TH.html#showConArgs"><span class="hs-identifier hs-var hs-var">showConArgs</span></a></span></span><span> </span><span id="local-6989586621679054548"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054548"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054548"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-212"></span><span class="annot"><a href="Generics.Kind.TH.html#showConArgs"><span class="hs-identifier hs-var">showConArgs</span></a></span><span> </span><span id="local-6989586621679054549"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054549"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679054550"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679054550"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054549"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679054550"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">-- | Find type variable stored in types coming from 'datatypeInstTypes'</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- (should be of the form (v :: k))</span><span>
</span><span id="line-216"></span><span class="annot"><a href="Generics.Kind.TH.html#getVarTName"><span class="hs-identifier hs-type">getVarTName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-217"></span><span id="getVarTName"><span class="annot"><span class="annottext">getVarTName :: Type -&gt; String
</span><a href="Generics.Kind.TH.html#getVarTName"><span class="hs-identifier hs-var hs-var">getVarTName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigT</span></span><span> </span><span id="local-6989586621679054552"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054552"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
</span><a href="Generics.Kind.TH.html#getVarTName"><span class="hs-identifier hs-var">getVarTName</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054552"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-218"></span><span class="annot"><a href="Generics.Kind.TH.html#getVarTName"><span class="hs-identifier hs-var">getVarTName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarT</span></span><span> </span><span id="local-6989586621679054554"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054554"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054554"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-219"></span><span class="annot"><a href="Generics.Kind.TH.html#getVarTName"><span class="hs-identifier hs-var">getVarTName</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_a&quot;</span></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-comment">-- | @'distinctTyVarType' tvSet ty@ returns @'Just' tvTy@ if @ty@:</span><span>
</span><span id="line-222"></span><span class="hs-comment">--</span><span>
</span><span id="line-223"></span><span class="hs-comment">-- a. Is a type variable named @tvTy@, and</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- b. @tvTy@ is not an element of @tvSet@.</span><span>
</span><span id="line-225"></span><span class="hs-comment">--</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- Otherwise, returns 'Nothing'.</span><span>
</span><span id="line-227"></span><span class="annot"><a href="Generics.Kind.TH.html#distinctTyVarType"><span class="hs-identifier hs-type">distinctTyVarType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-228"></span><span id="distinctTyVarType"><span class="annot"><span class="annottext">distinctTyVarType :: [Name] -&gt; Type -&gt; Maybe Name
</span><a href="Generics.Kind.TH.html#distinctTyVarType"><span class="hs-identifier hs-var hs-var">distinctTyVarType</span></a></span></span><span> </span><span id="local-6989586621679054555"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054555"><span class="hs-identifier hs-var">tvSet</span></a></span></span><span> </span><span id="local-6989586621679054556"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054556"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-229"></span><span>  </span><span id="local-6989586621679054557"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054557"><span class="hs-identifier hs-var">tvTy</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Name
</span><a href="Generics.Kind.TH.html#varTToName_maybe"><span class="hs-identifier hs-var">varTToName_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054556"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-230"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Maybe ()) -&gt; Bool -&gt; Maybe ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054557"><span class="hs-identifier hs-var">tvTy</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054555"><span class="hs-identifier hs-var">tvSet</span></a></span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054557"><span class="hs-identifier hs-var">tvTy</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="annot"><a href="Generics.Kind.TH.html#deriveRepK"><span class="hs-identifier hs-type">deriveRepK</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>
</span><span id="line-234"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DatatypeVariant</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-235"></span><span id="deriveRepK"><span class="annot"><span class="annottext">deriveRepK :: Name -&gt; [Name] -&gt; DatatypeVariant -&gt; [ConstructorInfo] -&gt; Q Type
</span><a href="Generics.Kind.TH.html#deriveRepK"><span class="hs-identifier hs-var hs-var">deriveRepK</span></a></span></span><span> </span><span id="local-6989586621679054559"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054559"><span class="hs-identifier hs-var">dataName</span></a></span></span><span> </span><span id="local-6989586621679054560"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054560"><span class="hs-identifier hs-var">univVarNames</span></a></span></span><span> </span><span id="local-6989586621679054561"><span class="annot"><span class="annottext">DatatypeVariant
</span><a href="#local-6989586621679054561"><span class="hs-identifier hs-var">dataVariant</span></a></span></span><span> </span><span id="local-6989586621679054562"><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679054562"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-236"></span><span>  </span><span id="local-6989586621679054563"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054563"><span class="hs-identifier hs-var">cons'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ConstructorInfo -&gt; Q Type) -&gt; [ConstructorInfo] -&gt; Q [Type]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">ConstructorInfo -&gt; Q Type
</span><a href="#local-6989586621679054564"><span class="hs-identifier hs-var">constructor</span></a></span><span> </span><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679054562"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-237"></span><span>  </span><span class="annot"><span class="annottext">Type -&gt; Q Type
</span><a href="#local-6989586621679054565"><span class="hs-identifier hs-var">metaData</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Q Type) -&gt; Type -&gt; Q Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; Type -&gt; [Type] -&gt; Type
forall a. (a -&gt; a -&gt; a) -&gt; a -&gt; [a] -&gt; a
</span><a href="Generics.Kind.TH.html#foldBal"><span class="hs-identifier hs-var">foldBal</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679054567"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054567"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679054568"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054568"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Name -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">InfixT</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054567"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-special">(</span><span class="hs-operator">:+:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054568"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">V1</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054563"><span class="hs-identifier hs-var">cons'</span></a></span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-239"></span><span>    </span><span class="annot"><a href="#local-6989586621679054565"><span class="hs-identifier hs-type">metaData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-240"></span><span>    </span><span id="local-6989586621679054565"><span class="annot"><span class="annottext">metaData :: Type -&gt; Q Type
</span><a href="#local-6989586621679054565"><span class="hs-identifier hs-var hs-var">metaData</span></a></span></span><span> </span><span id="local-6989586621679054570"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054570"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-241"></span><span>      </span><span id="local-6989586621679054571"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679054571"><span class="hs-identifier hs-var">m</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Q String -&gt; (String -&gt; Q String) -&gt; Maybe String -&gt; Q String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Q String
forall a. String -&gt; Q a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot fetch module name!&quot;</span></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">String -&gt; Q String
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Maybe String
</span><span class="hs-identifier hs-var">nameModule</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054559"><span class="hs-identifier hs-var">dataName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>      </span><span id="local-6989586621679054574"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679054574"><span class="hs-identifier hs-var">pkg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Q String -&gt; (String -&gt; Q String) -&gt; Maybe String -&gt; Q String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Q String
forall a. String -&gt; Q a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot fetch package name!&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q String
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Maybe String
</span><span class="hs-identifier hs-var">namePackage</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054559"><span class="hs-identifier hs-var">dataName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>      </span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">conT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">D1</span><span>
</span><span id="line-244"></span><span>        </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">promotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">MetaData</span><span> </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span>
</span><span id="line-245"></span><span>                </span><span class="annot"><span class="annottext">Q TyLit -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m TyLit -&gt; m Type
</span><span class="hs-identifier hs-var">litT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Q TyLit
forall (m :: * -&gt; *). Quote m =&gt; String -&gt; m TyLit
</span><span class="hs-identifier hs-var">strTyLit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054559"><span class="hs-identifier hs-var">dataName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span>
</span><span id="line-246"></span><span>                </span><span class="annot"><span class="annottext">Q TyLit -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m TyLit -&gt; m Type
</span><span class="hs-identifier hs-var">litT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Q TyLit
forall (m :: * -&gt; *). Quote m =&gt; String -&gt; m TyLit
</span><span class="hs-identifier hs-var">strTyLit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679054571"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span>
</span><span id="line-247"></span><span>                </span><span class="annot"><span class="annottext">Q TyLit -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m TyLit -&gt; m Type
</span><span class="hs-identifier hs-var">litT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Q TyLit
forall (m :: * -&gt; *). Quote m =&gt; String -&gt; m TyLit
</span><span class="hs-identifier hs-var">strTyLit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679054574"><span class="hs-identifier hs-var">pkg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span>
</span><span id="line-248"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; Q Type
</span><a href="Generics.Kind.TH.html#promoteBool"><span class="hs-identifier hs-var">promoteBool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatatypeVariant -&gt; Bool
</span><a href="Generics.Kind.TH.html#isNewtypeVariant"><span class="hs-identifier hs-var">isNewtypeVariant</span></a></span><span> </span><span class="annot"><span class="annottext">DatatypeVariant
</span><a href="#local-6989586621679054561"><span class="hs-identifier hs-var">dataVariant</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>        </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Q Type
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054570"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span>    </span><span class="annot"><a href="#local-6989586621679054564"><span class="hs-identifier hs-type">constructor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-252"></span><span>    </span><span id="local-6989586621679054564"><span class="annot"><span class="annottext">constructor :: ConstructorInfo -&gt; Q Type
</span><a href="#local-6989586621679054564"><span class="hs-identifier hs-var hs-var">constructor</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">constructorName :: ConstructorInfo -&gt; Name
</span><span class="hs-identifier hs-var">constructorName</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054580"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054580"><span class="hs-identifier hs-var">conName</span></a></span></span><span>
</span><span id="line-253"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">constructorVars :: ConstructorInfo -&gt; [TyVarBndr_ ()]
</span><span class="hs-identifier hs-var">constructorVars</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054582"><span class="annot"><span class="annottext">[TyVarBndr_ ()]
</span><a href="#local-6989586621679054582"><span class="hs-identifier hs-var">exTvbs</span></a></span></span><span>
</span><span id="line-254"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">constructorContext :: ConstructorInfo -&gt; [Type]
</span><span class="hs-identifier hs-var">constructorContext</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054584"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054584"><span class="hs-identifier hs-var">conCtxt</span></a></span></span><span>
</span><span id="line-255"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">constructorFields :: ConstructorInfo -&gt; [Type]
</span><span class="hs-identifier hs-var">constructorFields</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054586"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054586"><span class="hs-identifier hs-var">fields</span></a></span></span><span>
</span><span id="line-256"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">constructorStrictness :: ConstructorInfo -&gt; [FieldStrictness]
</span><span class="hs-identifier hs-var">constructorStrictness</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054588"><span class="annot"><span class="annottext">[FieldStrictness]
</span><a href="#local-6989586621679054588"><span class="hs-identifier hs-var">fieldStricts</span></a></span></span><span>
</span><span id="line-257"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">constructorVariant :: ConstructorInfo -&gt; ConstructorVariant
</span><span class="hs-identifier hs-var">constructorVariant</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054590"><span class="annot"><span class="annottext">ConstructorVariant
</span><a href="#local-6989586621679054590"><span class="hs-identifier hs-var">conVariant</span></a></span></span><span>
</span><span id="line-258"></span><span>                               </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-259"></span><span>      </span><span id="local-6989586621679054591"><span class="annot"><span class="annottext">Maybe Fixity
</span><a href="#local-6989586621679054591"><span class="hs-identifier hs-var">mbFi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q (Maybe Fixity)
</span><span class="hs-identifier hs-var">reifyFixity</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054580"><span class="hs-identifier hs-var">conName</span></a></span><span>
</span><span id="line-260"></span><span>      </span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">conT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">C1</span><span>
</span><span id="line-261"></span><span>        </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">promotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">MetaCons</span><span> </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span>
</span><span id="line-262"></span><span>                </span><span class="annot"><span class="annottext">Q TyLit -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m TyLit -&gt; m Type
</span><span class="hs-identifier hs-var">litT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Q TyLit
forall (m :: * -&gt; *). Quote m =&gt; String -&gt; m TyLit
</span><span class="hs-identifier hs-var">strTyLit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054580"><span class="hs-identifier hs-var">conName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span>
</span><span id="line-263"></span><span>                </span><span class="annot"><span class="annottext">Maybe Fixity -&gt; Bool -&gt; Q Type
</span><a href="#local-6989586621679054593"><span class="hs-identifier hs-var">fixityIPromotedType</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Fixity
</span><a href="#local-6989586621679054591"><span class="hs-identifier hs-var">mbFi</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679054594"><span class="hs-identifier hs-var">conIsInfix</span></a></span><span> </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span>
</span><span id="line-264"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; Q Type
</span><a href="Generics.Kind.TH.html#promoteBool"><span class="hs-identifier hs-var">promoteBool</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679054595"><span class="hs-identifier hs-var">conIsRecord</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>        </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679054596"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054596"><span class="hs-identifier hs-var">prod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; Type -&gt; [Type] -&gt; Type
forall a. (a -&gt; a -&gt; a) -&gt; a -&gt; [a] -&gt; a
</span><a href="Generics.Kind.TH.html#foldBal"><span class="hs-identifier hs-var">foldBal</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679054597"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054597"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679054598"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054598"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Name -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">InfixT</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054597"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-special">(</span><span class="hs-operator">:*:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054598"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">U1</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Type] -&gt; Type) -&gt; Q [Type] -&gt; Q Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Q [Type]
</span><a href="#local-6989586621679054599"><span class="hs-identifier hs-var">selectors</span></a></span><span>
</span><span id="line-266"></span><span>                  </span><span id="local-6989586621679054600"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054600"><span class="hs-identifier hs-var">ctxtProd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Q Type
</span><a href="#local-6989586621679054601"><span class="hs-identifier hs-var">context</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054596"><span class="hs-identifier hs-var">prod</span></a></span><span>
</span><span id="line-267"></span><span>                  </span><span class="annot"><span class="annottext">Type -&gt; Q Type
</span><a href="#local-6989586621679054602"><span class="hs-identifier hs-var">existentials</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054600"><span class="hs-identifier hs-var">ctxtProd</span></a></span><span>
</span><span id="line-268"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-269"></span><span>        </span><span class="annot"><a href="#local-6989586621679054595"><span class="hs-identifier hs-type">conIsRecord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-270"></span><span>        </span><span id="local-6989586621679054595"><span class="annot"><span class="annottext">conIsRecord :: Bool
</span><a href="#local-6989586621679054595"><span class="hs-identifier hs-var hs-var">conIsRecord</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-271"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ConstructorVariant
</span><a href="#local-6989586621679054590"><span class="hs-identifier hs-var">conVariant</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-272"></span><span>            </span><span class="annot"><span class="annottext">ConstructorVariant
</span><span class="hs-identifier hs-var">NormalConstructor</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-273"></span><span>            </span><span class="annot"><span class="annottext">ConstructorVariant
</span><span class="hs-identifier hs-var">InfixConstructor</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-274"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">RecordConstructor</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span>        </span><span class="annot"><a href="#local-6989586621679054594"><span class="hs-identifier hs-type">conIsInfix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-277"></span><span>        </span><span id="local-6989586621679054594"><span class="annot"><span class="annottext">conIsInfix :: Bool
</span><a href="#local-6989586621679054594"><span class="hs-identifier hs-var hs-var">conIsInfix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-278"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ConstructorVariant
</span><a href="#local-6989586621679054590"><span class="hs-identifier hs-var">conVariant</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-279"></span><span>            </span><span class="annot"><span class="annottext">ConstructorVariant
</span><span class="hs-identifier hs-var">NormalConstructor</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-280"></span><span>            </span><span class="annot"><span class="annottext">ConstructorVariant
</span><span class="hs-identifier hs-var">InfixConstructor</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-281"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">RecordConstructor</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span>        </span><span class="annot"><a href="#local-6989586621679054601"><span class="hs-identifier hs-type">context</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-284"></span><span>        </span><span id="local-6989586621679054601"><span class="annot"><span class="annottext">context :: Type -&gt; Q Type
</span><a href="#local-6989586621679054601"><span class="hs-identifier hs-var hs-var">context</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; [Type] -&gt; Type -&gt; Q Type
</span><a href="#local-6989586621679054606"><span class="hs-identifier hs-var">ntext</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-special">(</span><span class="hs-operator">:=&gt;:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054607"><span class="hs-identifier hs-var">allTvbNames</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054584"><span class="hs-identifier hs-var">conCtxt</span></a></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span>        </span><span class="annot"><a href="#local-6989586621679054608"><span class="hs-identifier hs-type">cocontext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-287"></span><span>        </span><span id="local-6989586621679054608"><span class="annot"><span class="annottext">cocontext :: [Name] -&gt; [Type] -&gt; Type -&gt; Q Type
</span><a href="#local-6989586621679054608"><span class="hs-identifier hs-var hs-var">cocontext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; [Type] -&gt; Type -&gt; Q Type
</span><a href="#local-6989586621679054606"><span class="hs-identifier hs-var">ntext</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-operator">:=&gt;&gt;:</span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span>        </span><span class="annot"><a href="#local-6989586621679054606"><span class="hs-identifier hs-type">ntext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-290"></span><span>        </span><span id="local-6989586621679054606"><span class="annot"><span class="annottext">ntext :: Name -&gt; [Name] -&gt; [Type] -&gt; Type -&gt; Q Type
</span><a href="#local-6989586621679054606"><span class="hs-identifier hs-var hs-var">ntext</span></a></span></span><span> </span><span id="local-6989586621679054610"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054610"><span class="hs-operator hs-var">(==&gt;)</span></a></span></span><span> </span><span id="local-6989586621679054611"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054611"><span class="hs-identifier hs-var">tvbNames</span></a></span></span><span> </span><span id="local-6989586621679054612"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054612"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679054613"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054613"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-291"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054612"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-292"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Q Type
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054613"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-comment">-- Don't use (:=&gt;:) if there are no constraints</span><span>
</span><span id="line-293"></span><span>            </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Q Type -&gt; Name -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; Name -&gt; m Type -&gt; m Type
</span><span class="hs-identifier hs-var">infixT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; [Type] -&gt; Q Type
</span><a href="#local-6989586621679054614"><span class="hs-identifier hs-var">atomizeContext</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054611"><span class="hs-identifier hs-var">tvbNames</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054612"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054610"><span class="hs-operator hs-var">(==&gt;)</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Q Type
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054613"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span>        </span><span class="annot"><a href="#local-6989586621679054602"><span class="hs-identifier hs-type">existentials</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-296"></span><span>        </span><span id="local-6989586621679054602"><span class="annot"><span class="annottext">existentials :: Type -&gt; Q Type
</span><a href="#local-6989586621679054602"><span class="hs-identifier hs-var hs-var">existentials</span></a></span></span><span> </span><span id="local-6989586621679054615"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054615"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-297"></span><span>          </span><span class="annot"><span class="annottext">(Q Type -&gt; TyVarBndr_ () -&gt; Q Type)
-&gt; Q Type -&gt; [TyVarBndr_ ()] -&gt; Q Type
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679054617"><span class="annot"><span class="annottext">Q Type
</span><a href="#local-6989586621679054617"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679054618"><span class="annot"><span class="annottext">TyVarBndr_ ()
</span><a href="#local-6989586621679054618"><span class="hs-identifier hs-var">tvb</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">conT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Exists</span><span> </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Q Type
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyVarBndr_ () -&gt; Type
forall flag. TyVarBndr_ flag -&gt; Type
</span><span class="hs-identifier hs-var">tvKind</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr_ ()
</span><a href="#local-6989586621679054618"><span class="hs-identifier hs-var">tvb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span> </span><span class="annot"><span class="annottext">Q Type
</span><a href="#local-6989586621679054617"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Q Type
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054615"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr_ ()]
</span><a href="#local-6989586621679054582"><span class="hs-identifier hs-var">exTvbs</span></a></span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span>        </span><span class="annot"><a href="#local-6989586621679054599"><span class="hs-identifier hs-type">selectors</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span>
</span><span id="line-301"></span><span>        </span><span id="local-6989586621679054599"><span class="annot"><span class="annottext">selectors :: Q [Type]
</span><a href="#local-6989586621679054599"><span class="hs-identifier hs-var hs-var">selectors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-302"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ConstructorVariant
</span><a href="#local-6989586621679054590"><span class="hs-identifier hs-var">conVariant</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-303"></span><span>            </span><span class="annot"><span class="annottext">ConstructorVariant
</span><span class="hs-identifier hs-var">NormalConstructor</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Q [Type]
</span><a href="#local-6989586621679054619"><span class="hs-identifier hs-var">nonRecordCase</span></a></span><span>
</span><span id="line-304"></span><span>            </span><span class="annot"><span class="annottext">ConstructorVariant
</span><span class="hs-identifier hs-var">InfixConstructor</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Q [Type]
</span><a href="#local-6989586621679054619"><span class="hs-identifier hs-var">nonRecordCase</span></a></span><span>
</span><span id="line-305"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">RecordConstructor</span></span><span> </span><span id="local-6989586621679054620"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054620"><span class="hs-identifier hs-var">records</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Q [Type]
</span><a href="#local-6989586621679054621"><span class="hs-identifier hs-var">recordCase</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054620"><span class="hs-identifier hs-var">records</span></a></span><span>
</span><span id="line-306"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-307"></span><span>            </span><span class="annot"><a href="#local-6989586621679054619"><span class="hs-identifier hs-type">nonRecordCase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span>
</span><span id="line-308"></span><span>            </span><span id="local-6989586621679054619"><span class="annot"><span class="annottext">nonRecordCase :: Q [Type]
</span><a href="#local-6989586621679054619"><span class="hs-identifier hs-var hs-var">nonRecordCase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Maybe Name] -&gt; Q [Type]
</span><a href="#local-6989586621679054622"><span class="hs-identifier hs-var">mkCase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; Maybe Name) -&gt; [Type] -&gt; [Maybe Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Name -&gt; Type -&gt; Maybe Name
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054586"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span>            </span><span class="annot"><a href="#local-6989586621679054621"><span class="hs-identifier hs-type">recordCase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span>
</span><span id="line-311"></span><span>            </span><span id="local-6989586621679054621"><span class="annot"><span class="annottext">recordCase :: [Name] -&gt; Q [Type]
</span><a href="#local-6989586621679054621"><span class="hs-identifier hs-var hs-var">recordCase</span></a></span></span><span> </span><span id="local-6989586621679054624"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054624"><span class="hs-identifier hs-var">records</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Maybe Name] -&gt; Q [Type]
</span><a href="#local-6989586621679054622"><span class="hs-identifier hs-var">mkCase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; Maybe Name) -&gt; [Name] -&gt; [Maybe Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054624"><span class="hs-identifier hs-var">records</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span>            </span><span class="annot"><a href="#local-6989586621679054622"><span class="hs-identifier hs-type">mkCase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span>
</span><span id="line-314"></span><span>            </span><span id="local-6989586621679054622"><span class="annot"><span class="annottext">mkCase :: [Maybe Name] -&gt; Q [Type]
</span><a href="#local-6989586621679054622"><span class="hs-identifier hs-var hs-var">mkCase</span></a></span></span><span> </span><span id="local-6989586621679054625"><span class="annot"><span class="annottext">[Maybe Name]
</span><a href="#local-6989586621679054625"><span class="hs-identifier hs-var">mbRecords</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-315"></span><span>              </span><span id="local-6989586621679054626"><span class="annot"><span class="annottext">[DecidedStrictness]
</span><a href="#local-6989586621679054626"><span class="hs-identifier hs-var">dcdStricts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q [DecidedStrictness]
</span><span class="hs-identifier hs-var">reifyConStrictness</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054580"><span class="hs-identifier hs-var">conName</span></a></span><span>
</span><span id="line-316"></span><span>              </span><span class="annot"><span class="annottext">(Maybe Name
 -&gt; FieldStrictness -&gt; DecidedStrictness -&gt; Type -&gt; Q Type)
-&gt; [Maybe Name]
-&gt; [FieldStrictness]
-&gt; [DecidedStrictness]
-&gt; [Type]
-&gt; Q [Type]
forall (m :: * -&gt; *) a b c d e.
Monad m =&gt;
(a -&gt; b -&gt; c -&gt; d -&gt; m e) -&gt; [a] -&gt; [b] -&gt; [c] -&gt; [d] -&gt; m [e]
</span><a href="Generics.Kind.TH.html#zipWith4M"><span class="hs-identifier hs-var">zipWith4M</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
-&gt; FieldStrictness -&gt; DecidedStrictness -&gt; Type -&gt; Q Type
</span><a href="#local-6989586621679054629"><span class="hs-identifier hs-var">selector</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe Name]
</span><a href="#local-6989586621679054625"><span class="hs-identifier hs-var">mbRecords</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldStrictness]
</span><a href="#local-6989586621679054588"><span class="hs-identifier hs-var">fieldStricts</span></a></span><span> </span><span class="annot"><span class="annottext">[DecidedStrictness]
</span><a href="#local-6989586621679054626"><span class="hs-identifier hs-var">dcdStricts</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054586"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span>        </span><span class="annot"><a href="#local-6989586621679054629"><span class="hs-identifier hs-type">selector</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FieldStrictness</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TH.DecidedStrictness</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-319"></span><span>        </span><span id="local-6989586621679054629"><span class="annot"><span class="annottext">selector :: Maybe Name
-&gt; FieldStrictness -&gt; DecidedStrictness -&gt; Type -&gt; Q Type
</span><a href="#local-6989586621679054629"><span class="hs-identifier hs-var hs-var">selector</span></a></span></span><span> </span><span id="local-6989586621679054630"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679054630"><span class="hs-identifier hs-var">mbRecord</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FieldStrictness</span></span><span> </span><span id="local-6989586621679054632"><span class="annot"><span class="annottext">Unpackedness
</span><a href="#local-6989586621679054632"><span class="hs-identifier hs-var">fu</span></a></span></span><span> </span><span id="local-6989586621679054633"><span class="annot"><span class="annottext">Strictness
</span><a href="#local-6989586621679054633"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679054634"><span class="annot"><span class="annottext">DecidedStrictness
</span><a href="#local-6989586621679054634"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span id="local-6989586621679054635"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054635"><span class="hs-identifier hs-var">field</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-320"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679054644"><span class="annot"><span class="annottext">mbSelNameT :: Q Type
</span><a href="#local-6989586621679054644"><span class="hs-identifier hs-var hs-var">mbSelNameT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-321"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679054630"><span class="hs-identifier hs-var">mbRecord</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-322"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679054645"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054645"><span class="hs-identifier hs-var">record</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">promotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Just</span><span> </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span> </span><span class="annot"><span class="annottext">Q TyLit -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m TyLit -&gt; m Type
</span><span class="hs-identifier hs-var">litT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Q TyLit
forall (m :: * -&gt; *). Quote m =&gt; String -&gt; m TyLit
</span><span class="hs-identifier hs-var">strTyLit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054645"><span class="hs-identifier hs-var">record</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>                  </span><span class="annot"><span class="annottext">Maybe Name
</span><span class="hs-identifier hs-var">Nothing</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">promotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-324"></span><span>          </span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">conT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">S1</span><span>
</span><span id="line-325"></span><span>            </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">promotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">MetaSel</span><span> </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span>
</span><span id="line-326"></span><span>                    </span><span class="annot"><span class="annottext">Q Type
</span><a href="#local-6989586621679054644"><span class="hs-identifier hs-var">mbSelNameT</span></a></span><span> </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span>
</span><span id="line-327"></span><span>                    </span><span class="annot"><span class="annottext">SourceUnpackedness -&gt; Q Type
</span><a href="Generics.Kind.TH.html#promoteSourceUnpackedness"><span class="hs-identifier hs-var">promoteSourceUnpackedness</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unpackedness -&gt; SourceUnpackedness
</span><a href="Generics.Kind.TH.html#generifyUnpackedness"><span class="hs-identifier hs-var">generifyUnpackedness</span></a></span><span> </span><span class="annot"><span class="annottext">Unpackedness
</span><a href="#local-6989586621679054632"><span class="hs-identifier hs-var">fu</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span>
</span><span id="line-328"></span><span>                    </span><span class="annot"><span class="annottext">SourceStrictness -&gt; Q Type
</span><a href="Generics.Kind.TH.html#promoteSourceStrictness"><span class="hs-identifier hs-var">promoteSourceStrictness</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Strictness -&gt; SourceStrictness
</span><a href="Generics.Kind.TH.html#generifyStrictness"><span class="hs-identifier hs-var">generifyStrictness</span></a></span><span> </span><span class="annot"><span class="annottext">Strictness
</span><a href="#local-6989586621679054633"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span>
</span><span id="line-329"></span><span>                    </span><span class="annot"><span class="annottext">DecidedStrictness -&gt; Q Type
</span><a href="Generics.Kind.TH.html#promoteDecidedStrictness"><span class="hs-identifier hs-var">promoteDecidedStrictness</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DecidedStrictness -&gt; DecidedStrictness
</span><a href="Generics.Kind.TH.html#generifyDecidedStrictness"><span class="hs-identifier hs-var">generifyDecidedStrictness</span></a></span><span> </span><span class="annot"><span class="annottext">DecidedStrictness
</span><a href="#local-6989586621679054634"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>            </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">conT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Field</span><span> </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Type -&gt; Q Type
</span><a href="#local-6989586621679054652"><span class="hs-identifier hs-var">prenex</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054607"><span class="hs-identifier hs-var">allTvbNames</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054635"><span class="hs-identifier hs-var">field</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span>        </span><span class="annot"><a href="#local-6989586621679054614"><span class="hs-identifier hs-type">atomizeContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-333"></span><span>        </span><span id="local-6989586621679054614"><span class="annot"><span class="annottext">atomizeContext :: [Name] -&gt; [Type] -&gt; Q Type
</span><a href="#local-6989586621679054614"><span class="hs-identifier hs-var hs-var">atomizeContext</span></a></span></span><span> </span><span id="local-6989586621679054653"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054653"><span class="hs-identifier hs-var">tvbNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-334"></span><span>          </span><span class="annot"><span class="annottext">(Q Type -&gt; Q Type -&gt; Q Type) -&gt; Q Type -&gt; [Q Type] -&gt; Q Type
forall a. (a -&gt; a -&gt; a) -&gt; a -&gt; [a] -&gt; a
</span><a href="Generics.Kind.TH.html#foldBal"><span class="hs-identifier hs-var">foldBal</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679054654"><span class="annot"><span class="annottext">Q Type
</span><a href="#local-6989586621679054654"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679054655"><span class="annot"><span class="annottext">Q Type
</span><a href="#local-6989586621679054655"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Q Type -&gt; Name -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; Name -&gt; m Type -&gt; m Type
</span><span class="hs-identifier hs-var">infixT</span></span><span> </span><span class="annot"><span class="annottext">Q Type
</span><a href="#local-6989586621679054654"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-operator">:&amp;:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Q Type
</span><a href="#local-6989586621679054655"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">promotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Kon</span><span> </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Int -&gt; m Type
</span><span class="hs-identifier hs-var">tupleT</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>          </span><span class="annot"><span class="annottext">([Q Type] -&gt; Q Type) -&gt; ([Type] -&gt; [Q Type]) -&gt; [Type] -&gt; Q Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Q Type) -&gt; [Type] -&gt; [Q Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; Type -&gt; Q Type
</span><a href="#local-6989586621679054656"><span class="hs-identifier hs-var">atomize</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054653"><span class="hs-identifier hs-var">tvbNames</span></a></span><span class="hs-special">)</span><span class="hs-cpp">

#if MIN_VERSION_template_haskell(2,17,0)
</span><span>        </span><span class="annot"><a href="#local-6989586621679054657"><span class="hs-identifier hs-type">foralls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Specificity</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-cpp">
#else
</span><span>        </span><span class="hs-identifier">foralls</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">TyVarBndr</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Q</span><span> </span><span class="hs-identifier">Type</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Q</span><span> </span><span class="hs-identifier">Type</span><span class="hs-cpp">
#endif
</span><span>        </span><span id="local-6989586621679054657"><span class="annot"><span class="annottext">foralls :: [TyVarBndr Specificity] -&gt; Q Type -&gt; Q Type
</span><a href="#local-6989586621679054657"><span class="hs-identifier hs-var hs-var">foralls</span></a></span></span><span> </span><span id="local-6989586621679054658"><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><a href="#local-6989586621679054658"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621679054659"><span class="annot"><span class="annottext">Q Type
</span><a href="#local-6989586621679054659"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-344"></span><span>           </span><span class="annot"><span class="annottext">(TyVarBndr Specificity -&gt; Q Type -&gt; Q Type)
-&gt; Q Type -&gt; [TyVarBndr Specificity] -&gt; Q Type
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">TyVarBndr Specificity
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679054660"><span class="annot"><span class="annottext">Q Type
</span><a href="#local-6989586621679054660"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">promotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">ForAll</span><span> </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span> </span><span class="annot"><span class="annottext">Q Type
</span><a href="#local-6989586621679054660"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Q Type
</span><a href="#local-6989586621679054659"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><a href="#local-6989586621679054658"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span>        </span><span class="annot"><a href="#local-6989586621679054652"><span class="hs-identifier hs-type">prenex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-347"></span><span>        </span><span id="local-6989586621679054652"><span class="annot"><span class="annottext">prenex :: [Name] -&gt; Type -&gt; Q Type
</span><a href="#local-6989586621679054652"><span class="hs-identifier hs-var hs-var">prenex</span></a></span></span><span> </span><span id="local-6989586621679054661"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054661"><span class="hs-identifier hs-var">tvbNames</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallT</span></span><span> </span><span id="local-6989586621679054663"><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><a href="#local-6989586621679054663"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621679054664"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054664"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679054665"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054665"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-348"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679054666"><span class="annot"><span class="annottext">tvbNames' :: [Name]
</span><a href="#local-6989586621679054666"><span class="hs-identifier hs-var hs-var">tvbNames'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyVarBndr Specificity -&gt; Name)
-&gt; [TyVarBndr Specificity] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr Specificity -&gt; Name
forall flag. TyVarBndr_ flag -&gt; Name
</span><span class="hs-identifier hs-var">tvName</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><a href="#local-6989586621679054663"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054661"><span class="hs-identifier hs-var">tvbNames</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-349"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVarBndr Specificity] -&gt; Q Type -&gt; Q Type
</span><a href="#local-6989586621679054657"><span class="hs-identifier hs-var">foralls</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><a href="#local-6989586621679054663"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">(Q Type -&gt; Q Type) -&gt; (Type -&gt; Q Type) -&gt; Type -&gt; Q Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; [Type] -&gt; Type -&gt; Q Type
</span><a href="#local-6989586621679054608"><span class="hs-identifier hs-var">cocontext</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054666"><span class="hs-identifier hs-var">tvbNames'</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054664"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Q Type) -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Q Type -&gt; Q Type) -&gt; (Type -&gt; Q Type) -&gt; Type -&gt; Q Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Type -&gt; Q Type
</span><a href="#local-6989586621679054652"><span class="hs-identifier hs-var">prenex</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054666"><span class="hs-identifier hs-var">tvbNames'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054665"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-350"></span><span>        </span><span class="annot"><a href="#local-6989586621679054652"><span class="hs-identifier hs-var">prenex</span></a></span><span> </span><span id="local-6989586621679054669"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054669"><span class="hs-identifier hs-var">tvbNames</span></a></span></span><span> </span><span id="local-6989586621679054670"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054670"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Type -&gt; Q Type
</span><a href="#local-6989586621679054656"><span class="hs-identifier hs-var">atomize</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054669"><span class="hs-identifier hs-var">tvbNames</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054670"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span>        </span><span class="annot"><a href="#local-6989586621679054656"><span class="hs-identifier hs-type">atomize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-353"></span><span>        </span><span id="local-6989586621679054656"><span class="annot"><span class="annottext">atomize :: [Name] -&gt; Type -&gt; Q Type
</span><a href="#local-6989586621679054656"><span class="hs-identifier hs-var hs-var">atomize</span></a></span></span><span> </span><span id="local-6989586621679054671"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054671"><span class="hs-identifier hs-var">tvbNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; [Q Type] -&gt; Q Type) -&gt; [Q Type] -&gt; Type -&gt; Q Type
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-354"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-355"></span><span>            </span><span class="hs-comment">-- Collect arguments in a list while descending to the left of AppT,</span><span>
</span><span id="line-356"></span><span>            </span><span class="hs-comment">-- in case this is a type family application.</span><span>
</span><span id="line-357"></span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-358"></span><span>            </span><span class="hs-comment">-- Var case</span><span>
</span><span id="line-359"></span><span>            </span><span id="local-6989586621679054672"><span class="annot"><span class="annottext">go :: Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054672"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679054673"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679054673"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarT</span></span><span> </span><span id="local-6989586621679054674"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054674"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-360"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; Maybe Int
forall a. Eq a =&gt; a -&gt; [a] -&gt; Maybe Int
</span><span class="hs-identifier hs-var">elemIndex</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054674"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054671"><span class="hs-identifier hs-var">tvbNames</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-361"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679054676"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054676"><span class="hs-identifier hs-var">idx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054677"><span class="hs-identifier hs-var">appsT</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; [Q Type] -&gt; Q Type) -&gt; Type -&gt; [Q Type] -&gt; Q Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type
</span><a href="Generics.Kind.TH.html#enumerateTyVar"><span class="hs-identifier hs-var">enumerateTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054676"><span class="hs-identifier hs-var">idx</span></a></span><span>
</span><span id="line-362"></span><span>                </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054679"><span class="hs-identifier hs-var">kon</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054673"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span>            </span><span class="hs-comment">-- Either a type constructor or a type family</span><span>
</span><span id="line-365"></span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679054680"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679054680"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679054681"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054681"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679054682"><span class="annot"><span class="annottext">[Q Type]
</span><a href="#local-6989586621679054682"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-366"></span><span>              </span><span id="local-6989586621679054683"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679054683"><span class="hs-identifier hs-var">isTFS</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Bool
</span><span class="hs-identifier hs-var">isTypeFamilyOrSynonym</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054681"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-367"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679054683"><span class="hs-identifier hs-var">isTFS</span></a></span><span>
</span><span id="line-368"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054684"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054684"><span class="hs-identifier hs-var">fam</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679054685"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054685"><span class="hs-identifier hs-var">arity</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q (Type, Int)
</span><span class="hs-identifier hs-var">promoteNDFamily</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054681"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-369"></span><span>                      </span><span class="hs-special">(</span><span id="local-6989586621679054686"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054686"><span class="hs-identifier hs-var">args1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679054687"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054687"><span class="hs-identifier hs-var">args2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Type] -&gt; ([Type], [Type])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054685"><span class="hs-identifier hs-var">arity</span></a></span><span> </span><span class="annot"><span class="annottext">([Type] -&gt; ([Type], [Type])) -&gt; Q [Type] -&gt; Q ([Type], [Type])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Q Type] -&gt; Q [Type]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a. Monad m =&gt; [m a] -&gt; m [a]
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">[Q Type]
</span><a href="#local-6989586621679054682"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-370"></span><span>                      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679054691"><span class="annot"><span class="annottext">saturated :: Bool
</span><a href="#local-6989586621679054691"><span class="hs-identifier hs-var hs-var">saturated</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; [Type] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="Generics.Kind.TH.html#isKonApp"><span class="hs-identifier hs-var">isKonApp</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054686"><span class="hs-identifier hs-var">args1</span></a></span><span>
</span><span id="line-371"></span><span>                      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679054691"><span class="hs-identifier hs-var">saturated</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054679"><span class="hs-identifier hs-var">kon</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054680"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[Q Type]
</span><a href="#local-6989586621679054682"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-372"></span><span>                      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-373"></span><span>                        </span><span class="annot"><span class="annottext">Name -&gt; Q [Dec]
</span><span class="hs-identifier hs-var">fcfify</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054681"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Q [Dec] -&gt; ([Dec] -&gt; Q ()) -&gt; Q ()
forall a b. Q a -&gt; (a -&gt; Q b) -&gt; Q b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; Q ()
</span><a href="Generics.Kind.TH.html#pushFcfifyQueue"><span class="hs-identifier hs-var">pushFcfifyQueue</span></a></span><span>
</span><span id="line-374"></span><span>                        </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">PromotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Eval</span><span>
</span><span id="line-375"></span><span>                          </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">PromotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Kon</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054684"><span class="hs-identifier hs-var">fam</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="Generics.Kind.TH.html#appAtom"><span class="hs-operator hs-var">`appAtom`</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Type
</span><a href="Generics.Kind.TH.html#consTupleAtom"><span class="hs-identifier hs-var">consTupleAtom</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054686"><span class="hs-identifier hs-var">args1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>                          </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054677"><span class="hs-operator hs-var">`appsT`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Q Type
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Q Type) -&gt; [Type] -&gt; [Q Type]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054687"><span class="hs-identifier hs-var">args2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054679"><span class="hs-identifier hs-var">kon</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054680"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[Q Type]
</span><a href="#local-6989586621679054682"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span>            </span><span class="hs-comment">-- Kon cases</span><span>
</span><span id="line-380"></span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679054698"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679054698"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">PromotedT</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054679"><span class="hs-identifier hs-var">kon</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054698"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-381"></span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679054699"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679054699"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">TupleT</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054679"><span class="hs-identifier hs-var">kon</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054699"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-382"></span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679054701"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679054701"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ArrowT</span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054679"><span class="hs-identifier hs-var">kon</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054701"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-383"></span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679054702"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679054702"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ListT</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054679"><span class="hs-identifier hs-var">kon</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054702"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-384"></span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679054704"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679054704"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">PromotedTupleT</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054679"><span class="hs-identifier hs-var">kon</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054704"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-385"></span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679054706"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679054706"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">PromotedNilT</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054679"><span class="hs-identifier hs-var">kon</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054706"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-386"></span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679054708"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679054708"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">PromotedConsT</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054679"><span class="hs-identifier hs-var">kon</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054708"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-387"></span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679054710"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679054710"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">StarT</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054679"><span class="hs-identifier hs-var">kon</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054710"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-388"></span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679054712"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679054712"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ConstraintT</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054679"><span class="hs-identifier hs-var">kon</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054712"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-389"></span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679054714"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679054714"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">LitT</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054679"><span class="hs-identifier hs-var">kon</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054714"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-390"></span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679054716"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679054716"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">WildCardT</span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054679"><span class="hs-identifier hs-var">kon</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054716"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-391"></span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679054718"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679054718"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">UnboxedTupleT</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054679"><span class="hs-identifier hs-var">kon</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054718"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-392"></span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679054720"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679054720"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">UnboxedSumT</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054679"><span class="hs-identifier hs-var">kon</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054720"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-393"></span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">EqualityT</span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054679"><span class="hs-identifier hs-var">kon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="hs-special">''</span><span class="hs-special">(</span><span class="hs-operator">~~</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>                                       </span><span class="hs-comment">-- EqualityT can refer to both homogeneous</span><span>
</span><span id="line-395"></span><span>                                       </span><span class="hs-comment">-- and heterogeneous equality, but TH always</span><span>
</span><span id="line-396"></span><span>                                       </span><span class="hs-comment">-- splices EqualityT back in as if it were</span><span>
</span><span id="line-397"></span><span>                                       </span><span class="hs-comment">-- homogeneous. To be on the safe side, always</span><span>
</span><span id="line-398"></span><span>                                       </span><span class="hs-comment">-- conservatively assume that the equality it</span><span>
</span><span id="line-399"></span><span>                                       </span><span class="hs-comment">-- heterogeneous, since it is more permissive.</span><span class="hs-cpp">
#if MIN_VERSION_template_haskell(2,17,0)
</span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679054723"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679054723"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">MulArrowT</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054679"><span class="hs-identifier hs-var">kon</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054723"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-404"></span><span>            </span><span class="hs-comment">-- Recursive cases</span><span>
</span><span id="line-405"></span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span id="local-6989586621679054725"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054725"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621679054726"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054726"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054725"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">([Q Type] -&gt; Q Type)
-&gt; ([Q Type] -&gt; [Q Type]) -&gt; [Q Type] -&gt; Q Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054726"><span class="hs-identifier hs-var">ty2</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Q Type -&gt; [Q Type] -&gt; [Q Type]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixT</span></span><span> </span><span id="local-6989586621679054727"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054727"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621679054728"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054728"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679054729"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054729"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054728"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054727"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054729"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UInfixT</span></span><span> </span><span id="local-6989586621679054731"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054731"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621679054732"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054732"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679054733"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054733"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054732"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054731"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054733"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if MIN_VERSION_template_haskell(2,19,0)
</span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PromotedInfixT</span></span><span>  </span><span id="local-6989586621679054735"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054735"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621679054736"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054736"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679054737"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054737"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054736"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054735"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054737"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PromotedUInfixT</span></span><span> </span><span id="local-6989586621679054739"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054739"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621679054740"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054740"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679054741"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054741"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054740"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054739"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054741"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigT</span></span><span> </span><span id="local-6989586621679054742"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054742"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054742"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-413"></span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParensT</span></span><span> </span><span id="local-6989586621679054744"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054744"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Q Type -&gt; Q Type
forall a b. (a -&gt; b) -&gt; Q a -&gt; Q b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><span class="hs-identifier hs-var">ParensT</span></span><span> </span><span class="annot"><span class="annottext">(Q Type -&gt; Q Type) -&gt; ([Q Type] -&gt; Q Type) -&gt; [Q Type] -&gt; Q Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054744"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#if MIN_VERSION_template_haskell(2,15,0)
</span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppKindT</span></span><span> </span><span id="local-6989586621679054746"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054746"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054746"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-416"></span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ImplicitParamT</span></span><span> </span><span id="local-6989586621679054748"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679054748"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679054749"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054749"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">IP</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; Type
</span><span class="hs-identifier hs-var">LitT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; TyLit
</span><span class="hs-identifier hs-var">StrTyLit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679054748"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054749"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>                                         </span><span class="hs-comment">-- Desugar (?n :: T) into (IP &quot;n&quot; T)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-420"></span><span>            </span><span class="hs-comment">-- Failure cases</span><span>
</span><span id="line-421"></span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679054751"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679054751"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">ForallT</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">[Q Type]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Type -&gt; Q Type
forall a. String -&gt; Type -&gt; Q a
</span><a href="#local-6989586621679054752"><span class="hs-identifier hs-var">can'tRepresent</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rank-n type&quot;</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054751"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#if MIN_VERSION_template_haskell(2,16,0)
</span><span>            </span><span class="annot"><a href="#local-6989586621679054672"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679054753"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679054753"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">ForallVisT</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">[Q Type]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Type -&gt; Q Type
forall a. String -&gt; Type -&gt; Q a
</span><a href="#local-6989586621679054752"><span class="hs-identifier hs-var">can'tRepresent</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rank-n type&quot;</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054753"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-426"></span><span>            </span><span class="annot"><a href="#local-6989586621679054679"><span class="hs-identifier hs-type">kon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-427"></span><span>            </span><span id="local-6989586621679054679"><span class="annot"><span class="annottext">kon :: Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054679"><span class="hs-identifier hs-var hs-var">kon</span></a></span></span><span> </span><span id="local-6989586621679054755"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054755"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679054756"><span class="annot"><span class="annottext">[Q Type]
</span><a href="#local-6989586621679054756"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679054757"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054757"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">promotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Kon</span><span> </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Q Type
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054755"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-428"></span><span>                            </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054677"><span class="hs-identifier hs-var">appsT</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054757"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[Q Type]
</span><a href="#local-6989586621679054756"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span>            </span><span class="annot"><a href="#local-6989586621679054677"><span class="hs-identifier hs-type">appsT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-431"></span><span>            </span><span id="local-6989586621679054677"><span class="annot"><span class="annottext">appsT :: Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054677"><span class="hs-identifier hs-var hs-var">appsT</span></a></span></span><span> </span><span id="local-6989586621679054758"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054758"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Q Type
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054758"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-432"></span><span>            </span><span class="annot"><a href="#local-6989586621679054677"><span class="hs-identifier hs-var">appsT</span></a></span><span> </span><span id="local-6989586621679054759"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054759"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054760"><span class="annot"><span class="annottext">Q Type
</span><a href="#local-6989586621679054760"><span class="hs-identifier hs-var">ty2'</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679054761"><span class="annot"><span class="annottext">[Q Type]
</span><a href="#local-6989586621679054761"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679054762"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054762"><span class="hs-identifier hs-var">ty2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Q Type
</span><a href="#local-6989586621679054760"><span class="hs-identifier hs-var">ty2'</span></a></span><span>
</span><span id="line-433"></span><span>                                        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054759"><span class="hs-identifier hs-var">ty1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054762"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-434"></span><span>                                          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PromotedT</span></span><span> </span><span id="local-6989586621679054763"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054763"><span class="hs-identifier hs-var">kon1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">`AppT`</span></span><span> </span><span id="local-6989586621679054764"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054764"><span class="hs-identifier hs-var">tyArg1</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-435"></span><span>                                           </span><span class="annot"><span class="hs-identifier hs-type">PromotedT</span></span><span> </span><span id="local-6989586621679054765"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054765"><span class="hs-identifier hs-var">kon2</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">`AppT`</span></span><span> </span><span id="local-6989586621679054766"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054766"><span class="hs-identifier hs-var">tyArg2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>                                                 </span><span class="hs-glyph">|</span><span>  </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054763"><span class="hs-identifier hs-var">kon1</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Kon</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054765"><span class="hs-identifier hs-var">kon2</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Kon</span><span>
</span><span id="line-437"></span><span>                                                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054679"><span class="hs-identifier hs-var">kon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">AppT</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054764"><span class="hs-identifier hs-var">tyArg1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054766"><span class="hs-identifier hs-var">tyArg2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Q Type]
</span><a href="#local-6989586621679054761"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-438"></span><span>                                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Q Type] -&gt; Q Type
</span><a href="#local-6989586621679054677"><span class="hs-identifier hs-var">appsT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054759"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="Generics.Kind.TH.html#appAtom"><span class="hs-operator hs-var">`appAtom`</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054762"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Q Type]
</span><a href="#local-6989586621679054761"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span>            </span><span id="local-6989586621679054001"><span class="annot"><a href="#local-6989586621679054752"><span class="hs-identifier hs-type">can'tRepresent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><a href="#local-6989586621679054001"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-441"></span><span>            </span><span id="local-6989586621679054752"><span class="annot"><span class="annottext">can'tRepresent :: forall a. String -&gt; Type -&gt; Q a
</span><a href="#local-6989586621679054752"><span class="hs-identifier hs-var hs-var">can'tRepresent</span></a></span></span><span> </span><span id="local-6989586621679054770"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679054770"><span class="hs-identifier hs-var">thing</span></a></span></span><span> </span><span id="local-6989586621679054771"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054771"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q a
forall a. String -&gt; Q a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Q a) -&gt; String -&gt; Q a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unsupported &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679054770"><span class="hs-identifier hs-var">thing</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
forall a. Ppr a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">pprint</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054771"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span>        </span><span class="annot"><a href="#local-6989586621679054607"><span class="hs-identifier hs-type">allTvbNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>
</span><span id="line-444"></span><span>        </span><span id="local-6989586621679054607"><span class="annot"><span class="annottext">allTvbNames :: [Name]
</span><a href="#local-6989586621679054607"><span class="hs-identifier hs-var hs-var">allTvbNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyVarBndr_ () -&gt; Name) -&gt; [TyVarBndr_ ()] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr_ () -&gt; Name
forall flag. TyVarBndr_ flag -&gt; Name
</span><span class="hs-identifier hs-var">tvName</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr_ ()]
</span><a href="#local-6989586621679054582"><span class="hs-identifier hs-var">exTvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054560"><span class="hs-identifier hs-var">univVarNames</span></a></span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span><span>    </span><span class="annot"><a href="#local-6989586621679054593"><span class="hs-identifier hs-type">fixityIPromotedType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TH.Fixity</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-447"></span><span>    </span><span id="local-6989586621679054593"><span class="annot"><span class="annottext">fixityIPromotedType :: Maybe Fixity -&gt; Bool -&gt; Q Type
</span><a href="#local-6989586621679054593"><span class="hs-identifier hs-var hs-var">fixityIPromotedType</span></a></span></span><span> </span><span id="local-6989586621679054773"><span class="annot"><span class="annottext">Maybe Fixity
</span><a href="#local-6989586621679054773"><span class="hs-identifier hs-var">mbFi</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-448"></span><span>               </span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">promotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">InfixI</span><span>
</span><span id="line-449"></span><span>        </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span> </span><span class="annot"><span class="annottext">Associativity -&gt; Q Type
</span><a href="Generics.Kind.TH.html#promoteAssociativity"><span class="hs-identifier hs-var">promoteAssociativity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FixityDirection -&gt; Associativity
</span><a href="Generics.Kind.TH.html#fdToAssociativity"><span class="hs-identifier hs-var">fdToAssociativity</span></a></span><span> </span><span class="annot"><span class="annottext">FixityDirection
</span><a href="#local-6989586621679054776"><span class="hs-identifier hs-var">fd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>        </span><span class="annot"><span class="annottext">Q Type -&gt; Q Type -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m Type -&gt; m Type -&gt; m Type
</span><span class="hs-operator hs-var">`appT`</span></span><span> </span><span class="annot"><span class="annottext">Q TyLit -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; m TyLit -&gt; m Type
</span><span class="hs-identifier hs-var">litT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Q TyLit
forall (m :: * -&gt; *). Quote m =&gt; Integer -&gt; m TyLit
</span><span class="hs-identifier hs-var">numTyLit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054777"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-452"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Fixity</span></span><span> </span><span id="local-6989586621679054777"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054777"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679054776"><span class="annot"><span class="annottext">FixityDirection
</span><a href="#local-6989586621679054776"><span class="hs-identifier hs-var">fd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fixity -&gt; Maybe Fixity -&gt; Fixity
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Fixity
</span><span class="hs-identifier hs-var">defaultFixity</span></span><span> </span><span class="annot"><span class="annottext">Maybe Fixity
</span><a href="#local-6989586621679054773"><span class="hs-identifier hs-var">mbFi</span></a></span><span>
</span><span id="line-453"></span><span>    </span><span class="annot"><a href="#local-6989586621679054593"><span class="hs-identifier hs-var">fixityIPromotedType</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Fixity
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">promotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">PrefixI</span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span class="annot"><a href="Generics.Kind.TH.html#isKonApp"><span class="hs-identifier hs-type">isKonApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-456"></span><span id="isKonApp"><span class="annot"><span class="annottext">isKonApp :: Type -&gt; Bool
</span><a href="Generics.Kind.TH.html#isKonApp"><span class="hs-identifier hs-var hs-var">isKonApp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PromotedT</span></span><span> </span><span id="local-6989586621679054781"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054781"><span class="hs-identifier hs-var">kon</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054781"><span class="hs-identifier hs-var">kon</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Kon</span><span>
</span><span id="line-457"></span><span class="annot"><a href="Generics.Kind.TH.html#isKonApp"><span class="hs-identifier hs-var">isKonApp</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span class="annot"><a href="Generics.Kind.TH.html#appAtom"><span class="hs-identifier hs-type">appAtom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-460"></span><span id="appAtom"><span class="annot"><span class="annottext">appAtom :: Type -&gt; Type -&gt; Type
</span><a href="Generics.Kind.TH.html#appAtom"><span class="hs-identifier hs-var hs-var">appAtom</span></a></span></span><span> </span><span id="local-6989586621679054782"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054782"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679054783"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054783"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Name -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">InfixT</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054782"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-operator">:@:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054783"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-461"></span><span>
</span><span id="line-462"></span><span class="annot"><a href="Generics.Kind.TH.html#consTupleAtom"><span class="hs-identifier hs-type">consTupleAtom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-463"></span><span id="consTupleAtom"><span class="annot"><span class="annottext">consTupleAtom :: [Type] -&gt; Type
</span><a href="Generics.Kind.TH.html#consTupleAtom"><span class="hs-identifier hs-var hs-var">consTupleAtom</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">PromotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Kon</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">PromotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span class="annot"><a href="Generics.Kind.TH.html#consTupleAtom"><span class="hs-identifier hs-var">consTupleAtom</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054784"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054784"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679054785"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054785"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-465"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">PromotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Kon</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">PromotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="Generics.Kind.TH.html#appAtom"><span class="hs-operator hs-var">`appAtom`</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054784"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="Generics.Kind.TH.html#appAtom"><span class="hs-operator hs-var">`appAtom`</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Type
</span><a href="Generics.Kind.TH.html#consTupleAtom"><span class="hs-identifier hs-var">consTupleAtom</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054785"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-466"></span><span>
</span><span id="line-467"></span><span class="annot"><a href="Generics.Kind.TH.html#deriveFromK"><span class="hs-identifier hs-type">deriveFromK</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span>
</span><span id="line-468"></span><span id="deriveFromK"><span class="annot"><span class="annottext">deriveFromK :: [ConstructorInfo] -&gt; Q Dec
</span><a href="Generics.Kind.TH.html#deriveFromK"><span class="hs-identifier hs-var hs-var">deriveFromK</span></a></span></span><span> </span><span id="local-6989586621679054786"><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679054786"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-469"></span><span>  </span><span id="local-6989586621679054787"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054787"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Name
forall (m :: * -&gt; *). Quote m =&gt; String -&gt; m Name
</span><span class="hs-identifier hs-var">newName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;x&quot;</span></span><span>
</span><span id="line-470"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; [Q Clause] -&gt; Q Dec
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; [m Clause] -&gt; m Dec
</span><span class="hs-identifier hs-var">funD</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">fromK</span><span>
</span><span id="line-471"></span><span>       </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Q Pat] -&gt; Q Body -&gt; [Q Dec] -&gt; Q Clause
forall (m :: * -&gt; *).
Quote m =&gt;
[m Pat] -&gt; m Body -&gt; [m Dec] -&gt; m Clause
</span><span class="hs-identifier hs-var">clause</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Pat
</span><span class="hs-identifier hs-var">varP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054787"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-472"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Q Exp -&gt; Q Body
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Body
</span><span class="hs-identifier hs-var">normalB</span></span><span> </span><span class="annot"><span class="annottext">(Q Exp -&gt; Q Body) -&gt; Q Exp -&gt; Q Body
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">conE</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">M1</span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-operator hs-var">`appE`</span></span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; [Q Match] -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; [m Match] -&gt; m Exp
</span><span class="hs-identifier hs-var">caseE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054787"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Q Match]
</span><a href="#local-6989586621679054788"><span class="hs-identifier hs-var">cases</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>               </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-474"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-475"></span><span>    </span><span class="annot"><a href="#local-6989586621679054788"><span class="hs-identifier hs-type">cases</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span class="hs-special">]</span><span>
</span><span id="line-476"></span><span>    </span><span id="local-6989586621679054788"><span class="annot"><span class="annottext">cases :: [Q Match]
</span><a href="#local-6989586621679054788"><span class="hs-identifier hs-var hs-var">cases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; ConstructorInfo -&gt; Q Match)
-&gt; [Int] -&gt; [ConstructorInfo] -&gt; [Q Match]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ConstructorInfo -&gt; Q Match
</span><a href="#local-6989586621679054790"><span class="hs-identifier hs-var">fromCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ConstructorInfo] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679054786"><span class="hs-identifier hs-var">cons</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679054786"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-477"></span><span>
</span><span id="line-478"></span><span>    </span><span class="annot"><a href="#local-6989586621679054790"><span class="hs-identifier hs-type">fromCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- Total number of constructors</span><span>
</span><span id="line-479"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- Constructor index</span><span>
</span><span id="line-480"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span>
</span><span id="line-481"></span><span>    </span><span id="local-6989586621679054790"><span class="annot"><span class="annottext">fromCon :: Int -&gt; Int -&gt; ConstructorInfo -&gt; Q Match
</span><a href="#local-6989586621679054790"><span class="hs-identifier hs-var hs-var">fromCon</span></a></span></span><span> </span><span id="local-6989586621679054792"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054792"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679054793"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054793"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">constructorName :: ConstructorInfo -&gt; Name
</span><span class="hs-identifier hs-var">constructorName</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054794"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054794"><span class="hs-identifier hs-var">conName</span></a></span></span><span>
</span><span id="line-482"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">constructorVars :: ConstructorInfo -&gt; [TyVarBndr_ ()]
</span><span class="hs-identifier hs-var">constructorVars</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054795"><span class="annot"><span class="annottext">[TyVarBndr_ ()]
</span><a href="#local-6989586621679054795"><span class="hs-identifier hs-var">exTvbs</span></a></span></span><span>
</span><span id="line-483"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">constructorContext :: ConstructorInfo -&gt; [Type]
</span><span class="hs-identifier hs-var">constructorContext</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054796"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054796"><span class="hs-identifier hs-var">conCtxt</span></a></span></span><span>
</span><span id="line-484"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">constructorFields :: ConstructorInfo -&gt; [Type]
</span><span class="hs-identifier hs-var">constructorFields</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054797"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054797"><span class="hs-identifier hs-var">fields</span></a></span></span><span>
</span><span id="line-485"></span><span>                               </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-486"></span><span>      </span><span id="local-6989586621679054798"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054798"><span class="hs-identifier hs-var">fNames</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Q [Name]
</span><a href="Generics.Kind.TH.html#newNameList"><span class="hs-identifier hs-var">newNameList</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;f&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Q [Name]) -&gt; Int -&gt; Q [Name]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054797"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-487"></span><span>      </span><span class="annot"><span class="annottext">Q Pat -&gt; Q Body -&gt; [Q Dec] -&gt; Q Match
forall (m :: * -&gt; *).
Quote m =&gt;
m Pat -&gt; m Body -&gt; [m Dec] -&gt; m Match
</span><span class="hs-identifier hs-var">match</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Q Pat] -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; [m Pat] -&gt; m Pat
</span><span class="hs-identifier hs-var">conP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054794"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; Q Pat) -&gt; [Name] -&gt; [Q Pat]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Pat
</span><span class="hs-identifier hs-var">varP</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054798"><span class="hs-identifier hs-var">fNames</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Q Exp -&gt; Q Body
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Body
</span><span class="hs-identifier hs-var">normalB</span></span><span> </span><span class="annot"><span class="annottext">(Q Exp -&gt; Q Body) -&gt; Q Exp -&gt; Q Body
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Q Exp -&gt; Q Exp
</span><a href="Generics.Kind.TH.html#lrE"><span class="hs-identifier hs-var">lrE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054793"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054792"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(Q Exp -&gt; Q Exp) -&gt; Q Exp -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">conE</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">M1</span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-operator hs-var">`appE`</span></span><span>
</span><span id="line-489"></span><span>              </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679054802"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679054802"><span class="hs-identifier hs-var">prod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Q Exp -&gt; Q Exp -&gt; Q Exp) -&gt; Q Exp -&gt; [Q Exp] -&gt; Q Exp
forall a. (a -&gt; a -&gt; a) -&gt; a -&gt; [a] -&gt; a
</span><a href="Generics.Kind.TH.html#foldBal"><span class="hs-identifier hs-var">foldBal</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679054803"><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679054803"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679054804"><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679054804"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Q Exp) -&gt; Q Exp -&gt; Maybe (Q Exp) -&gt; Q Exp
forall (m :: * -&gt; *).
Quote m =&gt;
Maybe (m Exp) -&gt; m Exp -&gt; Maybe (m Exp) -&gt; m Exp
</span><span class="hs-identifier hs-var">infixE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Q Exp -&gt; Maybe (Q Exp)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679054803"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">conE</span></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-operator">:*:</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Q Exp -&gt; Maybe (Q Exp)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679054804"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span>                           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">conE</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">U1</span><span class="hs-special">)</span><span>
</span><span id="line-491"></span><span>                           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; Type -&gt; Q Exp) -&gt; [Name] -&gt; [Type] -&gt; [Q Exp]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; Q Exp
</span><a href="#local-6989586621679054805"><span class="hs-identifier hs-var">fromField</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054798"><span class="hs-identifier hs-var">fNames</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054797"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>                 </span><span id="local-6989586621679054806"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679054806"><span class="hs-identifier hs-var">ctxtProd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
</span><a href="#local-6989586621679054807"><span class="hs-identifier hs-var">context</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679054802"><span class="hs-identifier hs-var">prod</span></a></span><span>
</span><span id="line-493"></span><span>                 </span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
</span><a href="#local-6989586621679054808"><span class="hs-identifier hs-var">existentials</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679054806"><span class="hs-identifier hs-var">ctxtProd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-494"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-495"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-496"></span><span>        </span><span class="annot"><a href="#local-6989586621679054805"><span class="hs-identifier hs-type">fromField</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-497"></span><span>        </span><span id="local-6989586621679054805"><span class="annot"><span class="annottext">fromField :: Name -&gt; Type -&gt; Q Exp
</span><a href="#local-6989586621679054805"><span class="hs-identifier hs-var hs-var">fromField</span></a></span></span><span> </span><span id="local-6989586621679054809"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054809"><span class="hs-identifier hs-var">fName</span></a></span></span><span> </span><span id="local-6989586621679054810"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054810"><span class="hs-identifier hs-var">fty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">conE</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">M1</span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-operator hs-var">`appE`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">conE</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Field</span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-operator hs-var">`appE`</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Q Exp -&gt; Q Exp
</span><a href="#local-6989586621679054811"><span class="hs-identifier hs-var">prenex</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054810"><span class="hs-identifier hs-var">fty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054809"><span class="hs-identifier hs-var">fName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-498"></span><span>
</span><span id="line-499"></span><span>        </span><span class="annot"><a href="#local-6989586621679054811"><span class="hs-identifier hs-type">prenex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-500"></span><span>        </span><span id="local-6989586621679054811"><span class="annot"><span class="annottext">prenex :: Type -&gt; Q Exp -&gt; Q Exp
</span><a href="#local-6989586621679054811"><span class="hs-identifier hs-var hs-var">prenex</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallT</span></span><span> </span><span id="local-6989586621679054812"><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><a href="#local-6989586621679054812"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621679054813"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054813"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679054814"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054814"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679054815"><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679054815"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-501"></span><span>          </span><span class="annot"><span class="annottext">(TyVarBndr Specificity -&gt; Q Exp -&gt; Q Exp)
-&gt; Q Exp -&gt; [TyVarBndr Specificity] -&gt; Q Exp
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">TyVarBndr Specificity
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-identifier hs-var">appE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">conE</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">ForAllI</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Exp -&gt; Q Exp
</span><a href="#local-6989586621679054816"><span class="hs-identifier hs-var">cocontext</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054813"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Q Exp) -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Q Exp -&gt; Q Exp
</span><a href="#local-6989586621679054811"><span class="hs-identifier hs-var">prenex</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054814"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679054815"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><a href="#local-6989586621679054812"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-502"></span><span>        </span><span class="annot"><a href="#local-6989586621679054811"><span class="hs-identifier hs-var">prenex</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679054817"><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679054817"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679054817"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span>        </span><span class="annot"><a href="#local-6989586621679054807"><span class="hs-identifier hs-type">context</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-505"></span><span>        </span><span id="local-6989586621679054807"><span class="annot"><span class="annottext">context :: Exp -&gt; Q Exp
</span><a href="#local-6989586621679054807"><span class="hs-identifier hs-var hs-var">context</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Type] -&gt; Exp -&gt; Q Exp
</span><a href="#local-6989586621679054818"><span class="hs-identifier hs-var">ntext</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">SuchThat</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054796"><span class="hs-identifier hs-var">conCtxt</span></a></span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span>        </span><span class="annot"><a href="#local-6989586621679054816"><span class="hs-identifier hs-type">cocontext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-508"></span><span>        </span><span id="local-6989586621679054816"><span class="annot"><span class="annottext">cocontext :: [Type] -&gt; Exp -&gt; Q Exp
</span><a href="#local-6989586621679054816"><span class="hs-identifier hs-var hs-var">cocontext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Type] -&gt; Exp -&gt; Q Exp
</span><a href="#local-6989586621679054818"><span class="hs-identifier hs-var">ntext</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">SuchThatI</span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span>        </span><span class="annot"><a href="#local-6989586621679054818"><span class="hs-identifier hs-type">ntext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-511"></span><span>        </span><span id="local-6989586621679054818"><span class="annot"><span class="annottext">ntext :: Name -&gt; [Type] -&gt; Exp -&gt; Q Exp
</span><a href="#local-6989586621679054818"><span class="hs-identifier hs-var hs-var">ntext</span></a></span></span><span> </span><span id="local-6989586621679054819"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054819"><span class="hs-identifier hs-var">suchThat</span></a></span></span><span> </span><span id="local-6989586621679054820"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054820"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679054821"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679054821"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-512"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054820"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-513"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679054821"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-514"></span><span>            </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">conE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054819"><span class="hs-identifier hs-var">suchThat</span></a></span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-operator hs-var">`appE`</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679054821"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span>        </span><span class="annot"><a href="#local-6989586621679054808"><span class="hs-identifier hs-type">existentials</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-517"></span><span>        </span><span id="local-6989586621679054808"><span class="annot"><span class="annottext">existentials :: Exp -&gt; Q Exp
</span><a href="#local-6989586621679054808"><span class="hs-identifier hs-var hs-var">existentials</span></a></span></span><span> </span><span id="local-6989586621679054822"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679054822"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Q Exp -&gt; TyVarBndr_ () -&gt; Q Exp)
-&gt; Q Exp -&gt; [TyVarBndr_ ()] -&gt; Q Exp
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679054823"><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679054823"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr_ ()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">conE</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Exists</span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-operator hs-var">`appE`</span></span><span> </span><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679054823"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679054822"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr_ ()]
</span><a href="#local-6989586621679054795"><span class="hs-identifier hs-var">exTvbs</span></a></span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span class="annot"><a href="Generics.Kind.TH.html#deriveToK"><span class="hs-identifier hs-type">deriveToK</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span>
</span><span id="line-520"></span><span id="deriveToK"><span class="annot"><span class="annottext">deriveToK :: [ConstructorInfo] -&gt; Q Dec
</span><a href="Generics.Kind.TH.html#deriveToK"><span class="hs-identifier hs-var hs-var">deriveToK</span></a></span></span><span> </span><span id="local-6989586621679054824"><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679054824"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-521"></span><span>  </span><span id="local-6989586621679054825"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054825"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Name
forall (m :: * -&gt; *). Quote m =&gt; String -&gt; m Name
</span><span class="hs-identifier hs-var">newName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;x&quot;</span></span><span>
</span><span id="line-522"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; [Q Clause] -&gt; Q Dec
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; [m Clause] -&gt; m Dec
</span><span class="hs-identifier hs-var">funD</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">toK</span><span>
</span><span id="line-523"></span><span>       </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Q Pat] -&gt; Q Body -&gt; [Q Dec] -&gt; Q Clause
forall (m :: * -&gt; *).
Quote m =&gt;
[m Pat] -&gt; m Body -&gt; [m Dec] -&gt; m Clause
</span><span class="hs-identifier hs-var">clause</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Q Pat] -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; [m Pat] -&gt; m Pat
</span><span class="hs-identifier hs-var">conP</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Pat
</span><span class="hs-identifier hs-var">varP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054825"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-524"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Q Exp -&gt; Q Body
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Body
</span><span class="hs-identifier hs-var">normalB</span></span><span> </span><span class="annot"><span class="annottext">(Q Exp -&gt; Q Body) -&gt; Q Exp -&gt; Q Body
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; [Q Match] -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; [m Match] -&gt; m Exp
</span><span class="hs-identifier hs-var">caseE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054825"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Q Match]
</span><a href="#local-6989586621679054826"><span class="hs-identifier hs-var">cases</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-525"></span><span>               </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-526"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-527"></span><span>    </span><span class="annot"><a href="#local-6989586621679054826"><span class="hs-identifier hs-type">cases</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span class="hs-special">]</span><span>
</span><span id="line-528"></span><span>    </span><span id="local-6989586621679054826"><span class="annot"><span class="annottext">cases :: [Q Match]
</span><a href="#local-6989586621679054826"><span class="hs-identifier hs-var hs-var">cases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; ConstructorInfo -&gt; Q Match)
-&gt; [Int] -&gt; [ConstructorInfo] -&gt; [Q Match]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ConstructorInfo -&gt; Q Match
</span><a href="#local-6989586621679054827"><span class="hs-identifier hs-var">toCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ConstructorInfo] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679054824"><span class="hs-identifier hs-var">cons</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679054824"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-529"></span><span>
</span><span id="line-530"></span><span>    </span><span class="annot"><a href="#local-6989586621679054827"><span class="hs-identifier hs-type">toCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- Total number of constructors</span><span>
</span><span id="line-531"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- Constructor index</span><span>
</span><span id="line-532"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span>
</span><span id="line-533"></span><span>    </span><span id="local-6989586621679054827"><span class="annot"><span class="annottext">toCon :: Int -&gt; Int -&gt; ConstructorInfo -&gt; Q Match
</span><a href="#local-6989586621679054827"><span class="hs-identifier hs-var hs-var">toCon</span></a></span></span><span> </span><span id="local-6989586621679054828"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054828"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679054829"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054829"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">constructorName :: ConstructorInfo -&gt; Name
</span><span class="hs-identifier hs-var">constructorName</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054830"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054830"><span class="hs-identifier hs-var">conName</span></a></span></span><span>
</span><span id="line-534"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">constructorVars :: ConstructorInfo -&gt; [TyVarBndr_ ()]
</span><span class="hs-identifier hs-var">constructorVars</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054831"><span class="annot"><span class="annottext">[TyVarBndr_ ()]
</span><a href="#local-6989586621679054831"><span class="hs-identifier hs-var">exTvbs</span></a></span></span><span>
</span><span id="line-535"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">constructorContext :: ConstructorInfo -&gt; [Type]
</span><span class="hs-identifier hs-var">constructorContext</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054832"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054832"><span class="hs-identifier hs-var">conCtxt</span></a></span></span><span>
</span><span id="line-536"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">constructorFields :: ConstructorInfo -&gt; [Type]
</span><span class="hs-identifier hs-var">constructorFields</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679054833"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054833"><span class="hs-identifier hs-var">fields</span></a></span></span><span>
</span><span id="line-537"></span><span>                             </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-538"></span><span>      </span><span id="local-6989586621679054834"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054834"><span class="hs-identifier hs-var">fNames</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Q [Name]
</span><a href="Generics.Kind.TH.html#newNameList"><span class="hs-identifier hs-var">newNameList</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;f&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Q [Name]) -&gt; Int -&gt; Q [Name]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054833"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-539"></span><span>      </span><span class="annot"><span class="annottext">Q Pat -&gt; Q Body -&gt; [Q Dec] -&gt; Q Match
forall (m :: * -&gt; *).
Quote m =&gt;
m Pat -&gt; m Body -&gt; [m Dec] -&gt; m Match
</span><span class="hs-identifier hs-var">match</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Q Pat -&gt; Q Pat
</span><a href="Generics.Kind.TH.html#lrP"><span class="hs-identifier hs-var">lrP</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054829"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054828"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(Q Pat -&gt; Q Pat) -&gt; Q Pat -&gt; Q Pat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Q Pat] -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; [m Pat] -&gt; m Pat
</span><span class="hs-identifier hs-var">conP</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">M1</span><span>
</span><span id="line-540"></span><span>              </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679054836"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679054836"><span class="hs-identifier hs-var">prod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Q Pat -&gt; Q Pat -&gt; Q Pat) -&gt; Q Pat -&gt; [Q Pat] -&gt; Q Pat
forall a. (a -&gt; a -&gt; a) -&gt; a -&gt; [a] -&gt; a
</span><a href="Generics.Kind.TH.html#foldBal"><span class="hs-identifier hs-var">foldBal</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679054837"><span class="annot"><span class="annottext">Q Pat
</span><a href="#local-6989586621679054837"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679054838"><span class="annot"><span class="annottext">Q Pat
</span><a href="#local-6989586621679054838"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Q Pat -&gt; Name -&gt; Q Pat -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; m Pat -&gt; Name -&gt; m Pat -&gt; m Pat
</span><span class="hs-identifier hs-var">infixP</span></span><span> </span><span class="annot"><span class="annottext">Q Pat
</span><a href="#local-6989586621679054837"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-operator">:*:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Q Pat
</span><a href="#local-6989586621679054838"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-541"></span><span>                                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Q Pat] -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; [m Pat] -&gt; m Pat
</span><span class="hs-identifier hs-var">conP</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">U1</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-542"></span><span>                                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; Q Pat) -&gt; [Name] -&gt; [Q Pat]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679054839"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054839"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Q Pat] -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; [m Pat] -&gt; m Pat
</span><span class="hs-identifier hs-var">conP</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Q Pat] -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; [m Pat] -&gt; m Pat
</span><span class="hs-identifier hs-var">conP</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Field</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Pat
</span><span class="hs-identifier hs-var">varP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054839"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054834"><span class="hs-identifier hs-var">fNames</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span>                   </span><span id="local-6989586621679054840"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679054840"><span class="hs-identifier hs-var">ctxtProd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Q Pat
</span><a href="#local-6989586621679054841"><span class="hs-identifier hs-var">context</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679054836"><span class="hs-identifier hs-var">prod</span></a></span><span>
</span><span id="line-544"></span><span>                   </span><span class="annot"><span class="annottext">Pat -&gt; Q Pat
</span><a href="#local-6989586621679054842"><span class="hs-identifier hs-var">existentials</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679054840"><span class="hs-identifier hs-var">ctxtProd</span></a></span><span>
</span><span id="line-545"></span><span>              </span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-546"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Q Exp -&gt; Q Body
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Body
</span><span class="hs-identifier hs-var">normalB</span></span><span> </span><span class="annot"><span class="annottext">(Q Exp -&gt; Q Body) -&gt; Q Exp -&gt; Q Body
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Q Exp -&gt; Q Exp -&gt; Q Exp) -&gt; Q Exp -&gt; [Q Exp] -&gt; Q Exp
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-identifier hs-var">appE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">conE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054830"><span class="hs-identifier hs-var">conName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; Type -&gt; Q Exp) -&gt; [Name] -&gt; [Type] -&gt; [Q Exp]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; Q Exp
</span><a href="#local-6989586621679054843"><span class="hs-identifier hs-var">toField</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679054834"><span class="hs-identifier hs-var">fNames</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054833"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-547"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-548"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-549"></span><span>          </span><span class="annot"><a href="#local-6989586621679054843"><span class="hs-identifier hs-type">toField</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-550"></span><span>          </span><span id="local-6989586621679054843"><span class="annot"><span class="annottext">toField :: Name -&gt; Type -&gt; Q Exp
</span><a href="#local-6989586621679054843"><span class="hs-identifier hs-var hs-var">toField</span></a></span></span><span> </span><span id="local-6989586621679054844"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054844"><span class="hs-identifier hs-var">fName</span></a></span></span><span> </span><span id="local-6989586621679054845"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054845"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Q Exp -&gt; Q Exp
</span><a href="#local-6989586621679054846"><span class="hs-identifier hs-var">prenex</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054845"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054844"><span class="hs-identifier hs-var">fName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-551"></span><span>
</span><span id="line-552"></span><span>          </span><span class="annot"><a href="#local-6989586621679054846"><span class="hs-identifier hs-type">prenex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-553"></span><span>          </span><span id="local-6989586621679054846"><span class="annot"><span class="annottext">prenex :: Type -&gt; Q Exp -&gt; Q Exp
</span><a href="#local-6989586621679054846"><span class="hs-identifier hs-var hs-var">prenex</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallT</span></span><span> </span><span id="local-6989586621679054847"><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><a href="#local-6989586621679054847"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621679054848"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054848"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679054849"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054849"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679054850"><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679054850"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-554"></span><span>            </span><span class="annot"><span class="annottext">Type -&gt; Q Exp -&gt; Q Exp
</span><a href="#local-6989586621679054846"><span class="hs-identifier hs-var">prenex</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054849"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Exp -&gt; Q Exp
</span><a href="#local-6989586621679054851"><span class="hs-identifier hs-var">cocontext</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054848"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Q Exp) -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">(Q Exp -&gt; TyVarBndr Specificity -&gt; Q Exp)
-&gt; Q Exp -&gt; [TyVarBndr Specificity] -&gt; Q Exp
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679054853"><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679054853"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr Specificity
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">unwrapI</span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-operator hs-var">`appE`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">toWrappedI</span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-operator hs-var">`appE`</span></span><span> </span><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679054853"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679054850"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr Specificity]
</span><a href="#local-6989586621679054847"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-555"></span><span>          </span><span class="annot"><a href="#local-6989586621679054846"><span class="hs-identifier hs-var">prenex</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679054854"><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679054854"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679054854"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-556"></span><span>
</span><span id="line-557"></span><span>          </span><span class="annot"><a href="#local-6989586621679054841"><span class="hs-identifier hs-type">context</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span>
</span><span id="line-558"></span><span>          </span><span id="local-6989586621679054841"><span class="annot"><span class="annottext">context :: Pat -&gt; Q Pat
</span><a href="#local-6989586621679054841"><span class="hs-identifier hs-var hs-var">context</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Q Pat -&gt; Q Pat) -&gt; [Type] -&gt; Pat -&gt; Q Pat
forall a. (Q a -&gt; Q a) -&gt; [Type] -&gt; a -&gt; Q a
</span><a href="#local-6989586621679054855"><span class="hs-identifier hs-var">ntext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Q Pat] -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; [m Pat] -&gt; m Pat
</span><span class="hs-identifier hs-var">conP</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">SuchThat</span><span> </span><span class="annot"><span class="annottext">([Q Pat] -&gt; Q Pat) -&gt; (Q Pat -&gt; [Q Pat]) -&gt; Q Pat -&gt; Q Pat
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Q Pat -&gt; [Q Pat] -&gt; [Q Pat]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054832"><span class="hs-identifier hs-var">conCtxt</span></a></span><span>
</span><span id="line-559"></span><span>
</span><span id="line-560"></span><span>          </span><span class="annot"><a href="#local-6989586621679054851"><span class="hs-identifier hs-type">cocontext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-561"></span><span>          </span><span id="local-6989586621679054851"><span class="annot"><span class="annottext">cocontext :: [Type] -&gt; Exp -&gt; Q Exp
</span><a href="#local-6989586621679054851"><span class="hs-identifier hs-var hs-var">cocontext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Q Exp -&gt; Q Exp) -&gt; [Type] -&gt; Exp -&gt; Q Exp
forall a. (Q a -&gt; Q a) -&gt; [Type] -&gt; a -&gt; Q a
</span><a href="#local-6989586621679054855"><span class="hs-identifier hs-var">ntext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">unSuchThatI</span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-operator hs-var">`appE`</span></span><span class="hs-special">)</span><span>
</span><span id="line-562"></span><span>
</span><span id="line-563"></span><span>          </span><span id="local-6989586621679054028"><span class="annot"><a href="#local-6989586621679054855"><span class="hs-identifier hs-type">ntext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><a href="#local-6989586621679054028"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><a href="#local-6989586621679054028"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054028"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><a href="#local-6989586621679054028"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-564"></span><span>          </span><span id="local-6989586621679054855"><span class="annot"><span class="annottext">ntext :: forall a. (Q a -&gt; Q a) -&gt; [Type] -&gt; a -&gt; Q a
</span><a href="#local-6989586621679054855"><span class="hs-identifier hs-var hs-var">ntext</span></a></span></span><span> </span><span id="local-6989586621679054858"><span class="annot"><span class="annottext">Q a -&gt; Q a
</span><a href="#local-6989586621679054858"><span class="hs-identifier hs-var">suchThat</span></a></span></span><span> </span><span id="local-6989586621679054859"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054859"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679054860"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054860"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-565"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054859"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-566"></span><span>              </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Q a
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054860"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-567"></span><span>              </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Q a -&gt; Q a
</span><a href="#local-6989586621679054858"><span class="hs-identifier hs-var">suchThat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Q a
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054860"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-568"></span><span>
</span><span id="line-569"></span><span>          </span><span class="annot"><a href="#local-6989586621679054842"><span class="hs-identifier hs-type">existentials</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span>
</span><span id="line-570"></span><span>          </span><span id="local-6989586621679054842"><span class="annot"><span class="annottext">existentials :: Pat -&gt; Q Pat
</span><a href="#local-6989586621679054842"><span class="hs-identifier hs-var hs-var">existentials</span></a></span></span><span> </span><span id="local-6989586621679054861"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679054861"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Q Pat -&gt; TyVarBndr_ () -&gt; Q Pat)
-&gt; Q Pat -&gt; [TyVarBndr_ ()] -&gt; Q Pat
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679054862"><span class="annot"><span class="annottext">Q Pat
</span><a href="#local-6989586621679054862"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr_ ()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Q Pat] -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; [m Pat] -&gt; m Pat
</span><span class="hs-identifier hs-var">conP</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Exists</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Q Pat
</span><a href="#local-6989586621679054862"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat -&gt; Q Pat
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679054861"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr_ ()]
</span><a href="#local-6989586621679054831"><span class="hs-identifier hs-var">exTvbs</span></a></span><span>
</span><span id="line-571"></span><span>
</span><span id="line-572"></span><span class="annot"><span class="hs-comment">-- | If a Type is a SigT, returns its kind signature. Otherwise, return Type.</span></span><span>
</span><span id="line-573"></span><span class="annot"><a href="Generics.Kind.TH.html#typeKind"><span class="hs-identifier hs-type">typeKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Kind</span></span><span>
</span><span id="line-574"></span><span id="typeKind"><span class="annot"><span class="annottext">typeKind :: Type -&gt; Type
</span><a href="Generics.Kind.TH.html#typeKind"><span class="hs-identifier hs-var hs-var">typeKind</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigT</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679054863"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054863"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054863"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-575"></span><span class="annot"><a href="Generics.Kind.TH.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Kind.Type</span><span>
</span><span id="line-576"></span><span>
</span><span id="line-577"></span><span class="annot"><a href="Generics.Kind.TH.html#fdToAssociativity"><span class="hs-identifier hs-type">fdToAssociativity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FixityDirection</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Associativity</span></span><span>
</span><span id="line-578"></span><span id="fdToAssociativity"><span class="annot"><span class="annottext">fdToAssociativity :: FixityDirection -&gt; Associativity
</span><a href="Generics.Kind.TH.html#fdToAssociativity"><span class="hs-identifier hs-var hs-var">fdToAssociativity</span></a></span></span><span> </span><span class="annot"><span class="annottext">FixityDirection
</span><span class="hs-identifier hs-var">InfixL</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Associativity
</span><span class="hs-identifier hs-var">LeftAssociative</span></span><span>
</span><span id="line-579"></span><span class="annot"><a href="Generics.Kind.TH.html#fdToAssociativity"><span class="hs-identifier hs-var">fdToAssociativity</span></a></span><span> </span><span class="annot"><span class="annottext">FixityDirection
</span><span class="hs-identifier hs-var">InfixR</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Associativity
</span><span class="hs-identifier hs-var">RightAssociative</span></span><span>
</span><span id="line-580"></span><span class="annot"><a href="Generics.Kind.TH.html#fdToAssociativity"><span class="hs-identifier hs-var">fdToAssociativity</span></a></span><span> </span><span class="annot"><span class="annottext">FixityDirection
</span><span class="hs-identifier hs-var">InfixN</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Associativity
</span><span class="hs-identifier hs-var">NotAssociative</span></span><span>
</span><span id="line-581"></span><span>
</span><span id="line-582"></span><span class="annot"><a href="Generics.Kind.TH.html#generifyUnpackedness"><span class="hs-identifier hs-type">generifyUnpackedness</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unpackedness</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Generics.SourceUnpackedness</span></span><span>
</span><span id="line-583"></span><span id="generifyUnpackedness"><span class="annot"><span class="annottext">generifyUnpackedness :: Unpackedness -&gt; SourceUnpackedness
</span><a href="Generics.Kind.TH.html#generifyUnpackedness"><span class="hs-identifier hs-var hs-var">generifyUnpackedness</span></a></span></span><span> </span><span class="annot"><span class="annottext">Unpackedness
</span><span class="hs-identifier hs-var">UnspecifiedUnpackedness</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceUnpackedness
</span><span class="hs-identifier hs-var">Generics.NoSourceUnpackedness</span></span><span>
</span><span id="line-584"></span><span class="annot"><a href="Generics.Kind.TH.html#generifyUnpackedness"><span class="hs-identifier hs-var">generifyUnpackedness</span></a></span><span> </span><span class="annot"><span class="annottext">Unpackedness
</span><span class="hs-identifier hs-var">NoUnpack</span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceUnpackedness
</span><span class="hs-identifier hs-var">Generics.SourceNoUnpack</span></span><span>
</span><span id="line-585"></span><span class="annot"><a href="Generics.Kind.TH.html#generifyUnpackedness"><span class="hs-identifier hs-var">generifyUnpackedness</span></a></span><span> </span><span class="annot"><span class="annottext">Unpackedness
</span><span class="hs-identifier hs-var">Unpack</span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceUnpackedness
</span><span class="hs-identifier hs-var">Generics.SourceUnpack</span></span><span>
</span><span id="line-586"></span><span>
</span><span id="line-587"></span><span class="annot"><a href="Generics.Kind.TH.html#generifyStrictness"><span class="hs-identifier hs-type">generifyStrictness</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Strictness</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Generics.SourceStrictness</span></span><span>
</span><span id="line-588"></span><span id="generifyStrictness"><span class="annot"><span class="annottext">generifyStrictness :: Strictness -&gt; SourceStrictness
</span><a href="Generics.Kind.TH.html#generifyStrictness"><span class="hs-identifier hs-var hs-var">generifyStrictness</span></a></span></span><span> </span><span class="annot"><span class="annottext">Strictness
</span><span class="hs-identifier hs-var">UnspecifiedStrictness</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceStrictness
</span><span class="hs-identifier hs-var">Generics.NoSourceStrictness</span></span><span>
</span><span id="line-589"></span><span class="annot"><a href="Generics.Kind.TH.html#generifyStrictness"><span class="hs-identifier hs-var">generifyStrictness</span></a></span><span> </span><span class="annot"><span class="annottext">Strictness
</span><span class="hs-identifier hs-var">Lazy</span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceStrictness
</span><span class="hs-identifier hs-var">Generics.SourceLazy</span></span><span>
</span><span id="line-590"></span><span class="annot"><a href="Generics.Kind.TH.html#generifyStrictness"><span class="hs-identifier hs-var">generifyStrictness</span></a></span><span> </span><span class="annot"><span class="annottext">Strictness
</span><span class="hs-identifier hs-var">THAbs.Strict</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceStrictness
</span><span class="hs-identifier hs-var">Generics.SourceStrict</span></span><span>
</span><span id="line-591"></span><span>
</span><span id="line-592"></span><span class="annot"><a href="Generics.Kind.TH.html#generifyDecidedStrictness"><span class="hs-identifier hs-type">generifyDecidedStrictness</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TH.DecidedStrictness</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Generics.DecidedStrictness</span></span><span>
</span><span id="line-593"></span><span id="generifyDecidedStrictness"><span class="annot"><span class="annottext">generifyDecidedStrictness :: DecidedStrictness -&gt; DecidedStrictness
</span><a href="Generics.Kind.TH.html#generifyDecidedStrictness"><span class="hs-identifier hs-var hs-var">generifyDecidedStrictness</span></a></span></span><span> </span><span class="annot"><span class="annottext">DecidedStrictness
</span><span class="hs-identifier hs-var">TH.DecidedLazy</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DecidedStrictness
</span><span class="hs-identifier hs-var">Generics.DecidedLazy</span></span><span>
</span><span id="line-594"></span><span class="annot"><a href="Generics.Kind.TH.html#generifyDecidedStrictness"><span class="hs-identifier hs-var">generifyDecidedStrictness</span></a></span><span> </span><span class="annot"><span class="annottext">DecidedStrictness
</span><span class="hs-identifier hs-var">TH.DecidedStrict</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DecidedStrictness
</span><span class="hs-identifier hs-var">Generics.DecidedStrict</span></span><span>
</span><span id="line-595"></span><span class="annot"><a href="Generics.Kind.TH.html#generifyDecidedStrictness"><span class="hs-identifier hs-var">generifyDecidedStrictness</span></a></span><span> </span><span class="annot"><span class="annottext">DecidedStrictness
</span><span class="hs-identifier hs-var">TH.DecidedUnpack</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DecidedStrictness
</span><span class="hs-identifier hs-var">Generics.DecidedUnpack</span></span><span>
</span><span id="line-596"></span><span>
</span><span id="line-597"></span><span class="annot"><a href="Generics.Kind.TH.html#promoteSourceUnpackedness"><span class="hs-identifier hs-type">promoteSourceUnpackedness</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Generics.SourceUnpackedness</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-598"></span><span id="promoteSourceUnpackedness"><span class="annot"><span class="annottext">promoteSourceUnpackedness :: SourceUnpackedness -&gt; Q Type
</span><a href="Generics.Kind.TH.html#promoteSourceUnpackedness"><span class="hs-identifier hs-var hs-var">promoteSourceUnpackedness</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceUnpackedness
</span><span class="hs-identifier hs-var">Generics.NoSourceUnpackedness</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">promotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Generics.NoSourceUnpackedness</span><span>
</span><span id="line-599"></span><span class="annot"><a href="Generics.Kind.TH.html#promoteSourceUnpackedness"><span class="hs-identifier hs-var">promoteSourceUnpackedness</span></a></span><span> </span><span class="annot"><span class="annottext">SourceUnpackedness
</span><span class="hs-identifier hs-var">Generics.SourceNoUnpack</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">promotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Generics.SourceNoUnpack</span><span>
</span><span id="line-600"></span><span class="annot"><a href="Generics.Kind.TH.html#promoteSourceUnpackedness"><span class="hs-identifier hs-var">promoteSourceUnpackedness</span></a></span><span> </span><span class="annot"><span class="annottext">SourceUnpackedness
</span><span class="hs-identifier hs-var">Generics.SourceUnpack</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">promotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Generics.SourceUnpack</span><span>
</span><span id="line-601"></span><span>
</span><span id="line-602"></span><span class="annot"><a href="Generics.Kind.TH.html#promoteSourceStrictness"><span class="hs-identifier hs-type">promoteSourceStrictness</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Generics.SourceStrictness</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-603"></span><span id="promoteSourceStrictness"><span class="annot"><span class="annottext">promoteSourceStrictness :: SourceStrictness -&gt; Q Type
</span><a href="Generics.Kind.TH.html#promoteSourceStrictness"><span class="hs-identifier hs-var hs-var">promoteSourceStrictness</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceStrictness
</span><span class="hs-identifier hs-var">Generics.NoSourceStrictness</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">promotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Generics.NoSourceStrictness</span><span>
</span><span id="line-604"></span><span class="annot"><a href="Generics.Kind.TH.html#promoteSourceStrictness"><span class="hs-identifier hs-var">promoteSourceStrictness</span></a></span><span> </span><span class="annot"><span class="annottext">SourceStrictness
</span><span class="hs-identifier hs-var">Generics.SourceLazy</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">promotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Generics.SourceLazy</span><span>
</span><span id="line-605"></span><span class="annot"><a href="Generics.Kind.TH.html#promoteSourceStrictness"><span class="hs-identifier hs-var">promoteSourceStrictness</span></a></span><span> </span><span class="annot"><span class="annottext">SourceStrictness
</span><span class="hs-identifier hs-var">Generics.SourceStrict</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">promotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Generics.SourceStrict</span><span>
</span><span id="line-606"></span><span>
</span><span id="line-607"></span><span class="annot"><a href="Generics.Kind.TH.html#promoteDecidedStrictness"><span class="hs-identifier hs-type">promoteDecidedStrictness</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Generics.DecidedStrictness</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-608"></span><span id="promoteDecidedStrictness"><span class="annot"><span class="annottext">promoteDecidedStrictness :: DecidedStrictness -&gt; Q Type
</span><a href="Generics.Kind.TH.html#promoteDecidedStrictness"><span class="hs-identifier hs-var hs-var">promoteDecidedStrictness</span></a></span></span><span> </span><span class="annot"><span class="annottext">DecidedStrictness
</span><span class="hs-identifier hs-var">Generics.DecidedLazy</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">promotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Generics.DecidedLazy</span><span>
</span><span id="line-609"></span><span class="annot"><a href="Generics.Kind.TH.html#promoteDecidedStrictness"><span class="hs-identifier hs-var">promoteDecidedStrictness</span></a></span><span> </span><span class="annot"><span class="annottext">DecidedStrictness
</span><span class="hs-identifier hs-var">Generics.DecidedStrict</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">promotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Generics.DecidedStrict</span><span>
</span><span id="line-610"></span><span class="annot"><a href="Generics.Kind.TH.html#promoteDecidedStrictness"><span class="hs-identifier hs-var">promoteDecidedStrictness</span></a></span><span> </span><span class="annot"><span class="annottext">DecidedStrictness
</span><span class="hs-identifier hs-var">Generics.DecidedUnpack</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">promotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Generics.DecidedUnpack</span><span>
</span><span id="line-611"></span><span>
</span><span id="line-612"></span><span class="annot"><a href="Generics.Kind.TH.html#promoteAssociativity"><span class="hs-identifier hs-type">promoteAssociativity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Associativity</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-613"></span><span id="promoteAssociativity"><span class="annot"><span class="annottext">promoteAssociativity :: Associativity -&gt; Q Type
</span><a href="Generics.Kind.TH.html#promoteAssociativity"><span class="hs-identifier hs-var hs-var">promoteAssociativity</span></a></span></span><span> </span><span class="annot"><span class="annottext">Associativity
</span><span class="hs-identifier hs-var">LeftAssociative</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">promotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">LeftAssociative</span><span>
</span><span id="line-614"></span><span class="annot"><a href="Generics.Kind.TH.html#promoteAssociativity"><span class="hs-identifier hs-var">promoteAssociativity</span></a></span><span> </span><span class="annot"><span class="annottext">Associativity
</span><span class="hs-identifier hs-var">RightAssociative</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">promotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">RightAssociative</span><span>
</span><span id="line-615"></span><span class="annot"><a href="Generics.Kind.TH.html#promoteAssociativity"><span class="hs-identifier hs-var">promoteAssociativity</span></a></span><span> </span><span class="annot"><span class="annottext">Associativity
</span><span class="hs-identifier hs-var">NotAssociative</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">promotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">NotAssociative</span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span class="annot"><a href="Generics.Kind.TH.html#promoteBool"><span class="hs-identifier hs-type">promoteBool</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-618"></span><span id="promoteBool"><span class="annot"><span class="annottext">promoteBool :: Bool -&gt; Q Type
</span><a href="Generics.Kind.TH.html#promoteBool"><span class="hs-identifier hs-var hs-var">promoteBool</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">promotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">True</span><span>
</span><span id="line-619"></span><span class="annot"><a href="Generics.Kind.TH.html#promoteBool"><span class="hs-identifier hs-var">promoteBool</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Type
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Type
</span><span class="hs-identifier hs-var">promotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">False</span><span>
</span><span id="line-620"></span><span>
</span><span id="line-621"></span><span class="annot"><a href="Generics.Kind.TH.html#enumerateTyVar"><span class="hs-identifier hs-type">enumerateTyVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-622"></span><span class="hs-comment">-- Special-case the first 10, if only to generate more compact code</span><span>
</span><span id="line-623"></span><span id="enumerateTyVar"><span class="annot"><span class="annottext">enumerateTyVar :: Int -&gt; Type
</span><a href="Generics.Kind.TH.html#enumerateTyVar"><span class="hs-identifier hs-var hs-var">enumerateTyVar</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Var0</span><span>
</span><span id="line-624"></span><span class="annot"><a href="Generics.Kind.TH.html#enumerateTyVar"><span class="hs-identifier hs-var">enumerateTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Var1</span><span>
</span><span id="line-625"></span><span class="annot"><a href="Generics.Kind.TH.html#enumerateTyVar"><span class="hs-identifier hs-var">enumerateTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Var2</span><span>
</span><span id="line-626"></span><span class="annot"><a href="Generics.Kind.TH.html#enumerateTyVar"><span class="hs-identifier hs-var">enumerateTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Var3</span><span>
</span><span id="line-627"></span><span class="annot"><a href="Generics.Kind.TH.html#enumerateTyVar"><span class="hs-identifier hs-var">enumerateTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Var4</span><span>
</span><span id="line-628"></span><span class="annot"><a href="Generics.Kind.TH.html#enumerateTyVar"><span class="hs-identifier hs-var">enumerateTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Var5</span><span>
</span><span id="line-629"></span><span class="annot"><a href="Generics.Kind.TH.html#enumerateTyVar"><span class="hs-identifier hs-var">enumerateTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Var6</span><span>
</span><span id="line-630"></span><span class="annot"><a href="Generics.Kind.TH.html#enumerateTyVar"><span class="hs-identifier hs-var">enumerateTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Var7</span><span>
</span><span id="line-631"></span><span class="annot"><a href="Generics.Kind.TH.html#enumerateTyVar"><span class="hs-identifier hs-var">enumerateTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Var8</span><span>
</span><span id="line-632"></span><span class="annot"><a href="Generics.Kind.TH.html#enumerateTyVar"><span class="hs-identifier hs-var">enumerateTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Var9</span><span>
</span><span id="line-633"></span><span class="annot"><a href="Generics.Kind.TH.html#enumerateTyVar"><span class="hs-identifier hs-var">enumerateTyVar</span></a></span><span> </span><span id="local-6989586621679054876"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054876"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">PromotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Var</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Type -&gt; Type) -&gt; Type -&gt; Type
forall a. Int -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Generics.Kind.TH.html#nTimes"><span class="hs-identifier hs-var">nTimes</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054876"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">AppT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">PromotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">VS</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">PromotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">VZ</span><span class="hs-special">)</span><span>
</span><span id="line-634"></span><span>
</span><span id="line-635"></span><span class="annot"><span class="hs-comment">-- | Variant of foldr for producing balanced lists</span></span><span>
</span><span id="line-636"></span><span id="local-6989586621679053954"><span class="annot"><a href="Generics.Kind.TH.html#foldBal"><span class="hs-identifier hs-type">foldBal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679053954"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679053954"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679053954"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679053954"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679053954"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679053954"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-637"></span><span id="foldBal"><span class="annot"><span class="annottext">foldBal :: forall a. (a -&gt; a -&gt; a) -&gt; a -&gt; [a] -&gt; a
</span><a href="Generics.Kind.TH.html#foldBal"><span class="hs-identifier hs-var hs-var">foldBal</span></a></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><span class="hs-identifier">_</span></span><span>  </span><span id="local-6989586621679054878"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054878"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054878"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-638"></span><span class="annot"><a href="Generics.Kind.TH.html#foldBal"><span class="hs-identifier hs-var">foldBal</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679054879"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054879"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054879"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-639"></span><span class="annot"><a href="Generics.Kind.TH.html#foldBal"><span class="hs-identifier hs-var">foldBal</span></a></span><span> </span><span id="local-6989586621679054880"><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621679054880"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679054881"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054881"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679054882"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679054882"><span class="hs-identifier hs-var">l</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054886"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679054886"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679054887"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679054887"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; ([a], [a])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679054882"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679054882"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-640"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; a -&gt; [a] -&gt; a
forall a. (a -&gt; a -&gt; a) -&gt; a -&gt; [a] -&gt; a
</span><a href="Generics.Kind.TH.html#foldBal"><span class="hs-identifier hs-var">foldBal</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621679054880"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054881"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679054886"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621679054880"><span class="hs-operator hs-var">`op`</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; a -&gt; [a] -&gt; a
forall a. (a -&gt; a -&gt; a) -&gt; a -&gt; [a] -&gt; a
</span><a href="Generics.Kind.TH.html#foldBal"><span class="hs-identifier hs-var">foldBal</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621679054880"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054881"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679054887"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-641"></span><span>
</span><span id="line-642"></span><span class="annot"><a href="Generics.Kind.TH.html#lrP"><span class="hs-identifier hs-type">lrP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- Constructor index</span><span>
</span><span id="line-643"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- Total number of constructors</span><span>
</span><span id="line-644"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span>
</span><span id="line-645"></span><span id="lrP"><span class="annot"><span class="annottext">lrP :: Int -&gt; Int -&gt; Q Pat -&gt; Q Pat
</span><a href="Generics.Kind.TH.html#lrP"><span class="hs-identifier hs-var hs-var">lrP</span></a></span></span><span> </span><span id="local-6989586621679054889"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054889"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679054890"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054890"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679054891"><span class="annot"><span class="annottext">Q Pat
</span><a href="#local-6989586621679054891"><span class="hs-identifier hs-var">p</span></a></span></span><span>
</span><span id="line-646"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054890"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Pat
forall a. String -&gt; Q a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lrP: impossible&quot;</span></span><span>
</span><span id="line-647"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054890"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q Pat
</span><a href="#local-6989586621679054891"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-648"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054889"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">div</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054890"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Q Pat] -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; [m Pat] -&gt; m Pat
</span><span class="hs-identifier hs-var">conP</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">L1</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Q Pat -&gt; Q Pat
</span><a href="Generics.Kind.TH.html#lrP"><span class="hs-identifier hs-var">lrP</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054889"><span class="hs-identifier hs-var">i</span></a></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">div</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054890"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Q Pat
</span><a href="#local-6989586621679054891"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-649"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Q Pat] -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; [m Pat] -&gt; m Pat
</span><span class="hs-identifier hs-var">conP</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">R1</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Q Pat -&gt; Q Pat
</span><a href="Generics.Kind.TH.html#lrP"><span class="hs-identifier hs-var">lrP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054889"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054893"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054890"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054893"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>     </span><span class="annot"><span class="annottext">Q Pat
</span><a href="#local-6989586621679054891"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-650"></span><span>                     </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679054893"><span class="annot"><span class="annottext">m :: Int
</span><a href="#local-6989586621679054893"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">div</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054890"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-651"></span><span>
</span><span id="line-652"></span><span class="annot"><a href="Generics.Kind.TH.html#lrE"><span class="hs-identifier hs-type">lrE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- Constructor index</span><span>
</span><span id="line-653"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- Total number of constructors</span><span>
</span><span id="line-654"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-655"></span><span id="lrE"><span class="annot"><span class="annottext">lrE :: Int -&gt; Int -&gt; Q Exp -&gt; Q Exp
</span><a href="Generics.Kind.TH.html#lrE"><span class="hs-identifier hs-var hs-var">lrE</span></a></span></span><span> </span><span id="local-6989586621679054896"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054896"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679054897"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054897"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679054898"><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679054898"><span class="hs-identifier hs-var">e</span></a></span></span><span>
</span><span id="line-656"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054897"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Exp
forall a. String -&gt; Q a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lrE: impossible&quot;</span></span><span>
</span><span id="line-657"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054897"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679054898"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-658"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054896"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">div</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054897"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">conE</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">L1</span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-operator hs-var">`appE`</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Q Exp -&gt; Q Exp
</span><a href="Generics.Kind.TH.html#lrE"><span class="hs-identifier hs-var">lrE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054896"><span class="hs-identifier hs-var">i</span></a></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">div</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054897"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679054898"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-659"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">conE</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">R1</span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-operator hs-var">`appE`</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Q Exp -&gt; Q Exp
</span><a href="Generics.Kind.TH.html#lrE"><span class="hs-identifier hs-var">lrE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054896"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054899"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054897"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054899"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>     </span><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679054898"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-660"></span><span>                     </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679054899"><span class="annot"><span class="annottext">m :: Int
</span><a href="#local-6989586621679054899"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">div</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054897"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-661"></span><span>
</span><span id="line-662"></span><span class="annot"><a href="Generics.Kind.TH.html#isNewtypeVariant"><span class="hs-identifier hs-type">isNewtypeVariant</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DatatypeVariant</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-663"></span><span id="isNewtypeVariant"><span class="annot"><span class="annottext">isNewtypeVariant :: DatatypeVariant -&gt; Bool
</span><a href="Generics.Kind.TH.html#isNewtypeVariant"><span class="hs-identifier hs-var hs-var">isNewtypeVariant</span></a></span></span><span> </span><span class="annot"><span class="annottext">DatatypeVariant
</span><span class="hs-identifier hs-var">Datatype</span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-664"></span><span class="annot"><a href="Generics.Kind.TH.html#isNewtypeVariant"><span class="hs-identifier hs-var">isNewtypeVariant</span></a></span><span> </span><span class="annot"><span class="annottext">DatatypeVariant
</span><span class="hs-identifier hs-var">Newtype</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-665"></span><span class="annot"><a href="Generics.Kind.TH.html#isNewtypeVariant"><span class="hs-identifier hs-var">isNewtypeVariant</span></a></span><span> </span><span class="annot"><span class="annottext">DatatypeVariant
</span><span class="hs-identifier hs-var">DataInstance</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-666"></span><span class="annot"><a href="Generics.Kind.TH.html#isNewtypeVariant"><span class="hs-identifier hs-var">isNewtypeVariant</span></a></span><span> </span><span class="annot"><span class="annottext">DatatypeVariant
</span><span class="hs-identifier hs-var">NewtypeInstance</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-cpp">
#if MIN_VERSION_th_abstraction(0,5,0)
</span><span class="annot"><a href="Generics.Kind.TH.html#isNewtypeVariant"><span class="hs-identifier hs-var">isNewtypeVariant</span></a></span><span> </span><span class="annot"><span class="annottext">DatatypeVariant
</span><span class="hs-identifier hs-var">THAbs.TypeData</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-671"></span><span class="hs-comment">-- | Extract 'Just' the 'Name' from a type variable. If the argument 'Type' is</span><span>
</span><span id="line-672"></span><span class="hs-comment">-- not a type variable, return 'Nothing'.</span><span>
</span><span id="line-673"></span><span class="annot"><a href="Generics.Kind.TH.html#varTToName_maybe"><span class="hs-identifier hs-type">varTToName_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-674"></span><span id="varTToName_maybe"><span class="annot"><span class="annottext">varTToName_maybe :: Type -&gt; Maybe Name
</span><a href="Generics.Kind.TH.html#varTToName_maybe"><span class="hs-identifier hs-var hs-var">varTToName_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarT</span></span><span> </span><span id="local-6989586621679054907"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054907"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054907"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-675"></span><span class="annot"><a href="Generics.Kind.TH.html#varTToName_maybe"><span class="hs-identifier hs-var">varTToName_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigT</span></span><span> </span><span id="local-6989586621679054908"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054908"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Name
</span><a href="Generics.Kind.TH.html#varTToName_maybe"><span class="hs-identifier hs-var">varTToName_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054908"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-676"></span><span class="annot"><a href="Generics.Kind.TH.html#varTToName_maybe"><span class="hs-identifier hs-var">varTToName_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-677"></span><span>
</span><span id="line-678"></span><span class="hs-comment">-- | Extract the 'Name' from a type variable. If the argument 'Type' is not a</span><span>
</span><span id="line-679"></span><span class="hs-comment">-- type variable, throw an error.</span><span>
</span><span id="line-680"></span><span class="annot"><a href="Generics.Kind.TH.html#varTToName"><span class="hs-identifier hs-type">varTToName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-681"></span><span id="varTToName"><span class="annot"><span class="annottext">varTToName :: Type -&gt; Name
</span><a href="Generics.Kind.TH.html#varTToName"><span class="hs-identifier hs-var hs-var">varTToName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name -&gt; Name
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Name
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Not a type variable!&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Name -&gt; Name) -&gt; (Type -&gt; Maybe Name) -&gt; Type -&gt; Name
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Name
</span><a href="Generics.Kind.TH.html#varTToName_maybe"><span class="hs-identifier hs-var">varTToName_maybe</span></a></span><span>
</span><span id="line-682"></span><span>
</span><span id="line-683"></span><span id="local-6989586621679053971"><span id="local-6989586621679053972"><span id="local-6989586621679053973"><span id="local-6989586621679053974"><span id="local-6989586621679053975"><span id="local-6989586621679053976"><span class="annot"><a href="Generics.Kind.TH.html#zipWith4M"><span class="hs-identifier hs-type">zipWith4M</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679053971"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679053972"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679053973"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679053974"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679053975"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679053971"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679053976"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-684"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679053972"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679053973"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679053974"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679053975"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679053971"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679053976"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span></span></span></span></span></span></span><span>
</span><span id="line-685"></span><span id="zipWith4M"><span class="annot"><span class="annottext">zipWith4M :: forall (m :: * -&gt; *) a b c d e.
Monad m =&gt;
(a -&gt; b -&gt; c -&gt; d -&gt; m e) -&gt; [a] -&gt; [b] -&gt; [c] -&gt; [d] -&gt; m [e]
</span><a href="Generics.Kind.TH.html#zipWith4M"><span class="hs-identifier hs-var hs-var">zipWith4M</span></a></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; c -&gt; d -&gt; m e
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="annot"><span class="annottext">[b]
</span><span class="hs-identifier">_</span></span><span>      </span><span class="annot"><span class="annottext">[c]
</span><span class="hs-identifier">_</span></span><span>      </span><span class="annot"><span class="annottext">[d]
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[e] -&gt; m [e]
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-686"></span><span class="annot"><a href="Generics.Kind.TH.html#zipWith4M"><span class="hs-identifier hs-var">zipWith4M</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; c -&gt; d -&gt; m e
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="annot"><span class="annottext">[c]
</span><span class="hs-identifier">_</span></span><span>      </span><span class="annot"><span class="annottext">[d]
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[e] -&gt; m [e]
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-687"></span><span class="annot"><a href="Generics.Kind.TH.html#zipWith4M"><span class="hs-identifier hs-var">zipWith4M</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; c -&gt; d -&gt; m e
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span>      </span><span class="annot"><span class="annottext">[b]
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="annot"><span class="annottext">[d]
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[e] -&gt; m [e]
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-688"></span><span class="annot"><a href="Generics.Kind.TH.html#zipWith4M"><span class="hs-identifier hs-var">zipWith4M</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; c -&gt; d -&gt; m e
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span>      </span><span class="annot"><span class="annottext">[b]
</span><span class="hs-identifier">_</span></span><span>      </span><span class="annot"><span class="annottext">[c]
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[e] -&gt; m [e]
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-689"></span><span class="annot"><a href="Generics.Kind.TH.html#zipWith4M"><span class="hs-identifier hs-var">zipWith4M</span></a></span><span> </span><span id="local-6989586621679054921"><span class="annot"><span class="annottext">a -&gt; b -&gt; c -&gt; d -&gt; m e
</span><a href="#local-6989586621679054921"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054922"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054922"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679054923"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679054923"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054924"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679054924"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679054925"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679054925"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054926"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679054926"><span class="hs-identifier hs-var">z</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679054927"><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621679054927"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679054928"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679054928"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679054929"><span class="annot"><span class="annottext">[d]
</span><a href="#local-6989586621679054929"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-690"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679054930"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679054930"><span class="hs-identifier hs-var">r</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; c -&gt; d -&gt; m e
</span><a href="#local-6989586621679054921"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679054922"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679054924"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679054926"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679054928"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-691"></span><span>       </span><span id="local-6989586621679054931"><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621679054931"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; c -&gt; d -&gt; m e) -&gt; [a] -&gt; [b] -&gt; [c] -&gt; [d] -&gt; m [e]
forall (m :: * -&gt; *) a b c d e.
Monad m =&gt;
(a -&gt; b -&gt; c -&gt; d -&gt; m e) -&gt; [a] -&gt; [b] -&gt; [c] -&gt; [d] -&gt; m [e]
</span><a href="Generics.Kind.TH.html#zipWith4M"><span class="hs-identifier hs-var">zipWith4M</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; c -&gt; d -&gt; m e
</span><a href="#local-6989586621679054921"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679054923"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679054925"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="annot"><span class="annottext">[c]
</span><a href="#local-6989586621679054927"><span class="hs-identifier hs-var">zs</span></a></span><span> </span><span class="annot"><span class="annottext">[d]
</span><a href="#local-6989586621679054929"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-692"></span><span>       </span><span class="annot"><span class="annottext">[e] -&gt; m [e]
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([e] -&gt; m [e]) -&gt; [e] -&gt; m [e]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679054930"><span class="hs-identifier hs-var">r</span></a></span><span class="annot"><span class="annottext">e -&gt; [e] -&gt; [e]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621679054931"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-693"></span><span>
</span><span id="line-694"></span><span class="annot"><span class="hs-comment">-- | Compose a function with itself n times.  (nth rather than twice)</span></span><span>
</span><span id="line-695"></span><span id="local-6989586621679054030"><span class="annot"><a href="Generics.Kind.TH.html#nTimes"><span class="hs-identifier hs-type">nTimes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054030"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054030"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679054030"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679054030"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-696"></span><span id="nTimes"><span class="annot"><span class="annottext">nTimes :: forall a. Int -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Generics.Kind.TH.html#nTimes"><span class="hs-identifier hs-var hs-var">nTimes</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-697"></span><span class="annot"><a href="Generics.Kind.TH.html#nTimes"><span class="hs-identifier hs-var">nTimes</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span id="local-6989586621679054939"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679054939"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679054939"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-698"></span><span class="annot"><a href="Generics.Kind.TH.html#nTimes"><span class="hs-identifier hs-var">nTimes</span></a></span><span> </span><span id="local-6989586621679054940"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054940"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679054941"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679054941"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679054941"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; (a -&gt; a) -&gt; a -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; (a -&gt; a) -&gt; a -&gt; a
forall a. Int -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Generics.Kind.TH.html#nTimes"><span class="hs-identifier hs-var">nTimes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054940"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679054941"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-699"></span><span>
</span><span id="line-700"></span><span class="annot"><span class="hs-comment">-- | Generate a list of fresh names with a common prefix, and numbered suffixes.</span></span><span>
</span><span id="line-701"></span><span class="annot"><a href="Generics.Kind.TH.html#newNameList"><span class="hs-identifier hs-type">newNameList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>
</span><span id="line-702"></span><span id="newNameList"><span class="annot"><span class="annottext">newNameList :: String -&gt; Int -&gt; Q [Name]
</span><a href="Generics.Kind.TH.html#newNameList"><span class="hs-identifier hs-var hs-var">newNameList</span></a></span></span><span> </span><span id="local-6989586621679054942"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679054942"><span class="hs-identifier hs-var">prefix</span></a></span></span><span> </span><span id="local-6989586621679054943"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054943"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Q Name) -&gt; [Int] -&gt; Q [Name]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Q Name
forall (m :: * -&gt; *). Quote m =&gt; String -&gt; m Name
</span><span class="hs-identifier hs-var">newName</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Q Name) -&gt; (Int -&gt; String) -&gt; Int -&gt; Q Name
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679054942"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (Int -&gt; String) -&gt; Int -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679054943"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-703"></span><span>
</span><span id="line-704"></span><span class="annot"><a href="Generics.Kind.TH.html#gatherExistentials"><span class="hs-identifier hs-type">gatherExistentials</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TyVarBndrUnit</span></span><span class="hs-special">]</span><span>
</span><span id="line-705"></span><span id="gatherExistentials"><span class="annot"><span class="annottext">gatherExistentials :: [ConstructorInfo] -&gt; [TyVarBndr_ ()]
</span><a href="Generics.Kind.TH.html#gatherExistentials"><span class="hs-identifier hs-var hs-var">gatherExistentials</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ConstructorInfo -&gt; [TyVarBndr_ ()])
-&gt; [ConstructorInfo] -&gt; [TyVarBndr_ ()]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">ConstructorInfo -&gt; [TyVarBndr_ ()]
</span><span class="hs-identifier hs-var">constructorVars</span></span><span>
</span><span id="line-706"></span><span>
</span><span id="line-707"></span><span class="annot"><a href="Generics.Kind.TH.html#gatherConstraints"><span class="hs-identifier hs-type">gatherConstraints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Pred</span></span><span class="hs-special">]</span><span>
</span><span id="line-708"></span><span id="gatherConstraints"><span class="annot"><span class="annottext">gatherConstraints :: [ConstructorInfo] -&gt; [Type]
</span><a href="Generics.Kind.TH.html#gatherConstraints"><span class="hs-identifier hs-var hs-var">gatherConstraints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ConstructorInfo -&gt; [Type]) -&gt; [ConstructorInfo] -&gt; [Type]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">ConstructorInfo -&gt; [Type]
</span><span class="hs-identifier hs-var">constructorContext</span></span><span>
</span><span id="line-709"></span><span>
</span><span id="line-710"></span><span class="annot"><a href="Generics.Kind.TH.html#gatherFields"><span class="hs-identifier hs-type">gatherFields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span>
</span><span id="line-711"></span><span id="gatherFields"><span class="annot"><span class="annottext">gatherFields :: [ConstructorInfo] -&gt; [Type]
</span><a href="Generics.Kind.TH.html#gatherFields"><span class="hs-identifier hs-var hs-var">gatherFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ConstructorInfo -&gt; [Type]) -&gt; [ConstructorInfo] -&gt; [Type]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">ConstructorInfo -&gt; [Type]
</span><span class="hs-identifier hs-var">constructorFields</span></span><span>
</span><span id="line-712"></span><span>
</span><span id="line-713"></span><span class="annot"><span class="hs-comment">-- | Detect if a name occurs as an argument to some type family.</span></span><span>
</span><span id="line-714"></span><span class="annot"><a href="Generics.Kind.TH.html#isInTypeFamilyApp"><span class="hs-identifier hs-type">isInTypeFamilyApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-715"></span><span id="isInTypeFamilyApp"><span class="annot"><span class="annottext">isInTypeFamilyApp :: Name -&gt; Type -&gt; Q Bool
</span><a href="Generics.Kind.TH.html#isInTypeFamilyApp"><span class="hs-identifier hs-var hs-var">isInTypeFamilyApp</span></a></span></span><span> </span><span id="local-6989586621679054946"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054946"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Q Bool
</span><a href="#local-6989586621679054947"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-716"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-717"></span><span>    </span><span class="annot"><a href="#local-6989586621679054947"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-718"></span><span>    </span><span id="local-6989586621679054947"><span class="annot"><span class="annottext">go :: Type -&gt; Q Bool
</span><a href="#local-6989586621679054947"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679054948"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679054948"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; (Type, [Type])
</span><a href="Generics.Kind.TH.html#splitAppTs"><span class="hs-identifier hs-var">splitAppTs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054948"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-719"></span><span>                              </span><span class="hs-special">(</span><span id="local-6989586621679054950"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054950"><span class="hs-identifier hs-var">tyFun</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679054951"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054951"><span class="hs-identifier hs-var">tyArgs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-720"></span><span>                                </span><span class="hs-glyph">|</span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679054952"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054952"><span class="hs-identifier hs-var">tcName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054950"><span class="hs-identifier hs-var">tyFun</span></a></span><span>
</span><span id="line-721"></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Type] -&gt; Q Bool
</span><a href="#local-6989586621679054953"><span class="hs-identifier hs-var">goTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054952"><span class="hs-identifier hs-var">tcName</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054951"><span class="hs-identifier hs-var">tyArgs</span></a></span><span>
</span><span id="line-722"></span><span>                                </span><span class="hs-glyph">|</span><span>  </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-723"></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">or</span></span><span> </span><span class="annot"><span class="annottext">([Bool] -&gt; Bool) -&gt; Q [Bool] -&gt; Q Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Q Bool) -&gt; [Type] -&gt; Q [Bool]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Q Bool
</span><a href="#local-6989586621679054947"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054950"><span class="hs-identifier hs-var">tyFun</span></a></span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; [Type]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054951"><span class="hs-identifier hs-var">tyArgs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-724"></span><span>    </span><span class="annot"><a href="#local-6989586621679054947"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixT</span></span><span> </span><span id="local-6989586621679054954"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054954"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621679054955"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054955"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679054956"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054956"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Q Bool
</span><a href="#local-6989586621679054947"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054955"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054954"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054956"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-725"></span><span>    </span><span class="annot"><a href="#local-6989586621679054947"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigT</span></span><span> </span><span id="local-6989586621679054957"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054957"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679054958"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054958"><span class="hs-identifier hs-var">ki</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool -&gt; Bool) -&gt; Q Bool -&gt; Q Bool -&gt; Q Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; Q a -&gt; Q b -&gt; Q c
forall (f :: * -&gt; *) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><span class="hs-identifier hs-var">liftA2</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">(||)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Q Bool
</span><a href="#local-6989586621679054947"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054957"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Q Bool
</span><a href="#local-6989586621679054947"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054958"><span class="hs-identifier hs-var">ki</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-726"></span><span>    </span><span class="annot"><a href="#local-6989586621679054947"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParensT</span></span><span> </span><span id="local-6989586621679054961"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054961"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Q Bool
</span><a href="#local-6989586621679054947"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054961"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-727"></span><span>    </span><span class="annot"><a href="#local-6989586621679054947"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Q Bool
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-728"></span><span>
</span><span id="line-729"></span><span>    </span><span class="annot"><a href="#local-6989586621679054953"><span class="hs-identifier hs-type">goTyConApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-730"></span><span>    </span><span id="local-6989586621679054953"><span class="annot"><span class="annottext">goTyConApp :: Name -&gt; [Type] -&gt; Q Bool
</span><a href="#local-6989586621679054953"><span class="hs-identifier hs-var hs-var">goTyConApp</span></a></span></span><span> </span><span id="local-6989586621679054962"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054962"><span class="hs-identifier hs-var">tcName</span></a></span></span><span> </span><span id="local-6989586621679054963"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054963"><span class="hs-identifier hs-var">tcArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-731"></span><span>      </span><span id="local-6989586621679054964"><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679054964"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Info
</span><span class="hs-identifier hs-var">reify</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054962"><span class="hs-identifier hs-var">tcName</span></a></span><span>
</span><span id="line-732"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679054964"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-733"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">FamilyI</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OpenTypeFamilyD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TypeFamilyHead</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679054969"><span class="annot"><span class="annottext">[TyVarBndr BndrVis]
</span><a href="#local-6989586621679054969"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span> </span><span class="annot"><span class="annottext">FamilyResultSig
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe InjectivityAnn
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-734"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr BndrVis] -&gt; Q Bool
forall a. [a] -&gt; Q Bool
</span><a href="#local-6989586621679054970"><span class="hs-identifier hs-var">withinFirstArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr BndrVis]
</span><a href="#local-6989586621679054969"><span class="hs-identifier hs-var">bndrs</span></a></span><span>
</span><span id="line-735"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">FamilyI</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ClosedTypeFamilyD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TypeFamilyHead</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679054972"><span class="annot"><span class="annottext">[TyVarBndr BndrVis]
</span><a href="#local-6989586621679054972"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span> </span><span class="annot"><span class="annottext">FamilyResultSig
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe InjectivityAnn
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TySynEqn]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-736"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr BndrVis] -&gt; Q Bool
forall a. [a] -&gt; Q Bool
</span><a href="#local-6989586621679054970"><span class="hs-identifier hs-var">withinFirstArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr BndrVis]
</span><a href="#local-6989586621679054972"><span class="hs-identifier hs-var">bndrs</span></a></span><span>
</span><span id="line-737"></span><span>        </span><span class="annot"><span class="annottext">Info
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Q Bool
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-738"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-739"></span><span>        </span><span id="local-6989586621679054055"><span class="annot"><a href="#local-6989586621679054970"><span class="hs-identifier hs-type">withinFirstArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679054055"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-740"></span><span>        </span><span id="local-6989586621679054970"><span class="annot"><span class="annottext">withinFirstArgs :: forall a. [a] -&gt; Q Bool
</span><a href="#local-6989586621679054970"><span class="hs-identifier hs-var hs-var">withinFirstArgs</span></a></span></span><span> </span><span id="local-6989586621679054977"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679054977"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-741"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679054979"><span class="annot"><span class="annottext">firstArgs :: [Type]
</span><a href="#local-6989586621679054979"><span class="hs-identifier hs-var hs-var">firstArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Type] -&gt; [Type]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679054977"><span class="hs-identifier hs-var">bndrs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054963"><span class="hs-identifier hs-var">tcArgs</span></a></span><span>
</span><span id="line-742"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Q Bool
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Q Bool) -&gt; Bool -&gt; Q Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054946"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Name]
forall a. TypeSubstitution a =&gt; a -&gt; [Name]
</span><span class="hs-identifier hs-var">freeVariables</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054979"><span class="hs-identifier hs-var">firstArgs</span></a></span><span>
</span><span id="line-743"></span><span>
</span><span id="line-744"></span><span class="annot"><span class="hs-comment">-- | Split a chain of 'AppT's to a linear chain of arguments.</span></span><span>
</span><span id="line-745"></span><span class="annot"><a href="Generics.Kind.TH.html#splitAppTs"><span class="hs-identifier hs-type">splitAppTs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-746"></span><span id="splitAppTs"><span class="annot"><span class="annottext">splitAppTs :: Type -&gt; (Type, [Type])
</span><a href="Generics.Kind.TH.html#splitAppTs"><span class="hs-identifier hs-var hs-var">splitAppTs</span></a></span></span><span> </span><span id="local-6989586621679054982"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054982"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [Type] -&gt; (Type, [Type])
</span><a href="#local-6989586621679054983"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054982"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054982"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-747"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-748"></span><span>    </span><span class="annot"><a href="#local-6989586621679054983"><span class="hs-identifier hs-type">split</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-749"></span><span>    </span><span id="local-6989586621679054983"><span class="annot"><span class="annottext">split :: Type -&gt; Type -&gt; [Type] -&gt; (Type, [Type])
</span><a href="#local-6989586621679054983"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span id="local-6989586621679054984"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054984"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621679054985"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054985"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span>     </span><span id="local-6989586621679054986"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054986"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [Type] -&gt; (Type, [Type])
</span><a href="#local-6989586621679054983"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054984"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054984"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054985"><span class="hs-identifier hs-var">ty2</span></a></span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; [Type]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054986"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-750"></span><span>    </span><span class="annot"><a href="#local-6989586621679054983"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621679054987"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054987"><span class="hs-identifier hs-var">origTy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixT</span></span><span> </span><span id="local-6989586621679054988"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054988"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621679054989"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054989"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679054990"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054990"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679054991"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054991"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [Type] -&gt; (Type, [Type])
</span><a href="#local-6989586621679054983"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054987"><span class="hs-identifier hs-var">origTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679054989"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054988"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054990"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054991"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-751"></span><span>    </span><span class="annot"><a href="#local-6989586621679054983"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621679054992"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054992"><span class="hs-identifier hs-var">origTy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigT</span></span><span> </span><span id="local-6989586621679054993"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054993"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>       </span><span id="local-6989586621679054994"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054994"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [Type] -&gt; (Type, [Type])
</span><a href="#local-6989586621679054983"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054992"><span class="hs-identifier hs-var">origTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054993"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054994"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-752"></span><span>    </span><span class="annot"><a href="#local-6989586621679054983"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621679054995"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054995"><span class="hs-identifier hs-var">origTy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParensT</span></span><span> </span><span id="local-6989586621679054996"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054996"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">)</span><span>      </span><span id="local-6989586621679054997"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054997"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [Type] -&gt; (Type, [Type])
</span><a href="#local-6989586621679054983"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054995"><span class="hs-identifier hs-var">origTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054996"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054997"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-753"></span><span>    </span><span class="annot"><a href="#local-6989586621679054983"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621679054998"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054998"><span class="hs-identifier hs-var">origTy</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>                  </span><span id="local-6989586621679054999"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054999"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679054998"><span class="hs-identifier hs-var">origTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679054999"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-754"></span><span>
</span><span id="line-755"></span><span class="annot"><span class="hs-comment">-- | Resolve all of the type synonyms in a 'ConstructorInfo'.</span></span><span>
</span><span id="line-756"></span><span class="annot"><a href="Generics.Kind.TH.html#resolveConSynonyms"><span class="hs-identifier hs-type">resolveConSynonyms</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span>
</span><span id="line-757"></span><span id="resolveConSynonyms"><span class="annot"><span class="annottext">resolveConSynonyms :: ConstructorInfo -&gt; Q ConstructorInfo
</span><a href="Generics.Kind.TH.html#resolveConSynonyms"><span class="hs-identifier hs-var hs-var">resolveConSynonyms</span></a></span></span><span> </span><span id="local-6989586621679055000"><span class="annot"><span class="annottext">con :: ConstructorInfo
</span><a href="#local-6989586621679055000"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">constructorVars :: ConstructorInfo -&gt; [TyVarBndr_ ()]
</span><span class="hs-identifier hs-var">constructorVars</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679055001"><span class="annot"><span class="annottext">[TyVarBndr_ ()]
</span><a href="#local-6989586621679055001"><span class="hs-identifier hs-var">vars</span></a></span></span><span>
</span><span id="line-758"></span><span>                                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">constructorContext :: ConstructorInfo -&gt; [Type]
</span><span class="hs-identifier hs-var">constructorContext</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679055002"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679055002"><span class="hs-identifier hs-var">context</span></a></span></span><span>
</span><span id="line-759"></span><span>                                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">constructorFields :: ConstructorInfo -&gt; [Type]
</span><span class="hs-identifier hs-var">constructorFields</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679055003"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679055003"><span class="hs-identifier hs-var">fields</span></a></span></span><span>
</span><span id="line-760"></span><span>                                      </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-761"></span><span>  </span><span id="local-6989586621679055004"><span class="annot"><span class="annottext">[TyVarBndr_ ()]
</span><a href="#local-6989586621679055004"><span class="hs-identifier hs-var">vars'</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyVarBndr_ () -&gt; Q (TyVarBndr_ ()))
-&gt; [TyVarBndr_ ()] -&gt; Q [TyVarBndr_ ()]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679055005"><span class="annot"><span class="annottext">TyVarBndr_ ()
</span><a href="#local-6989586621679055005"><span class="hs-identifier hs-var">tvb</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-762"></span><span>                         </span><span class="annot"><span class="annottext">(Name -&gt; Q (TyVarBndr_ ()))
-&gt; (Name -&gt; Type -&gt; Q (TyVarBndr_ ()))
-&gt; TyVarBndr_ ()
-&gt; Q (TyVarBndr_ ())
forall r flag.
(Name -&gt; r) -&gt; (Name -&gt; Type -&gt; r) -&gt; TyVarBndr_ flag -&gt; r
</span><span class="hs-identifier hs-var">elimTV</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679055007"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679055007"><span class="hs-identifier hs-var">_n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyVarBndr_ () -&gt; Q (TyVarBndr_ ())
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr_ ()
</span><a href="#local-6989586621679055005"><span class="hs-identifier hs-var">tvb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-763"></span><span>                                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679055008"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679055008"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679055009"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679055009"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; TyVarBndr_ ()
forall flag. DefaultBndrFlag flag =&gt; Name -&gt; Type -&gt; TyVarBndr flag
</span><span class="hs-identifier hs-var">kindedTV</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679055008"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; TyVarBndr_ ()) -&gt; Q Type -&gt; Q (TyVarBndr_ ())
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Q Type
</span><span class="hs-identifier hs-var">resolveTypeSynonyms</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679055009"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyVarBndr_ ()
</span><a href="#local-6989586621679055005"><span class="hs-identifier hs-var">tvb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr_ ()]
</span><a href="#local-6989586621679055001"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-764"></span><span>  </span><span id="local-6989586621679055011"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679055011"><span class="hs-identifier hs-var">context'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Q Type) -&gt; [Type] -&gt; Q [Type]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Q Type
</span><span class="hs-identifier hs-var">resolveTypeSynonyms</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679055002"><span class="hs-identifier hs-var">context</span></a></span><span>
</span><span id="line-765"></span><span>  </span><span id="local-6989586621679055012"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679055012"><span class="hs-identifier hs-var">fields'</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Q Type) -&gt; [Type] -&gt; Q [Type]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Q Type
</span><span class="hs-identifier hs-var">resolveTypeSynonyms</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679055003"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-766"></span><span>  </span><span class="annot"><span class="annottext">ConstructorInfo -&gt; Q ConstructorInfo
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ConstructorInfo -&gt; Q ConstructorInfo)
-&gt; ConstructorInfo -&gt; Q ConstructorInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConstructorInfo
</span><a href="#local-6989586621679055000"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-identifier hs-var">constructorVars</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679055004"><span class="hs-identifier hs-type">vars'</span></a></span><span>
</span><span id="line-767"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-var">constructorContext</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679055011"><span class="hs-identifier hs-type">context'</span></a></span><span>
</span><span id="line-768"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-var">constructorFields</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679055012"><span class="hs-identifier hs-type">fields'</span></a></span><span>
</span><span id="line-769"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-770"></span><span>
</span><span id="line-771"></span><span class="hs-comment">-- | Store 'GenericK' instances to be produced after having typechecked</span><span>
</span><span id="line-772"></span><span class="hs-comment">-- 'fcfify'-generated instances.</span><span>
</span><span id="line-773"></span><span class="hs-keyword">newtype</span><span> </span><span id="GenericKQueue"><span class="annot"><a href="Generics.Kind.TH.html#GenericKQueue"><span class="hs-identifier hs-var">GenericKQueue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GenericKQueue"><span class="annot"><a href="Generics.Kind.TH.html#GenericKQueue"><span class="hs-identifier hs-var">GenericKQueue</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-774"></span><span>
</span><span id="line-775"></span><span class="annot"><a href="Generics.Kind.TH.html#pushGenericKQueue"><span class="hs-identifier hs-type">pushGenericKQueue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-776"></span><span id="pushGenericKQueue"><span class="annot"><span class="annottext">pushGenericKQueue :: [Dec] -&gt; Q ()
</span><a href="Generics.Kind.TH.html#pushGenericKQueue"><span class="hs-identifier hs-var hs-var">pushGenericKQueue</span></a></span></span><span> </span><span id="local-6989586621679055014"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679055014"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-777"></span><span>  </span><span class="annot"><a href="Generics.Kind.TH.html#GenericKQueue"><span class="hs-identifier hs-type">GenericKQueue</span></a></span><span> </span><span id="local-6989586621679055015"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679055015"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenericKQueue -&gt; Maybe GenericKQueue -&gt; GenericKQueue
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Dec] -&gt; GenericKQueue
</span><a href="Generics.Kind.TH.html#GenericKQueue"><span class="hs-identifier hs-var">GenericKQueue</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe GenericKQueue -&gt; GenericKQueue)
-&gt; Q (Maybe GenericKQueue) -&gt; Q GenericKQueue
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Q (Maybe GenericKQueue)
forall a. Typeable a =&gt; Q (Maybe a)
</span><span class="hs-identifier hs-var">TH.getQ</span></span><span>
</span><span id="line-778"></span><span>  </span><span class="annot"><span class="annottext">GenericKQueue -&gt; Q ()
forall a. Typeable a =&gt; a -&gt; Q ()
</span><span class="hs-identifier hs-var">TH.putQ</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Dec] -&gt; GenericKQueue
</span><a href="Generics.Kind.TH.html#GenericKQueue"><span class="hs-identifier hs-var">GenericKQueue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679055014"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; [Dec] -&gt; [Dec]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679055015"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-779"></span><span>
</span><span id="line-780"></span><span class="annot"><a href="Generics.Kind.TH.html#takeGenericKQueue"><span class="hs-identifier hs-type">takeGenericKQueue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-781"></span><span id="takeGenericKQueue"><span class="annot"><span class="annottext">takeGenericKQueue :: Q [Dec]
</span><a href="Generics.Kind.TH.html#takeGenericKQueue"><span class="hs-identifier hs-var hs-var">takeGenericKQueue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-782"></span><span>  </span><span class="annot"><a href="Generics.Kind.TH.html#GenericKQueue"><span class="hs-identifier hs-type">GenericKQueue</span></a></span><span> </span><span id="local-6989586621679055018"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679055018"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenericKQueue -&gt; Maybe GenericKQueue -&gt; GenericKQueue
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Dec] -&gt; GenericKQueue
</span><a href="Generics.Kind.TH.html#GenericKQueue"><span class="hs-identifier hs-var">GenericKQueue</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe GenericKQueue -&gt; GenericKQueue)
-&gt; Q (Maybe GenericKQueue) -&gt; Q GenericKQueue
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Q (Maybe GenericKQueue)
forall a. Typeable a =&gt; Q (Maybe a)
</span><span class="hs-identifier hs-var">TH.getQ</span></span><span>
</span><span id="line-783"></span><span>  </span><span class="annot"><span class="annottext">GenericKQueue -&gt; Q ()
forall a. Typeable a =&gt; a -&gt; Q ()
</span><span class="hs-identifier hs-var">TH.putQ</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Dec] -&gt; GenericKQueue
</span><a href="Generics.Kind.TH.html#GenericKQueue"><span class="hs-identifier hs-var">GenericKQueue</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-784"></span><span>  </span><span class="annot"><span class="annottext">[Dec] -&gt; Q [Dec]
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679055018"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-785"></span><span>
</span><span id="line-786"></span><span class="hs-comment">-- | Store 'fcfify'-generated instances for the current data type.</span><span>
</span><span id="line-787"></span><span class="hs-comment">-- This could also be done with StateT in deriveRepK but that's</span><span>
</span><span id="line-788"></span><span class="hs-comment">-- a more invasive change.</span><span>
</span><span id="line-789"></span><span class="hs-keyword">newtype</span><span> </span><span id="FcfifyQueue"><span class="annot"><a href="Generics.Kind.TH.html#FcfifyQueue"><span class="hs-identifier hs-var">FcfifyQueue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FcfifyQueue"><span class="annot"><a href="Generics.Kind.TH.html#FcfifyQueue"><span class="hs-identifier hs-var">FcfifyQueue</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-790"></span><span>
</span><span id="line-791"></span><span class="annot"><a href="Generics.Kind.TH.html#pushFcfifyQueue"><span class="hs-identifier hs-type">pushFcfifyQueue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-792"></span><span id="pushFcfifyQueue"><span class="annot"><span class="annottext">pushFcfifyQueue :: [Dec] -&gt; Q ()
</span><a href="Generics.Kind.TH.html#pushFcfifyQueue"><span class="hs-identifier hs-var hs-var">pushFcfifyQueue</span></a></span></span><span> </span><span id="local-6989586621679055020"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679055020"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-793"></span><span>  </span><span class="annot"><a href="Generics.Kind.TH.html#FcfifyQueue"><span class="hs-identifier hs-type">FcfifyQueue</span></a></span><span> </span><span id="local-6989586621679055021"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679055021"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FcfifyQueue -&gt; Maybe FcfifyQueue -&gt; FcfifyQueue
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Dec] -&gt; FcfifyQueue
</span><a href="Generics.Kind.TH.html#FcfifyQueue"><span class="hs-identifier hs-var">FcfifyQueue</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe FcfifyQueue -&gt; FcfifyQueue)
-&gt; Q (Maybe FcfifyQueue) -&gt; Q FcfifyQueue
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Q (Maybe FcfifyQueue)
forall a. Typeable a =&gt; Q (Maybe a)
</span><span class="hs-identifier hs-var">TH.getQ</span></span><span>
</span><span id="line-794"></span><span>  </span><span class="annot"><span class="annottext">FcfifyQueue -&gt; Q ()
forall a. Typeable a =&gt; a -&gt; Q ()
</span><span class="hs-identifier hs-var">TH.putQ</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Dec] -&gt; FcfifyQueue
</span><a href="Generics.Kind.TH.html#FcfifyQueue"><span class="hs-identifier hs-var">FcfifyQueue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679055020"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; [Dec] -&gt; [Dec]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679055021"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-795"></span><span>
</span><span id="line-796"></span><span class="annot"><a href="Generics.Kind.TH.html#takeFcfifyQueue"><span class="hs-identifier hs-type">takeFcfifyQueue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-797"></span><span id="takeFcfifyQueue"><span class="annot"><span class="annottext">takeFcfifyQueue :: Q [Dec]
</span><a href="Generics.Kind.TH.html#takeFcfifyQueue"><span class="hs-identifier hs-var hs-var">takeFcfifyQueue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-798"></span><span>  </span><span class="annot"><a href="Generics.Kind.TH.html#FcfifyQueue"><span class="hs-identifier hs-type">FcfifyQueue</span></a></span><span> </span><span id="local-6989586621679055022"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679055022"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FcfifyQueue -&gt; Maybe FcfifyQueue -&gt; FcfifyQueue
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Dec] -&gt; FcfifyQueue
</span><a href="Generics.Kind.TH.html#FcfifyQueue"><span class="hs-identifier hs-var">FcfifyQueue</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe FcfifyQueue -&gt; FcfifyQueue)
-&gt; Q (Maybe FcfifyQueue) -&gt; Q FcfifyQueue
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Q (Maybe FcfifyQueue)
forall a. Typeable a =&gt; Q (Maybe a)
</span><span class="hs-identifier hs-var">TH.getQ</span></span><span>
</span><span id="line-799"></span><span>  </span><span class="annot"><span class="annottext">FcfifyQueue -&gt; Q ()
forall a. Typeable a =&gt; a -&gt; Q ()
</span><span class="hs-identifier hs-var">TH.putQ</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Dec] -&gt; FcfifyQueue
</span><a href="Generics.Kind.TH.html#FcfifyQueue"><span class="hs-identifier hs-var">FcfifyQueue</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-800"></span><span>  </span><span class="annot"><span class="annottext">[Dec] -&gt; Q [Dec]
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679055022"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-801"></span></pre></body></html>