<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE
  CPP,
  ConstraintKinds,
  ImplicitParams,
  TemplateHaskell #-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="annot"><span class="hs-comment">-- | Template Haskell script to promote a type family to first class.</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Fcf.Family.TH</span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Generate boilerplate</span></span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Fcf.Family.TH.html#fcfify"><span class="hs-identifier">fcfify</span></a></span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#fcfifySkip"><span class="hs-identifier">fcfifySkip</span></a></span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#fcfify%27"><span class="hs-identifier">fcfify'</span></a></span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Using promoted families</span></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#promoteFamily"><span class="hs-identifier">promoteFamily</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#promoteNDFamily"><span class="hs-identifier">promoteNDFamily</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#familyName"><span class="hs-identifier">familyName</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#applyFamily"><span class="hs-identifier">applyFamily</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#consTuple"><span class="hs-identifier">consTuple</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#paramsProxy"><span class="hs-identifier">paramsProxy</span></a></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Predicates</span></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#isTypeFamily"><span class="hs-identifier">isTypeFamily</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#isTypeSynonym"><span class="hs-identifier">isTypeSynonym</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#isTypeFamilyOrSynonym"><span class="hs-identifier">isTypeFamilyOrSynonym</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">liftA2</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">on</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">($&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sort</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldl'</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Traversable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">for</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Syntax</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">getQ</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">putQ</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Fcf.Core</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Fcf.Family.html"><span class="hs-identifier">Fcf.Family</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Fcf.Family.html#Name"><span class="hs-identifier">Name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-comment">-- | Generate the boilerplate needed to promote a type family to first class.</span><span>
</span><span id="line-45"></span><span class="hs-comment">--</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- Required extensions:</span><span>
</span><span id="line-47"></span><span class="hs-comment">--</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- - @DataKinds@</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- - @PolyKinds@</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- - @TypeFamilies@</span><span>
</span><span id="line-51"></span><span class="hs-comment">--</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- If 'fcfify' is called more than once with the same 'Name' in the same module,</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- only the first invocation generates declarations; subsequent declarations</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- return the empty list, avoiding duplicate declarations in the current module.</span><span>
</span><span id="line-55"></span><span class="hs-comment">--</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- For a stateless variant, use 'fcfify''.</span><span>
</span><span id="line-57"></span><span class="hs-comment">--</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- See &quot;Fcf.Family&quot; for details on the encoding.</span><span>
</span><span id="line-59"></span><span class="annot"><a href="Fcf.Family.TH.html#fcfify"><span class="hs-identifier hs-type">fcfify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-60"></span><span id="fcfify"><span class="annot"><span class="annottext">fcfify :: Name -&gt; Q [Dec]
</span><a href="Fcf.Family.TH.html#fcfify"><span class="hs-identifier hs-var hs-var">fcfify</span></a></span></span><span> </span><span id="local-6989586621679067227"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067227"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-61"></span><span>  </span><span id="local-6989586621679067228"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679067228"><span class="hs-identifier hs-var">check</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Bool
</span><a href="Fcf.Family.TH.html#checkFcfified"><span class="hs-identifier hs-var">checkFcfified</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067227"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679067228"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; Q [Dec]
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q [Dec]
</span><a href="Fcf.Family.TH.html#fcfify%27"><span class="hs-identifier hs-var">fcfify'</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067227"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="annot"><span class="hs-comment">-- | Mark a type family as already fcifified.</span></span><span>
</span><span id="line-65"></span><span class="annot"><a href="Fcf.Family.TH.html#fcfifySkip"><span class="hs-identifier hs-type">fcfifySkip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-66"></span><span id="fcfifySkip"><span class="annot"><span class="annottext">fcfifySkip :: Name -&gt; Q [Dec]
</span><a href="Fcf.Family.TH.html#fcfifySkip"><span class="hs-identifier hs-var hs-var">fcfifySkip</span></a></span></span><span> </span><span id="local-6989586621679067230"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067230"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Bool
</span><a href="Fcf.Family.TH.html#checkFcfified"><span class="hs-identifier hs-var">checkFcfified</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067230"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Q Bool -&gt; [Dec] -&gt; Q [Dec]
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | Store invocations of 'fcfify' to avoid generating duplicate instances</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- in the current module (a minor performance optimization).</span><span>
</span><span id="line-70"></span><span class="hs-keyword">newtype</span><span> </span><span id="Fcfified"><span class="annot"><a href="Fcf.Family.TH.html#Fcfified"><span class="hs-identifier hs-var">Fcfified</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Fcfified"><span class="annot"><a href="Fcf.Family.TH.html#Fcfified"><span class="hs-identifier hs-var">Fcfified</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">-- | Check whether we've already seen this name.</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- Add the name to the registered set.</span><span>
</span><span id="line-74"></span><span class="annot"><a href="Fcf.Family.TH.html#checkFcfified"><span class="hs-identifier hs-type">checkFcfified</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-75"></span><span id="checkFcfified"><span class="annot"><span class="annottext">checkFcfified :: Name -&gt; Q Bool
</span><a href="Fcf.Family.TH.html#checkFcfified"><span class="hs-identifier hs-var hs-var">checkFcfified</span></a></span></span><span> </span><span id="local-6989586621679067232"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067232"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-76"></span><span>  </span><span class="annot"><a href="Fcf.Family.TH.html#Fcfified"><span class="hs-identifier hs-type">Fcfified</span></a></span><span> </span><span id="local-6989586621679067233"><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679067233"><span class="hs-identifier hs-var">seen</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Fcfified -&gt; Maybe Fcfified -&gt; Fcfified
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Name -&gt; Fcfified
</span><a href="Fcf.Family.TH.html#Fcfified"><span class="hs-identifier hs-var">Fcfified</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Fcfified -&gt; Fcfified) -&gt; Q (Maybe Fcfified) -&gt; Q Fcfified
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Q (Maybe Fcfified)
forall a. Typeable a =&gt; Q (Maybe a)
</span><span class="hs-identifier hs-var">getQ</span></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679067237"><span class="annot"><span class="annottext">check :: Bool
</span><a href="#local-6989586621679067237"><span class="hs-identifier hs-var hs-var">check</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067232"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Set Name -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.member`</span></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679067233"><span class="hs-identifier hs-var">seen</span></a></span><span>
</span><span id="line-78"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Q () -&gt; Q ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679067237"><span class="hs-identifier hs-var">check</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fcfified -&gt; Q ()
forall a. Typeable a =&gt; a -&gt; Q ()
</span><span class="hs-identifier hs-var">putQ</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Name -&gt; Fcfified
</span><a href="Fcf.Family.TH.html#Fcfified"><span class="hs-identifier hs-var">Fcfified</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Set Name -&gt; Set Name
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067232"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679067233"><span class="hs-identifier hs-var">seen</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Q Bool
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679067237"><span class="hs-identifier hs-var">check</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-comment">-- | Generate the boilerplate needed to promote a type family to first class.</span><span>
</span><span id="line-83"></span><span class="hs-comment">--</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- Unlike 'fcfify', this always returns the same declarations for the same</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- named type.</span><span>
</span><span id="line-86"></span><span class="annot"><a href="Fcf.Family.TH.html#fcfify%27"><span class="hs-identifier hs-type">fcfify'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-87"></span><span id="fcfify%27"><span class="annot"><span class="annottext">fcfify' :: Name -&gt; Q [Dec]
</span><a href="Fcf.Family.TH.html#fcfify%27"><span class="hs-identifier hs-var hs-var">fcfify'</span></a></span></span><span> </span><span id="local-6989586621679067241"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067241"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(?funName::String) =&gt; Name -&gt; Q TyInfo
Name -&gt; Q TyInfo
</span><a href="Fcf.Family.TH.html#reifyTyInfo"><span class="hs-identifier hs-var">reifyTyInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067241"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Q TyInfo -&gt; (TyInfo -&gt; Q [Dec]) -&gt; Q [Dec]
forall a b. Q a -&gt; (a -&gt; Q b) -&gt; Q b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ErrCtxt =&gt; TyInfo -&gt; Q [Dec]
TyInfo -&gt; Q [Dec]
</span><a href="Fcf.Family.TH.html#fcfifyInfo"><span class="hs-identifier hs-var">fcfifyInfo</span></a></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-89"></span><span>    </span><span class="">?funName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">?funName::String
String
</span><span class="hs-string">&quot;fcfify&quot;</span></span><span>
</span><span id="line-90"></span><span>    </span><span class="">?name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">?name::Name
Name
</span><a href="#local-6989586621679067241"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="annot"><span class="hs-comment">-- | Get the quoted fcf 'Fcf.Core.Family.Name' of an existing type family.</span></span><span>
</span><span id="line-93"></span><span class="annot"><a href="Fcf.Family.TH.html#familyName"><span class="hs-identifier hs-type">familyName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-94"></span><span id="familyName"><span class="annot"><span class="annottext">familyName :: Name -&gt; Type
</span><a href="Fcf.Family.TH.html#familyName"><span class="hs-identifier hs-var hs-var">familyName</span></a></span></span><span> </span><span id="local-6989586621679067249"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067249"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">PromotedT</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">MkName</span><span>
</span><span id="line-95"></span><span>  </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Type
</span><a href="#local-6989586621679067252"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; String
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Maybe String
</span><span class="hs-identifier hs-var">namePackage</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067249"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>  </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Type
</span><a href="#local-6989586621679067252"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; String
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Maybe String
</span><span class="hs-identifier hs-var">nameModule</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067249"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Type
</span><a href="#local-6989586621679067252"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067249"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679067252"><span class="annot"><span class="annottext">lit :: String -&gt; Type
</span><a href="#local-6989586621679067252"><span class="hs-identifier hs-var hs-var">lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; Type
</span><span class="hs-identifier hs-var">LitT</span></span><span> </span><span class="annot"><span class="annottext">(TyLit -&gt; Type) -&gt; (String -&gt; TyLit) -&gt; String -&gt; Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; TyLit
</span><span class="hs-identifier hs-var">StrTyLit</span></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">-- | Promote a fcfified family, returning its partially applied 'Family' and</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- its arity. The result can be applied to a 'consTuple' of the appropriate size,</span><span>
</span><span id="line-102"></span><span class="annot"><a href="Fcf.Family.TH.html#promoteFamily"><span class="hs-identifier hs-type">promoteFamily</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span id="promoteFamily"><span class="annot"><span class="annottext">promoteFamily :: Name -&gt; Q (Type, Int)
</span><a href="Fcf.Family.TH.html#promoteFamily"><span class="hs-identifier hs-var hs-var">promoteFamily</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Q (Type, Int)
</span><a href="Fcf.Family.TH.html#promoteFamily_"><span class="hs-identifier hs-var">promoteFamily_</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Family</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">-- | Promote a fcfified family, returning its partially applied 'Family' and</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- its arity. The result can be applied to a 'consTuple' of the appropriate size,</span><span>
</span><span id="line-107"></span><span class="annot"><a href="Fcf.Family.TH.html#promoteNDFamily"><span class="hs-identifier hs-type">promoteNDFamily</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span id="promoteNDFamily"><span class="annot"><span class="annottext">promoteNDFamily :: Name -&gt; Q (Type, Int)
</span><a href="Fcf.Family.TH.html#promoteNDFamily"><span class="hs-identifier hs-var hs-var">promoteNDFamily</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Q (Type, Int)
</span><a href="Fcf.Family.TH.html#promoteFamily_"><span class="hs-identifier hs-var">promoteFamily_</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">NDFamily</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="annot"><a href="Fcf.Family.TH.html#promoteFamily_"><span class="hs-identifier hs-type">promoteFamily_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span id="promoteFamily_"><span class="annot"><span class="annottext">promoteFamily_ :: Name -&gt; Name -&gt; Q (Type, Int)
</span><a href="Fcf.Family.TH.html#promoteFamily_"><span class="hs-identifier hs-var hs-var">promoteFamily_</span></a></span></span><span> </span><span id="local-6989586621679067261"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067261"><span class="hs-identifier hs-var">_Family</span></a></span></span><span> </span><span id="local-6989586621679067262"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067262"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-112"></span><span>  </span><span id="local-6989586621679067263"><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067263"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(?funName::String) =&gt; Name -&gt; Q TyInfo
Name -&gt; Q TyInfo
</span><a href="Fcf.Family.TH.html#reifyTyInfo"><span class="hs-identifier hs-var">reifyTyInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067262"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679067266"><span class="annot"><span class="annottext">arity :: Int
</span><a href="#local-6989586621679067266"><span class="hs-identifier hs-var hs-var">arity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, Type)] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyInfo -&gt; [(Name, Type)]
</span><a href="Fcf.Family.TH.html#tiArgs"><span class="hs-identifier hs-var">tiArgs</span></a></span><span> </span><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067263"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><span class="annottext">(Type, Int) -&gt; Q (Type, Int)
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067261"><span class="hs-identifier hs-var">_Family</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">TyInfo -&gt; Type
</span><a href="Fcf.Family.TH.html#tiNameT"><span class="hs-identifier hs-var">tiNameT</span></a></span><span> </span><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067263"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">TyInfo -&gt; Type
</span><a href="Fcf.Family.TH.html#paramsProxy%27"><span class="hs-identifier hs-var">paramsProxy'</span></a></span><span> </span><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067263"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067266"><span class="hs-identifier hs-var">arity</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-116"></span><span>    </span><span class="">?funName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">?funName::String
String
</span><span class="hs-string">&quot;promoteFamily_&quot;</span></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-comment">-- | Apply a promoted family.</span><span>
</span><span id="line-119"></span><span class="hs-comment">--</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- If there are more arguments than the arity of the family (as returned by 'promoteFamily'),</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- they are split and applied properly:</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- the family's main arguments are collected in a 'consTuple' and</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- the rest are applied with 'AppT'.</span><span>
</span><span id="line-124"></span><span class="hs-comment">--</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- If there are fewer arguments than the arity, the result is nonsense.</span><span>
</span><span id="line-126"></span><span class="annot"><a href="Fcf.Family.TH.html#applyFamily"><span class="hs-identifier hs-type">applyFamily</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-127"></span><span id="applyFamily"><span class="annot"><span class="annottext">applyFamily :: Name -&gt; [Q Type] -&gt; Q Type
</span><a href="Fcf.Family.TH.html#applyFamily"><span class="hs-identifier hs-var hs-var">applyFamily</span></a></span></span><span> </span><span id="local-6989586621679067275"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067275"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679067276"><span class="annot"><span class="annottext">[Q Type]
</span><a href="#local-6989586621679067276"><span class="hs-identifier hs-var">argsQ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679067277"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067277"><span class="hs-identifier hs-var">fam</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067278"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067278"><span class="hs-identifier hs-var">arity</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q (Type, Int)
</span><a href="Fcf.Family.TH.html#promoteFamily"><span class="hs-identifier hs-var">promoteFamily</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067275"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679067279"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679067279"><span class="hs-identifier hs-var">args1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067280"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679067280"><span class="hs-identifier hs-var">args2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Type] -&gt; ([Type], [Type])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067278"><span class="hs-identifier hs-var">arity</span></a></span><span> </span><span class="annot"><span class="annottext">([Type] -&gt; ([Type], [Type])) -&gt; Q [Type] -&gt; Q ([Type], [Type])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Q Type] -&gt; Q [Type]
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(Traversable t, Applicative f) =&gt;
t (f a) -&gt; f (t a)
forall (f :: * -&gt; *) a. Applicative f =&gt; [f a] -&gt; f [a]
</span><span class="hs-identifier hs-var">sequenceA</span></span><span> </span><span class="annot"><span class="annottext">[Q Type]
</span><a href="#local-6989586621679067276"><span class="hs-identifier hs-var">argsQ</span></a></span><span>
</span><span id="line-130"></span><span>  </span><span class="annot"><span class="annottext">Type -&gt; Q Type
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067277"><span class="hs-identifier hs-var">fam</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Type
</span><a href="Fcf.Family.TH.html#consTuple"><span class="hs-identifier hs-var">consTuple</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679067279"><span class="hs-identifier hs-var">args1</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; Type
</span><a href="Fcf.Family.TH.html#appsT"><span class="hs-operator hs-var">`appsT`</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679067280"><span class="hs-identifier hs-var">args2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="annot"><a href="Fcf.Family.TH.html#paramsProxy"><span class="hs-identifier hs-type">paramsProxy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-133"></span><span id="paramsProxy"><span class="annot"><span class="annottext">paramsProxy :: Name -&gt; Q Type
</span><a href="Fcf.Family.TH.html#paramsProxy"><span class="hs-identifier hs-var hs-var">paramsProxy</span></a></span></span><span> </span><span id="local-6989586621679067284"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067284"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyInfo -&gt; Type
</span><a href="Fcf.Family.TH.html#paramsProxy%27"><span class="hs-identifier hs-var">paramsProxy'</span></a></span><span> </span><span class="annot"><span class="annottext">(TyInfo -&gt; Type) -&gt; Q TyInfo -&gt; Q Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(?funName::String) =&gt; Name -&gt; Q TyInfo
Name -&gt; Q TyInfo
</span><a href="Fcf.Family.TH.html#reifyTyInfo"><span class="hs-identifier hs-var">reifyTyInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067284"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-135"></span><span>    </span><span class="">?funName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">?funName::String
String
</span><span class="hs-string">&quot;paramsProxy&quot;</span></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="annot"><a href="Fcf.Family.TH.html#paramsProxy%27"><span class="hs-identifier hs-type">paramsProxy'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#TyInfo"><span class="hs-identifier hs-type">TyInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-138"></span><span id="paramsProxy%27"><span class="annot"><span class="annottext">paramsProxy' :: TyInfo -&gt; Type
</span><a href="Fcf.Family.TH.html#paramsProxy%27"><span class="hs-identifier hs-var hs-var">paramsProxy'</span></a></span></span><span> </span><span id="local-6989586621679067288"><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067288"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type
forall {t}. (Eq t, Num t) =&gt; t -&gt; Type
</span><a href="#local-6989586621679067289"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyInfo -&gt; [Name]
</span><a href="Fcf.Family.TH.html#tiParams"><span class="hs-identifier hs-var">tiParams</span></a></span><span> </span><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067288"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-140"></span><span>    </span><span id="local-6989586621679067289"><span class="annot"><span class="annottext">go :: t -&gt; Type
</span><a href="#local-6989586621679067289"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">P0</span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><a href="#local-6989586621679067289"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679067297"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679067297"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">PS</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; Type
</span><a href="#local-6989586621679067289"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679067297"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="annot"><a href="Fcf.Family.TH.html#reifyTyInfo"><span class="hs-identifier hs-type">reifyTyInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="">?funName</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#TyInfo"><span class="hs-identifier hs-type">TyInfo</span></a></span><span>
</span><span id="line-144"></span><span id="reifyTyInfo"><span class="annot"><span class="annottext">reifyTyInfo :: (?funName::String) =&gt; Name -&gt; Q TyInfo
</span><a href="Fcf.Family.TH.html#reifyTyInfo"><span class="hs-identifier hs-var hs-var">reifyTyInfo</span></a></span></span><span> </span><span id="local-6989586621679067299"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067299"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="">?name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">?name::Name
Name
</span><a href="#local-6989586621679067299"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-146"></span><span>  </span><span id="local-6989586621679067305"><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679067305"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Info
</span><span class="hs-identifier hs-var">reify</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067299"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679067305"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-148"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">FamilyI</span></span><span> </span><span id="local-6989586621679067308"><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679067308"><span class="hs-identifier hs-var">dec</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; Q TyInfo
ErrCtxt =&gt; Dec -&gt; Q TyInfo
</span><a href="Fcf.Family.TH.html#reifyTyInfoDec"><span class="hs-identifier hs-var">reifyTyInfoDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679067308"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-149"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">TyConI</span></span><span> </span><span id="local-6989586621679067311"><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679067311"><span class="hs-identifier hs-var">dec</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; Q TyInfo
ErrCtxt =&gt; Dec -&gt; Q TyInfo
</span><a href="Fcf.Family.TH.html#reifyTyInfoDec"><span class="hs-identifier hs-var">reifyTyInfoDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679067311"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span class="annot"><span class="annottext">Info
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Q TyInfo
forall a. ErrCtxt =&gt; Q a
</span><a href="Fcf.Family.TH.html#errorNotType"><span class="hs-identifier hs-var">errorNotType</span></a></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="annot"><span class="hs-comment">-- | 'True' if it is a type family (open or closed).</span></span><span>
</span><span id="line-153"></span><span class="annot"><a href="Fcf.Family.TH.html#isTypeFamily"><span class="hs-identifier hs-type">isTypeFamily</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-154"></span><span id="isTypeFamily"><span class="annot"><span class="annottext">isTypeFamily :: Name -&gt; Q Bool
</span><a href="Fcf.Family.TH.html#isTypeFamily"><span class="hs-identifier hs-var hs-var">isTypeFamily</span></a></span></span><span> </span><span id="local-6989586621679067313"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067313"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Info -&gt; Bool
</span><a href="Fcf.Family.TH.html#isTypeFamilyInfo"><span class="hs-identifier hs-var">isTypeFamilyInfo</span></a></span><span> </span><span class="annot"><span class="annottext">(Info -&gt; Bool) -&gt; Q Info -&gt; Q Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Info
</span><span class="hs-identifier hs-var">reify</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067313"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="annot"><span class="hs-comment">-- | 'True' if it is a type synonym.</span></span><span>
</span><span id="line-157"></span><span class="annot"><a href="Fcf.Family.TH.html#isTypeSynonym"><span class="hs-identifier hs-type">isTypeSynonym</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-158"></span><span id="isTypeSynonym"><span class="annot"><span class="annottext">isTypeSynonym :: Name -&gt; Q Bool
</span><a href="Fcf.Family.TH.html#isTypeSynonym"><span class="hs-identifier hs-var hs-var">isTypeSynonym</span></a></span></span><span> </span><span id="local-6989586621679067315"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067315"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Info -&gt; Bool
</span><a href="Fcf.Family.TH.html#isTypeSynonymInfo"><span class="hs-identifier hs-var">isTypeSynonymInfo</span></a></span><span> </span><span class="annot"><span class="annottext">(Info -&gt; Bool) -&gt; Q Info -&gt; Q Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Info
</span><span class="hs-identifier hs-var">reify</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067315"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="annot"><span class="hs-comment">-- | 'True' if it is a type family or synonym.</span></span><span>
</span><span id="line-161"></span><span class="annot"><a href="Fcf.Family.TH.html#isTypeFamilyOrSynonym"><span class="hs-identifier hs-type">isTypeFamilyOrSynonym</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-162"></span><span id="isTypeFamilyOrSynonym"><span class="annot"><span class="annottext">isTypeFamilyOrSynonym :: Name -&gt; Q Bool
</span><a href="Fcf.Family.TH.html#isTypeFamilyOrSynonym"><span class="hs-identifier hs-var hs-var">isTypeFamilyOrSynonym</span></a></span></span><span> </span><span id="local-6989586621679067317"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067317"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool -&gt; Bool)
-&gt; (Info -&gt; Bool) -&gt; (Info -&gt; Bool) -&gt; Info -&gt; Bool
forall a b c.
(a -&gt; b -&gt; c) -&gt; (Info -&gt; a) -&gt; (Info -&gt; b) -&gt; Info -&gt; c
forall (f :: * -&gt; *) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><span class="hs-identifier hs-var">liftA2</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">(||)</span></span><span> </span><span class="annot"><span class="annottext">Info -&gt; Bool
</span><a href="Fcf.Family.TH.html#isTypeFamilyInfo"><span class="hs-identifier hs-var">isTypeFamilyInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Info -&gt; Bool
</span><a href="Fcf.Family.TH.html#isTypeSynonymInfo"><span class="hs-identifier hs-var">isTypeSynonymInfo</span></a></span><span> </span><span class="annot"><span class="annottext">(Info -&gt; Bool) -&gt; Q Info -&gt; Q Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Info
</span><span class="hs-identifier hs-var">reify</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067317"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="annot"><a href="Fcf.Family.TH.html#isTypeFamilyInfo"><span class="hs-identifier hs-type">isTypeFamilyInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Info</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-165"></span><span id="isTypeFamilyInfo"><span class="annot"><span class="annottext">isTypeFamilyInfo :: Info -&gt; Bool
</span><a href="Fcf.Family.TH.html#isTypeFamilyInfo"><span class="hs-identifier hs-var hs-var">isTypeFamilyInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FamilyI</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OpenTypeFamilyD</span></span><span> </span><span class="annot"><span class="annottext">TypeFamilyHead
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-166"></span><span class="annot"><a href="Fcf.Family.TH.html#isTypeFamilyInfo"><span class="hs-identifier hs-var">isTypeFamilyInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FamilyI</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ClosedTypeFamilyD</span></span><span> </span><span class="annot"><span class="annottext">TypeFamilyHead
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[TySynEqn]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-167"></span><span class="annot"><a href="Fcf.Family.TH.html#isTypeFamilyInfo"><span class="hs-identifier hs-var">isTypeFamilyInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Info
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="annot"><a href="Fcf.Family.TH.html#isTypeSynonymInfo"><span class="hs-identifier hs-type">isTypeSynonymInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Info</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-170"></span><span id="isTypeSynonymInfo"><span class="annot"><span class="annottext">isTypeSynonymInfo :: Info -&gt; Bool
</span><a href="Fcf.Family.TH.html#isTypeSynonymInfo"><span class="hs-identifier hs-var hs-var">isTypeSynonymInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TyConI</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TySynD</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr BndrVis]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-171"></span><span class="annot"><a href="Fcf.Family.TH.html#isTypeSynonymInfo"><span class="hs-identifier hs-var">isTypeSynonymInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Info
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">--</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-keyword">type</span><span> </span><span id="ErrCtxt"><span class="annot"><a href="Fcf.Family.TH.html#ErrCtxt"><span class="hs-identifier hs-var">ErrCtxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="">?funName</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">?name</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span id="local-6989586621679067117"><span class="annot"><a href="Fcf.Family.TH.html#errorNotType"><span class="hs-identifier hs-type">errorNotType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#ErrCtxt"><span class="hs-identifier hs-type">ErrCtxt</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><a href="#local-6989586621679067117"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-178"></span><span id="errorNotType"><span class="annot"><span class="annottext">errorNotType :: forall a. ErrCtxt =&gt; Q a
</span><a href="Fcf.Family.TH.html#errorNotType"><span class="hs-identifier hs-var hs-var">errorNotType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q a
forall a. String -&gt; Q a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">?funName::String
String
</span><a href="#local-6989586621679067325"><span class="hs-var">?funName</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: unexpected name, &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">?name::Name
Name
</span><a href="#local-6989586621679067329"><span class="hs-var">?name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; is not a type family or type synonym.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-181"></span><span class="hs-comment">--</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- -- Input</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- type F a b c = (...)</span><span>
</span><span id="line-185"></span><span class="hs-comment">--</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- -- Output</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- type instance Params F </span><span>
</span><span id="line-188"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="annot"><a href="Fcf.Family.TH.html#reifyTyInfoDec"><span class="hs-identifier hs-type">reifyTyInfoDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#ErrCtxt"><span class="hs-identifier hs-type">ErrCtxt</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#TyInfo"><span class="hs-identifier hs-type">TyInfo</span></a></span><span>
</span><span id="line-191"></span><span id="reifyTyInfoDec"><span class="annot"><span class="annottext">reifyTyInfoDec :: ErrCtxt =&gt; Dec -&gt; Q TyInfo
</span><a href="Fcf.Family.TH.html#reifyTyInfoDec"><span class="hs-identifier hs-var hs-var">reifyTyInfoDec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TySynD</span></span><span> </span><span id="local-6989586621679067338"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067338"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679067339"><span class="annot"><span class="annottext">[TyVarBndr BndrVis]
</span><a href="#local-6989586621679067339"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [TyVarBndr BndrVis] -&gt; Type -&gt; Q TyInfo
forall a. Name -&gt; [TyVarBndr a] -&gt; Type -&gt; Q TyInfo
</span><a href="Fcf.Family.TH.html#mkInfoHead"><span class="hs-identifier hs-var">mkInfoHead</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067338"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr BndrVis]
</span><a href="#local-6989586621679067339"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">StarT</span></span><span> </span><span class="hs-comment">-- TODO: don't assume result kind is Type</span><span>
</span><span id="line-192"></span><span class="annot"><a href="Fcf.Family.TH.html#reifyTyInfoDec"><span class="hs-identifier hs-var">reifyTyInfoDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OpenTypeFamilyD</span></span><span> </span><span id="local-6989586621679067342"><span class="annot"><span class="annottext">TypeFamilyHead
</span><a href="#local-6989586621679067342"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrCtxt =&gt; TypeFamilyHead -&gt; Q TyInfo
TypeFamilyHead -&gt; Q TyInfo
</span><a href="Fcf.Family.TH.html#reifyTyInfoTFH"><span class="hs-identifier hs-var">reifyTyInfoTFH</span></a></span><span> </span><span class="annot"><span class="annottext">TypeFamilyHead
</span><a href="#local-6989586621679067342"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-193"></span><span class="annot"><a href="Fcf.Family.TH.html#reifyTyInfoDec"><span class="hs-identifier hs-var">reifyTyInfoDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ClosedTypeFamilyD</span></span><span> </span><span id="local-6989586621679067344"><span class="annot"><span class="annottext">TypeFamilyHead
</span><a href="#local-6989586621679067344"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">[TySynEqn]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrCtxt =&gt; TypeFamilyHead -&gt; Q TyInfo
TypeFamilyHead -&gt; Q TyInfo
</span><a href="Fcf.Family.TH.html#reifyTyInfoTFH"><span class="hs-identifier hs-var">reifyTyInfoTFH</span></a></span><span> </span><span class="annot"><span class="annottext">TypeFamilyHead
</span><a href="#local-6989586621679067344"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-194"></span><span class="annot"><a href="Fcf.Family.TH.html#reifyTyInfoDec"><span class="hs-identifier hs-var">reifyTyInfoDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q TyInfo
forall a. ErrCtxt =&gt; Q a
</span><a href="Fcf.Family.TH.html#errorNotType"><span class="hs-identifier hs-var">errorNotType</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="annot"><a href="Fcf.Family.TH.html#reifyTyInfoTFH"><span class="hs-identifier hs-type">reifyTyInfoTFH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#ErrCtxt"><span class="hs-identifier hs-type">ErrCtxt</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TypeFamilyHead</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#TyInfo"><span class="hs-identifier hs-type">TyInfo</span></a></span><span>
</span><span id="line-197"></span><span id="reifyTyInfoTFH"><span class="annot"><span class="annottext">reifyTyInfoTFH :: ErrCtxt =&gt; TypeFamilyHead -&gt; Q TyInfo
</span><a href="Fcf.Family.TH.html#reifyTyInfoTFH"><span class="hs-identifier hs-var hs-var">reifyTyInfoTFH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TypeFamilyHead</span></span><span> </span><span id="local-6989586621679067351"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067351"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679067352"><span class="annot"><span class="annottext">[TyVarBndr BndrVis]
</span><a href="#local-6989586621679067352"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679067353"><span class="annot"><span class="annottext">FamilyResultSig
</span><a href="#local-6989586621679067353"><span class="hs-identifier hs-var">resSig</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe InjectivityAnn
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-198"></span><span>  </span><span id="local-6989586621679067354"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067354"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ErrCtxt =&gt; FamilyResultSig -&gt; Q Type
FamilyResultSig -&gt; Q Type
</span><a href="Fcf.Family.TH.html#getRes"><span class="hs-identifier hs-var">getRes</span></a></span><span> </span><span class="annot"><span class="annottext">FamilyResultSig
</span><a href="#local-6989586621679067353"><span class="hs-identifier hs-var">resSig</span></a></span><span>
</span><span id="line-199"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; [TyVarBndr BndrVis] -&gt; Type -&gt; Q TyInfo
forall a. Name -&gt; [TyVarBndr a] -&gt; Type -&gt; Q TyInfo
</span><a href="Fcf.Family.TH.html#mkInfoHead"><span class="hs-identifier hs-var">mkInfoHead</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067351"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr BndrVis]
</span><a href="#local-6989586621679067352"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067354"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="annot"><a href="Fcf.Family.TH.html#getRes"><span class="hs-identifier hs-type">getRes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#ErrCtxt"><span class="hs-identifier hs-type">ErrCtxt</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FamilyResultSig</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-202"></span><span id="getRes"><span class="annot"><span class="annottext">getRes :: ErrCtxt =&gt; FamilyResultSig -&gt; Q Type
</span><a href="Fcf.Family.TH.html#getRes"><span class="hs-identifier hs-var hs-var">getRes</span></a></span></span><span> </span><span class="annot"><span class="annottext">FamilyResultSig
</span><span class="hs-identifier hs-var">NoSig</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Type
forall a. String -&gt; Q a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">?funName::String
String
</span><a href="#local-6989586621679067358"><span class="hs-var">?funName</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: implicit result type not supported&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span class="annot"><a href="Fcf.Family.TH.html#getRes"><span class="hs-identifier hs-var">getRes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KindSig</span></span><span> </span><span id="local-6989586621679067366"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067366"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Q Type
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067366"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-204"></span><span class="annot"><a href="Fcf.Family.TH.html#getRes"><span class="hs-identifier hs-var">getRes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TyVarSig</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KindedTV</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679067369"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067369"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Q Type
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067369"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-205"></span><span class="annot"><a href="Fcf.Family.TH.html#getRes"><span class="hs-identifier hs-var">getRes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TyVarSig</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlainTV</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Type
forall a. String -&gt; Q a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">?funName::String
String
</span><a href="#local-6989586621679067363"><span class="hs-var">?funName</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: implicit result type not supported&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">--</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span id="local-6989586621679067129"><span class="annot"><a href="Fcf.Family.TH.html#mkInfoHead"><span class="hs-identifier hs-type">mkInfoHead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr</span></span><span> </span><span class="annot"><a href="#local-6989586621679067129"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#TyInfo"><span class="hs-identifier hs-type">TyInfo</span></a></span></span><span>
</span><span id="line-210"></span><span id="mkInfoHead"><span class="annot"><span class="annottext">mkInfoHead :: forall a. Name -&gt; [TyVarBndr a] -&gt; Type -&gt; Q TyInfo
</span><a href="Fcf.Family.TH.html#mkInfoHead"><span class="hs-identifier hs-var hs-var">mkInfoHead</span></a></span></span><span> </span><span id="local-6989586621679067377"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067377"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679067378"><span class="annot"><span class="annottext">[TyVarBndr a]
</span><a href="#local-6989586621679067378"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679067379"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067379"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-211"></span><span>  </span><span id="local-6989586621679067380"><span class="annot"><span class="annottext">[(Name, Type)]
</span><a href="#local-6989586621679067380"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr a]
-&gt; (TyVarBndr a -&gt; Q (Name, Type)) -&gt; Q [(Name, Type)]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span><span class="hs-identifier hs-var">for</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr a]
</span><a href="#local-6989586621679067378"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679067381"><span class="annot"><span class="annottext">TyVarBndr a
</span><a href="#local-6989586621679067381"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TyVarBndr a
</span><a href="#local-6989586621679067381"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">PlainTV</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q (Name, Type)
forall a. String -&gt; Q a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unexpected unnanotated arguments&quot;</span></span><span>  </span><span class="hs-comment">-- as far as I understand, the binders given by reify are always annotated so this shouldn't happen</span><span>
</span><span id="line-213"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">KindedTV</span></span><span> </span><span id="local-6989586621679067382"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067382"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679067383"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067383"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Name, Type) -&gt; Q (Name, Type)
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067382"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067383"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679067384"><span class="annot"><span class="annottext">params :: [Name]
</span><a href="#local-6989586621679067384"><span class="hs-identifier hs-var hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, Type)] -&gt; Type -&gt; [Name]
</span><a href="Fcf.Family.TH.html#collectParams"><span class="hs-identifier hs-var">collectParams</span></a></span><span> </span><span class="annot"><span class="annottext">[(Name, Type)]
</span><a href="#local-6989586621679067380"><span class="hs-identifier hs-var">args'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067379"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-215"></span><span>  </span><span class="annot"><span class="annottext">TyInfo -&gt; Q TyInfo
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; [(Name, Type)] -&gt; Type -&gt; TyInfo
</span><a href="Fcf.Family.TH.html#mkTyInfo"><span class="hs-identifier hs-var">mkTyInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067377"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679067384"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">[(Name, Type)]
</span><a href="#local-6989586621679067380"><span class="hs-identifier hs-var">args'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067379"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="annot"><a href="Fcf.Family.TH.html#collectParams"><span class="hs-identifier hs-type">collectParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>
</span><span id="line-218"></span><span id="collectParams"><span class="annot"><span class="annottext">collectParams :: [(Name, Type)] -&gt; Type -&gt; [Name]
</span><a href="Fcf.Family.TH.html#collectParams"><span class="hs-identifier hs-var hs-var">collectParams</span></a></span></span><span> </span><span id="local-6989586621679067387"><span class="annot"><span class="annottext">[(Name, Type)]
</span><a href="#local-6989586621679067387"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679067388"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067388"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; [(Name, Type)] -&gt; [Name]
</span><a href="#local-6989586621679067389"><span class="hs-identifier hs-var">collect</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">[(Name, Type)]
</span><a href="#local-6989586621679067387"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span>  </span><span id="local-6989586621679067389"><span class="annot"><span class="annottext">collect :: Set Name -&gt; [(Name, Type)] -&gt; [Name]
</span><a href="#local-6989586621679067389"><span class="hs-identifier hs-var hs-var">collect</span></a></span></span><span> </span><span id="local-6989586621679067392"><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679067392"><span class="hs-identifier hs-var">bound</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Set Name, [Name]) -&gt; [Name]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Name -&gt; [Name] -&gt; [Name] -&gt; (Set Name, [Name])
forall {a}. Ord a =&gt; Set a -&gt; [a] -&gt; [a] -&gt; (Set a, [a])
</span><a href="#local-6989586621679067394"><span class="hs-identifier hs-var">addVars</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679067392"><span class="hs-identifier hs-var">bound</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; [Name]
</span><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067388"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- collect parameters from the result type</span><span>
</span><span id="line-221"></span><span>  </span><span class="annot"><a href="#local-6989586621679067389"><span class="hs-identifier hs-var">collect</span></a></span><span> </span><span id="local-6989586621679067396"><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679067396"><span class="hs-identifier hs-var">bound</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679067397"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067397"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067398"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067398"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679067399"><span class="annot"><span class="annottext">[(Name, Type)]
</span><a href="#local-6989586621679067399"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-222"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067401"><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679067401"><span class="hs-identifier hs-var">bound'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067402"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679067402"><span class="hs-identifier hs-var">ws</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; [Name] -&gt; [Name] -&gt; (Set Name, [Name])
forall {a}. Ord a =&gt; Set a -&gt; [a] -&gt; [a] -&gt; (Set a, [a])
</span><a href="#local-6989586621679067394"><span class="hs-identifier hs-var">addVars</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679067396"><span class="hs-identifier hs-var">bound</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; [Name]
</span><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067398"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679067402"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; [(Name, Type)] -&gt; [Name]
</span><a href="#local-6989586621679067389"><span class="hs-identifier hs-var">collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Set Name -&gt; Set Name
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067397"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679067401"><span class="hs-identifier hs-var">bound'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Name, Type)]
</span><a href="#local-6989586621679067399"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span>  </span><span id="local-6989586621679067394"><span class="annot"><span class="annottext">addVars :: Set a -&gt; [a] -&gt; [a] -&gt; (Set a, [a])
</span><a href="#local-6989586621679067394"><span class="hs-identifier hs-var hs-var">addVars</span></a></span></span><span> </span><span id="local-6989586621679067409"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679067409"><span class="hs-identifier hs-var">bound</span></a></span></span><span> </span><span id="local-6989586621679067410"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067410"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679067409"><span class="hs-identifier hs-var">bound</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067410"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>  </span><span class="annot"><a href="#local-6989586621679067394"><span class="hs-identifier hs-var">addVars</span></a></span><span> </span><span id="local-6989586621679067412"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679067412"><span class="hs-identifier hs-var">bound</span></a></span></span><span> </span><span id="local-6989586621679067413"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067413"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067414"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067414"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679067415"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067415"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067414"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679067412"><span class="hs-identifier hs-var">bound</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; [a] -&gt; [a] -&gt; (Set a, [a])
</span><a href="#local-6989586621679067394"><span class="hs-identifier hs-var">addVars</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679067412"><span class="hs-identifier hs-var">bound</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067413"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067415"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; [a] -&gt; [a] -&gt; (Set a, [a])
</span><a href="#local-6989586621679067394"><span class="hs-identifier hs-var">addVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067414"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679067412"><span class="hs-identifier hs-var">bound</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067414"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067413"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067415"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-keyword">data</span><span> </span><span id="TyInfo"><span class="annot"><a href="Fcf.Family.TH.html#TyInfo"><span class="hs-identifier hs-var">TyInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TyInfo"><span class="annot"><a href="Fcf.Family.TH.html#TyInfo"><span class="hs-identifier hs-var">TyInfo</span></a></span></span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="tiName"><span class="annot"><span class="annottext">TyInfo -&gt; Name
</span><a href="Fcf.Family.TH.html#tiName"><span class="hs-identifier hs-var hs-var">tiName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tiNameT"><span class="annot"><span class="annottext">TyInfo -&gt; Type
</span><a href="Fcf.Family.TH.html#tiNameT"><span class="hs-identifier hs-var hs-var">tiNameT</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ Encoding of name as a 'Name'</span></span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tiParams"><span class="annot"><span class="annottext">TyInfo -&gt; [Name]
</span><a href="Fcf.Family.TH.html#tiParams"><span class="hs-identifier hs-var hs-var">tiParams</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tiParamsT"><span class="annot"><span class="annottext">TyInfo -&gt; Type
</span><a href="Fcf.Family.TH.html#tiParamsT"><span class="hs-identifier hs-var hs-var">tiParamsT</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ Params as a tuple</span></span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tiArgs"><span class="annot"><span class="annottext">TyInfo -&gt; [(Name, Type)]
</span><a href="Fcf.Family.TH.html#tiArgs"><span class="hs-identifier hs-var hs-var">tiArgs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tiArgsT"><span class="annot"><span class="annottext">TyInfo -&gt; Type
</span><a href="Fcf.Family.TH.html#tiArgsT"><span class="hs-identifier hs-var hs-var">tiArgsT</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tiRes"><span class="annot"><span class="annottext">TyInfo -&gt; Type
</span><a href="Fcf.Family.TH.html#tiRes"><span class="hs-identifier hs-var hs-var">tiRes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="annot"><a href="Fcf.Family.TH.html#appsT"><span class="hs-identifier hs-type">appsT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-241"></span><span id="appsT"><span class="annot"><span class="annottext">appsT :: Type -&gt; [Type] -&gt; Type
</span><a href="Fcf.Family.TH.html#appsT"><span class="hs-identifier hs-var hs-var">appsT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; Type -&gt; [Type] -&gt; Type
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">AppT</span></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="annot"><a href="Fcf.Family.TH.html#mkTyInfo"><span class="hs-identifier hs-type">mkTyInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#TyInfo"><span class="hs-identifier hs-type">TyInfo</span></a></span><span>
</span><span id="line-244"></span><span id="mkTyInfo"><span class="annot"><span class="annottext">mkTyInfo :: Name -&gt; [Name] -&gt; [(Name, Type)] -&gt; Type -&gt; TyInfo
</span><a href="Fcf.Family.TH.html#mkTyInfo"><span class="hs-identifier hs-var hs-var">mkTyInfo</span></a></span></span><span> </span><span id="local-6989586621679067421"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067421"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679067422"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679067422"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679067423"><span class="annot"><span class="annottext">[(Name, Type)]
</span><a href="#local-6989586621679067423"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679067424"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067424"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#TyInfo"><span class="hs-identifier hs-type">TyInfo</span></a></span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tiName :: Name
</span><a href="Fcf.Family.TH.html#tiName"><span class="hs-identifier hs-var">tiName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067421"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiNameT :: Type
</span><a href="Fcf.Family.TH.html#tiNameT"><span class="hs-identifier hs-var">tiNameT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><a href="Fcf.Family.TH.html#familyName"><span class="hs-identifier hs-var">familyName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067421"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiParams :: [Name]
</span><a href="Fcf.Family.TH.html#tiParams"><span class="hs-identifier hs-var">tiParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679067422"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiParamsT :: Type
</span><a href="Fcf.Family.TH.html#tiParamsT"><span class="hs-identifier hs-var">tiParamsT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Type
</span><a href="Fcf.Family.TH.html#consTuple"><span class="hs-identifier hs-var">consTuple</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">VarT</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Type) -&gt; [Name] -&gt; [Type]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679067422"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiArgs :: [(Name, Type)]
</span><a href="Fcf.Family.TH.html#tiArgs"><span class="hs-identifier hs-var">tiArgs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, Type)]
</span><a href="#local-6989586621679067423"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiArgsT :: Type
</span><a href="Fcf.Family.TH.html#tiArgsT"><span class="hs-identifier hs-var">tiArgsT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Type
</span><a href="Fcf.Family.TH.html#consTuple"><span class="hs-identifier hs-var">consTuple</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; Type -&gt; Type) -&gt; (Name, Type) -&gt; Type
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">SigT</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; (Name -&gt; Type) -&gt; Name -&gt; Type -&gt; Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">VarT</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Name, Type) -&gt; Type) -&gt; [(Name, Type)] -&gt; [Type]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Name, Type)]
</span><a href="#local-6989586621679067423"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tiRes :: Type
</span><a href="Fcf.Family.TH.html#tiRes"><span class="hs-identifier hs-var">tiRes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067424"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="annot"><span class="hs-comment">-- | Construct a tuple suitable for a 'Family' argument.</span></span><span>
</span><span id="line-255"></span><span class="annot"><a href="Fcf.Family.TH.html#consTuple"><span class="hs-identifier hs-type">consTuple</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-256"></span><span id="consTuple"><span class="annot"><span class="annottext">consTuple :: [Type] -&gt; Type
</span><a href="Fcf.Family.TH.html#consTuple"><span class="hs-identifier hs-var hs-var">consTuple</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [Type] -&gt; Type
</span><a href="Fcf.Family.TH.html#consTuple_"><span class="hs-identifier hs-var">consTuple_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Type
</span><span class="hs-identifier hs-var">PromotedTupleT</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Type
</span><span class="hs-identifier hs-var">PromotedTupleT</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="annot"><a href="Fcf.Family.TH.html#consTupleT"><span class="hs-identifier hs-type">consTupleT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-259"></span><span id="consTupleT"><span class="annot"><span class="annottext">consTupleT :: [Type] -&gt; Type
</span><a href="Fcf.Family.TH.html#consTupleT"><span class="hs-identifier hs-var hs-var">consTupleT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [Type] -&gt; Type
</span><a href="Fcf.Family.TH.html#consTuple_"><span class="hs-identifier hs-var">consTuple_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Type
</span><span class="hs-identifier hs-var">TupleT</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Type
</span><span class="hs-identifier hs-var">TupleT</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="annot"><a href="Fcf.Family.TH.html#consTuple_"><span class="hs-identifier hs-type">consTuple_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-262"></span><span id="consTuple_"><span class="annot"><span class="annottext">consTuple_ :: Type -&gt; Type -&gt; [Type] -&gt; Type
</span><a href="Fcf.Family.TH.html#consTuple_"><span class="hs-identifier hs-var hs-var">consTuple_</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679067432"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067432"><span class="hs-keyword hs-var">unit</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067432"><span class="hs-keyword hs-var">unit</span></a></span><span>
</span><span id="line-263"></span><span class="annot"><a href="Fcf.Family.TH.html#consTuple_"><span class="hs-identifier hs-var">consTuple_</span></a></span><span> </span><span id="local-6989586621679067433"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067433"><span class="hs-identifier hs-var">tup</span></a></span></span><span> </span><span id="local-6989586621679067434"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067434"><span class="hs-keyword hs-var">unit</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067435"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067435"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679067436"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679067436"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067433"><span class="hs-identifier hs-var">tup</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067435"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; [Type] -&gt; Type
</span><a href="Fcf.Family.TH.html#consTuple_"><span class="hs-identifier hs-var">consTuple_</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067433"><span class="hs-identifier hs-var">tup</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067434"><span class="hs-keyword hs-var">unit</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679067436"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="hs-comment">-- </span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="annot"><a href="Fcf.Family.TH.html#fcfifyInfo"><span class="hs-identifier hs-type">fcfifyInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#ErrCtxt"><span class="hs-identifier hs-type">ErrCtxt</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#TyInfo"><span class="hs-identifier hs-type">TyInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-268"></span><span id="fcfifyInfo"><span class="annot"><span class="annottext">fcfifyInfo :: ErrCtxt =&gt; TyInfo -&gt; Q [Dec]
</span><a href="Fcf.Family.TH.html#fcfifyInfo"><span class="hs-identifier hs-var hs-var">fcfifyInfo</span></a></span></span><span> </span><span id="local-6989586621679067443"><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067443"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-269"></span><span>  </span><span id="local-6989586621679067444"><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679067444"><span class="hs-identifier hs-var">paramsD</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyInfo -&gt; Q Dec
</span><a href="Fcf.Family.TH.html#declareParams"><span class="hs-identifier hs-var">declareParams</span></a></span><span> </span><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067443"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-270"></span><span>  </span><span id="local-6989586621679067446"><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679067446"><span class="hs-identifier hs-var">argsD</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyInfo -&gt; Q Dec
</span><a href="Fcf.Family.TH.html#declareArgs"><span class="hs-identifier hs-var">declareArgs</span></a></span><span> </span><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067443"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-271"></span><span>  </span><span id="local-6989586621679067448"><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679067448"><span class="hs-identifier hs-var">resD</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyInfo -&gt; Q Dec
</span><a href="Fcf.Family.TH.html#declareRes"><span class="hs-identifier hs-var">declareRes</span></a></span><span> </span><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067443"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-272"></span><span>  </span><span id="local-6989586621679067450"><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679067450"><span class="hs-identifier hs-var">familyD</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TyInfo -&gt; Q Dec
</span><a href="Fcf.Family.TH.html#declareFamily"><span class="hs-identifier hs-var">declareFamily</span></a></span><span> </span><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067443"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-273"></span><span>  </span><span class="annot"><span class="annottext">[Dec] -&gt; Q [Dec]
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679067444"><span class="hs-identifier hs-var">paramsD</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679067446"><span class="hs-identifier hs-var">argsD</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679067448"><span class="hs-identifier hs-var">resD</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679067450"><span class="hs-identifier hs-var">familyD</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="annot"><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-type">getVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>
</span><span id="line-276"></span><span id="getVars"><span class="annot"><span class="annottext">getVars :: Type -&gt; [Name]
</span><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var hs-var">getVars</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarT</span></span><span> </span><span id="local-6989586621679067452"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067452"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679067452"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-277"></span><span class="annot"><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span id="local-6989586621679067453"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067453"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679067454"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067454"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Name]
</span><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067453"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Name]
</span><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067454"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-278"></span><span class="annot"><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppKindT</span></span><span> </span><span id="local-6989586621679067456"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067456"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679067457"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067457"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Name]
</span><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067456"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Name]
</span><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067457"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-279"></span><span class="annot"><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigT</span></span><span> </span><span id="local-6989586621679067458"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067458"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679067459"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067459"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Name]
</span><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067458"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Name]
</span><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067459"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-280"></span><span class="annot"><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixT</span></span><span> </span><span id="local-6989586621679067461"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067461"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679067462"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067462"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Name]
</span><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067461"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Name]
</span><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067462"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-281"></span><span class="annot"><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UInfixT</span></span><span> </span><span id="local-6989586621679067464"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067464"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679067465"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067465"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Name]
</span><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067464"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Name]
</span><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067465"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-282"></span><span class="annot"><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParensT</span></span><span> </span><span id="local-6989586621679067467"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067467"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Name]
</span><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067467"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-cpp">
#if MIN_VERSION_template_haskell(2,19,0)
</span><span class="annot"><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PromotedInfixT</span></span><span> </span><span id="local-6989586621679067469"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067469"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679067470"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067470"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Name]
</span><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067469"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Name]
</span><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067470"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-285"></span><span class="annot"><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PromotedUInfixT</span></span><span> </span><span id="local-6989586621679067472"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067472"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679067473"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067473"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Name]
</span><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067472"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Name]
</span><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679067473"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="annot"><a href="Fcf.Family.TH.html#declareParams"><span class="hs-identifier hs-type">declareParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#TyInfo"><span class="hs-identifier hs-type">TyInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span>
</span><span id="line-290"></span><span id="declareParams"><span class="annot"><span class="annottext">declareParams :: TyInfo -&gt; Q Dec
</span><a href="Fcf.Family.TH.html#declareParams"><span class="hs-identifier hs-var hs-var">declareParams</span></a></span></span><span> </span><span id="local-6989586621679067474"><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067474"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679067476"><span class="annot"><span class="annottext">nParams :: Int
</span><a href="#local-6989586621679067476"><span class="hs-identifier hs-var hs-var">nParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyInfo -&gt; [Name]
</span><a href="Fcf.Family.TH.html#tiParams"><span class="hs-identifier hs-var">tiParams</span></a></span><span> </span><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067474"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>  </span><span class="annot"><span class="annottext">Dec -&gt; Q Dec
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TySynEqn -&gt; Dec
</span><span class="hs-identifier hs-var">TySynInstD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe [TyVarBndr ()] -&gt; Type -&gt; Type -&gt; TySynEqn
</span><span class="hs-identifier hs-var">TySynEqn</span></span><span> </span><span class="annot"><span class="annottext">Maybe [TyVarBndr ()]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Params</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">TyInfo -&gt; Type
</span><a href="Fcf.Family.TH.html#tiNameT"><span class="hs-identifier hs-var">tiNameT</span></a></span><span> </span><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067474"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Type
</span><a href="Fcf.Family.TH.html#consTupleT"><span class="hs-identifier hs-var">consTupleT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Type -&gt; [Type]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067476"><span class="hs-identifier hs-var">nParams</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">StarT</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- TODO: don't guess Type for all params</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="annot"><a href="Fcf.Family.TH.html#declareArgs"><span class="hs-identifier hs-type">declareArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#TyInfo"><span class="hs-identifier hs-type">TyInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span>
</span><span id="line-295"></span><span id="declareArgs"><span class="annot"><span class="annottext">declareArgs :: TyInfo -&gt; Q Dec
</span><a href="Fcf.Family.TH.html#declareArgs"><span class="hs-identifier hs-var hs-var">declareArgs</span></a></span></span><span> </span><span id="local-6989586621679067480"><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067480"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-296"></span><span>  </span><span class="annot"><span class="annottext">Dec -&gt; Q Dec
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TySynEqn -&gt; Dec
</span><span class="hs-identifier hs-var">TySynInstD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe [TyVarBndr ()] -&gt; Type -&gt; Type -&gt; TySynEqn
</span><span class="hs-identifier hs-var">TySynEqn</span></span><span> </span><span class="annot"><span class="annottext">Maybe [TyVarBndr ()]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Args_</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">TyInfo -&gt; Type
</span><a href="Fcf.Family.TH.html#tiNameT"><span class="hs-identifier hs-var">tiNameT</span></a></span><span> </span><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067480"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">TyInfo -&gt; Type
</span><a href="Fcf.Family.TH.html#tiParamsT"><span class="hs-identifier hs-var">tiParamsT</span></a></span><span> </span><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067480"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Type
</span><a href="Fcf.Family.TH.html#consTupleT"><span class="hs-identifier hs-var">consTupleT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name, Type) -&gt; Type
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Name, Type) -&gt; Type) -&gt; [(Name, Type)] -&gt; [Type]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TyInfo -&gt; [(Name, Type)]
</span><a href="Fcf.Family.TH.html#tiArgs"><span class="hs-identifier hs-var">tiArgs</span></a></span><span> </span><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067480"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>    </span><span>
</span><span id="line-300"></span><span class="annot"><a href="Fcf.Family.TH.html#declareRes"><span class="hs-identifier hs-type">declareRes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#TyInfo"><span class="hs-identifier hs-type">TyInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span>
</span><span id="line-301"></span><span id="declareRes"><span class="annot"><span class="annottext">declareRes :: TyInfo -&gt; Q Dec
</span><a href="Fcf.Family.TH.html#declareRes"><span class="hs-identifier hs-var hs-var">declareRes</span></a></span></span><span> </span><span id="local-6989586621679067481"><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067481"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-302"></span><span>  </span><span class="annot"><span class="annottext">Dec -&gt; Q Dec
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TySynEqn -&gt; Dec
</span><span class="hs-identifier hs-var">TySynInstD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe [TyVarBndr ()] -&gt; Type -&gt; Type -&gt; TySynEqn
</span><span class="hs-identifier hs-var">TySynEqn</span></span><span> </span><span class="annot"><span class="annottext">Maybe [TyVarBndr ()]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Res_</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">TyInfo -&gt; Type
</span><a href="Fcf.Family.TH.html#tiNameT"><span class="hs-identifier hs-var">tiNameT</span></a></span><span> </span><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067481"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">TyInfo -&gt; Type
</span><a href="Fcf.Family.TH.html#tiParamsT"><span class="hs-identifier hs-var">tiParamsT</span></a></span><span> </span><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067481"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">TyInfo -&gt; Bool
</span><a href="Fcf.Family.TH.html#isDT"><span class="hs-identifier hs-var">isDT</span></a></span><span> </span><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067481"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TyInfo -&gt; Type
</span><a href="Fcf.Family.TH.html#tiArgsT"><span class="hs-identifier hs-var">tiArgsT</span></a></span><span> </span><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067481"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">WildCardT</span></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyInfo -&gt; Type
</span><a href="Fcf.Family.TH.html#tiRes"><span class="hs-identifier hs-var">tiRes</span></a></span><span> </span><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067481"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="annot"><a href="Fcf.Family.TH.html#isDT"><span class="hs-identifier hs-type">isDT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#TyInfo"><span class="hs-identifier hs-type">TyInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-307"></span><span id="isDT"><span class="annot"><span class="annottext">isDT :: TyInfo -&gt; Bool
</span><a href="Fcf.Family.TH.html#isDT"><span class="hs-identifier hs-var hs-var">isDT</span></a></span></span><span> </span><span id="local-6989586621679067484"><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067484"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. Ord a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Fcf.Family.TH.html#intersection"><span class="hs-identifier hs-var">intersection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name, Type) -&gt; Name
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Name, Type) -&gt; Name) -&gt; [(Name, Type)] -&gt; [Name]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TyInfo -&gt; [(Name, Type)]
</span><a href="Fcf.Family.TH.html#tiArgs"><span class="hs-identifier hs-var">tiArgs</span></a></span><span> </span><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067484"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; [Name]
</span><a href="Fcf.Family.TH.html#getVars"><span class="hs-identifier hs-var">getVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyInfo -&gt; Type
</span><a href="Fcf.Family.TH.html#tiRes"><span class="hs-identifier hs-var">tiRes</span></a></span><span> </span><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067484"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span id="local-6989586621679067148"><span class="annot"><a href="Fcf.Family.TH.html#intersection"><span class="hs-identifier hs-type">intersection</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679067148"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679067148"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679067148"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679067148"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-310"></span><span id="intersection"><span class="annot"><span class="annottext">intersection :: forall a. Ord a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Fcf.Family.TH.html#intersection"><span class="hs-identifier hs-var hs-var">intersection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. Ord a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Fcf.Family.TH.html#intersectionSorted"><span class="hs-identifier hs-var">intersectionSorted</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a] -&gt; [a]) -&gt; ([a] -&gt; [a]) -&gt; [a] -&gt; [a] -&gt; [a]
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span id="local-6989586621679067492"><span class="annot"><a href="Fcf.Family.TH.html#intersectionSorted"><span class="hs-identifier hs-type">intersectionSorted</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679067492"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679067492"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679067492"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679067492"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-313"></span><span id="intersectionSorted"><span class="annot"><span class="annottext">intersectionSorted :: forall a. Ord a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Fcf.Family.TH.html#intersectionSorted"><span class="hs-identifier hs-var hs-var">intersectionSorted</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-314"></span><span class="annot"><a href="Fcf.Family.TH.html#intersectionSorted"><span class="hs-identifier hs-var">intersectionSorted</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-315"></span><span class="annot"><a href="Fcf.Family.TH.html#intersectionSorted"><span class="hs-identifier hs-var">intersectionSorted</span></a></span><span> </span><span id="local-6989586621679067498"><span class="annot"><span class="annottext">xxs :: [a]
</span><a href="#local-6989586621679067498"><span class="hs-identifier hs-var">xxs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679067499"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067499"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679067500"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067500"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679067501"><span class="annot"><span class="annottext">yys :: [a]
</span><a href="#local-6989586621679067501"><span class="hs-identifier hs-var">yys</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679067502"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067502"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679067503"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067503"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067499"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067502"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-316"></span><span>  </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067499"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. Ord a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Fcf.Family.TH.html#intersectionSorted"><span class="hs-identifier hs-var">intersectionSorted</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067500"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067503"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-317"></span><span>  </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. Ord a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Fcf.Family.TH.html#intersectionSorted"><span class="hs-identifier hs-var">intersectionSorted</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067500"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067501"><span class="hs-identifier hs-var">yys</span></a></span><span>
</span><span id="line-318"></span><span>  </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. Ord a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Fcf.Family.TH.html#intersectionSorted"><span class="hs-identifier hs-var">intersectionSorted</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067498"><span class="hs-identifier hs-var">xxs</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067503"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span class="annot"><a href="Fcf.Family.TH.html#declareFamily"><span class="hs-identifier hs-type">declareFamily</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Fcf.Family.TH.html#TyInfo"><span class="hs-identifier hs-type">TyInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span>
</span><span id="line-321"></span><span id="declareFamily"><span class="annot"><span class="annottext">declareFamily :: TyInfo -&gt; Q Dec
</span><a href="Fcf.Family.TH.html#declareFamily"><span class="hs-identifier hs-var hs-var">declareFamily</span></a></span></span><span> </span><span id="local-6989586621679067505"><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067505"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-322"></span><span>  </span><span class="annot"><span class="annottext">Dec -&gt; Q Dec
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TySynEqn -&gt; Dec
</span><span class="hs-identifier hs-var">TySynInstD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe [TyVarBndr ()] -&gt; Type -&gt; Type -&gt; TySynEqn
</span><span class="hs-identifier hs-var">TySynEqn</span></span><span> </span><span class="annot"><span class="annottext">Maybe [TyVarBndr ()]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Eval</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Family_</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">TyInfo -&gt; Type
</span><a href="Fcf.Family.TH.html#tiNameT"><span class="hs-identifier hs-var">tiNameT</span></a></span><span> </span><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067505"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">SigT</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">WildCardT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">WildCardT</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">TyInfo -&gt; Type
</span><a href="Fcf.Family.TH.html#tiParamsT"><span class="hs-identifier hs-var">tiParamsT</span></a></span><span> </span><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067505"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-operator hs-var">`AppT`</span></span><span> </span><span class="annot"><span class="annottext">TyInfo -&gt; Type
</span><a href="Fcf.Family.TH.html#tiArgsT"><span class="hs-identifier hs-var">tiArgsT</span></a></span><span> </span><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067505"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; Type -&gt; [Type] -&gt; Type
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">AppT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyInfo -&gt; Name
</span><a href="Fcf.Family.TH.html#tiName"><span class="hs-identifier hs-var">tiName</span></a></span><span> </span><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067505"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">VarT</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Type) -&gt; ((Name, Type) -&gt; Name) -&gt; (Name, Type) -&gt; Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Name, Type) -&gt; Name
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Name, Type) -&gt; Type) -&gt; [(Name, Type)] -&gt; [Type]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TyInfo -&gt; [(Name, Type)]
</span><a href="Fcf.Family.TH.html#tiArgs"><span class="hs-identifier hs-var">tiArgs</span></a></span><span> </span><span class="annot"><span class="annottext">TyInfo
</span><a href="#local-6989586621679067505"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-325"></span></pre></body></html>